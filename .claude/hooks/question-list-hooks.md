# é—®é¢˜æ¸…å•è‡ªåŠ¨åŒ–Hooksé…ç½®

> **ç‰ˆæœ¬**: v1.0
> **åˆ›å»ºæ—¶é—´**: 2025-01-11
> **ç›®çš„**: è‡ªåŠ¨åŒ–é—®é¢˜æ¸…å•æ ¸å®,é¿å…é‡å¤è®¨è®º

---

## ğŸ¯ è®¾è®¡ç›®æ ‡

åœ¨ä»¥ä¸‹å…³é”®æ—¶æœºè‡ªåŠ¨è§¦å‘é—®é¢˜æ¸…å•æ ¸å®,ç¡®ä¿ä¸ä¼šé‡å¤è®¨è®ºå·²ç¡®è®¤çš„é—®é¢˜:

1. âœ… **åˆ›å»ºé—®é¢˜æ¸…å•å** - ç«‹å³æ ¸å®æ˜¯å¦æœ‰å·²ç¡®è®¤çš„é—®é¢˜
2. âœ… **å¼€å§‹è®¨è®ºå‰** - ç¡®ä¿é—®é¢˜æ¸…å•çŠ¶æ€æœ€æ–°
3. âœ… **å®Œæˆè®¨è®ºå** - æœ€ç»ˆæ ¸å®å¹¶åŒæ­¥æ‰€æœ‰ç¡®è®¤

---

## ğŸ”§ Hooké…ç½®

### Hook 1: é—®é¢˜æ¸…å•åˆ›å»ºåè‡ªåŠ¨æ ¸å®

**è§¦å‘æ¡ä»¶**:
```yaml
event: FileCreated
file_pattern: development/active/issues/*questions*.md
```

**è‡ªåŠ¨æ‰§è¡Œ**:
```bash
question-verification-agent $FILE_PATH
```

**æµç¨‹**:
```
ç”¨æˆ·åˆ›å»ºé—®é¢˜æ¸…å•
  â†“
æ–‡ä»¶åˆ›å»ºäº‹ä»¶è§¦å‘
  â†“
question-verification-agent è‡ªåŠ¨å¯åŠ¨
  â†“
æ‰«ææ‰€æœ‰ç›¸å…³æ–‡æ¡£
  â†“
ç”Ÿæˆæ ¸å®æŠ¥å‘Š
  â†“
è¯¢é—®ç”¨æˆ·æ˜¯å¦æ›´æ–°é—®é¢˜æ¸…å•
  â†“
[ç”¨æˆ·ç¡®è®¤] â†’ è‡ªåŠ¨æ›´æ–°é—®é¢˜æ¸…å•çŠ¶æ€
```

**ç¤ºä¾‹è¾“å‡º**:
```markdown
âš¡ æ£€æµ‹åˆ°æ–°é—®é¢˜æ¸…å•: game-submission-questions-v2.md

ğŸ” è‡ªåŠ¨å¯åŠ¨é—®é¢˜æ¸…å•æ ¸å®...

æ‰«ææ–‡æ¡£: 15ä¸ª
å‘ç°é—®é¢˜: 9ä¸ª
âœ… å·²ç¡®è®¤: 7ä¸ª
â³ å¾…ç¡®è®¤: 2ä¸ª

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€æ ¸å®ç»“æœã€‘

å·²åœ¨å…¶ä»–æ–‡æ¡£ç¡®è®¤çš„é—®é¢˜:
- Q8: ç¡¬æ ¸ç©å®¶æ ‡è®°çš„ä½œç”¨å’Œå¥–åŠ±æœºåˆ¶?
  â†’ ç¡®è®¤æ¥æº: a-level-problems-resolution-summary_2025-01-10.md
  â†’ ç¡®è®¤æ—¶é—´: 2025-01-10

- Q9: æºç é“¾æ¥çš„æœ‰æ•ˆæ€§éªŒè¯?
  â†’ ç¡®è®¤æ¥æº: questions.md
  â†’ ç¡®è®¤æ—¶é—´: 2025-01-09

ä»éœ€è®¨è®ºçš„é—®é¢˜:
- Q1: æ¸¸æˆæäº¤æ—¶çš„ä½œè€…åˆ—è¡¨å¦‚ä½•ç”Ÿæˆ?
- Q2: èµ›é“é€‰æ‹©æ˜¯æ‰‹åŠ¨é€‰æ‹©è¿˜æ˜¯è‡ªåŠ¨åˆ¤å®š?

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â“ æ˜¯å¦è‡ªåŠ¨æ›´æ–°é—®é¢˜æ¸…å•çŠ¶æ€?
- è¾“å…¥ "æ˜¯" / "yes" / "y" â†’ è‡ªåŠ¨æ›´æ–°
- è¾“å…¥ "å¦" / "no" / "n" â†’ è·³è¿‡æ›´æ–°
```

---

### Hook 2: discussion-agent å¯åŠ¨å‰é¢„æ ¸å®

**è§¦å‘æ¡ä»¶**:
```yaml
event: AgentInvoked
agent: discussion-agent
```

**è‡ªåŠ¨æ‰§è¡Œ**:
```python
# discussion-agent å†…éƒ¨é€»è¾‘
def start_discussion():
    # æ­¥éª¤1: å…ˆè¿è¡Œæ ¸å®
    verification = question_verification_agent.verify()

    # æ­¥éª¤2: å±•ç¤ºæ ¸å®ç»“æœ
    if verification.has_confirmed_questions():
        show_verification_results(verification)

        # æ­¥éª¤3: è¯¢é—®æ˜¯å¦æ›´æ–°
        if user_confirms_update():
            update_question_list(verification)

    # æ­¥éª¤4: ç„¶åå¼€å§‹è®¨è®º
    start_with_unconfirmed_questions()
```

**æµç¨‹**:
```
ç”¨æˆ·: "/discuss"
  â†“
discussion-agent å¯åŠ¨
  â†“
[å†…éƒ¨] è°ƒç”¨ question-verification-agent
  â†“
è¿”å›æ ¸å®ç»“æœ
  â†“
å±•ç¤ºå·²ç¡®è®¤é—®é¢˜åˆ—è¡¨
  â†“
ç”¨æˆ·ç¡®è®¤æˆ–è·³è¿‡
  â†“
ä»…åŠ è½½æœªç¡®è®¤çš„é—®é¢˜
  â†“
å¼€å§‹è®¨è®º
```

**é›†æˆä»£ç **:
```python
# discussion-agent.md æ ¸å¿ƒé€»è¾‘æ›´æ–°

def load_next_unanswered_question():
    """
    åŠ è½½ä¸‹ä¸€ä¸ªæœªç¡®è®¤çš„é—®é¢˜(å·²æ ¸å®ç‰ˆæœ¬)
    """
    # æ­¥éª¤1: å…ˆè¿è¡Œæ ¸å®
    verification = run_question_verification()

    # æ­¥éª¤2: è¿‡æ»¤å·²ç¡®è®¤çš„é—®é¢˜
    unconfirmed_questions = [
        q for q in questions
        if not verification.is_confirmed(q)
    ]

    # æ­¥éª¤3: å±•ç¤ºæ ¸å®æ‘˜è¦
    if verification.confirmed_count > 0:
        show_verification_summary(verification)

    # æ­¥éª¤4: è¿”å›ç¬¬ä¸€ä¸ªçœŸæ­£æœªç¡®è®¤çš„é—®é¢˜
    return unconfirmed_questions[0] if unconfirmed_questions else None
```

---

### Hook 3: é—®é¢˜æ¸…å•å®Œæˆåæœ€ç»ˆæ ¸å®

**è§¦å‘æ¡ä»¶**:
```yaml
event: QuestionListCompleted
condition: æ‰€æœ‰é—®é¢˜æ ‡è®° âœ…
```

**è‡ªåŠ¨æ‰§è¡Œ**:
```bash
question-verification-agent --final-check $FILE_PATH
```

**æµç¨‹**:
```
ç”¨æˆ·: "æ‰€æœ‰é—®é¢˜å·²ç¡®è®¤"
  â†“
æ£€æµ‹åˆ°100%å®Œæˆ
  â†“
question-verification-agent æœ€ç»ˆæ ¸å®
  â†“
äº¤å‰éªŒè¯æ‰€æœ‰ç¡®è®¤
  â†“
ç”Ÿæˆå®ŒæˆæŠ¥å‘Š
  â†“
å»ºè®®ä¸‹ä¸€æ­¥æ“ä½œ
```

**è¾“å‡º**:
```markdown
ğŸ‰ é—®é¢˜æ¸…å•æ ¸å®å®Œæˆ

**é—®é¢˜æ¸…å•**: game-submission-questions-v2.md
**å®Œæˆåº¦**: 100% (9/9)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… æ ¸å®ç»“æœ
- æ‰€æœ‰é—®é¢˜å·²ç¡®è®¤
- æ‰€æœ‰ç¡®è®¤å·²åŒæ­¥
- æ— å†²çªå‘ç°
- ç‰ˆæœ¬å·ä¸€è‡´

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€å»ºè®®ä¸‹ä¸€æ­¥ã€‘

1. è¿è¡Œ /sync-docs åŒæ­¥æ‰€æœ‰æ–‡æ¡£
2. è¿è¡Œ completion-check-agent éªŒè¯æ¨¡å—å®Œæ•´æ€§
3. å¼€å§‹åˆ›å»ºè®¾è®¡æ–‡æ¡£

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ğŸ› ï¸ å®æ–½æ–¹æ¡ˆ

### é˜¶æ®µ1: Agenté›†æˆ (å·²å®Œæˆ âœ…)

**å·²åˆ›å»º**:
- [x] `question-verification-agent.md` - æ ¸å®Agent
- [x] æ›´æ–° `discussion-agent.md` - é›†æˆæ ¸å®æ­¥éª¤

**å¾…å®Œæˆ**:
- [ ] æ›´æ–° `discussion-agent.md` çš„æ ¸å¿ƒé€»è¾‘,æ·»åŠ è‡ªåŠ¨è°ƒç”¨
- [ ] æµ‹è¯•Agentä¹‹é—´çš„åè°ƒ

### é˜¶æ®µ2: Hookå®ç° (è¿›è¡Œä¸­)

**æŠ€æœ¯æ–¹æ¡ˆ**:

**æ–¹æ¡ˆA: discussion-agentå†…éƒ¨é›†æˆ** (æ¨è)
```python
# discussion-agent çš„æ ¸å¿ƒé€»è¾‘ä¸­æ·»åŠ 
def start():
    # 1. è‡ªåŠ¨è¿è¡Œæ ¸å®
    verification = verify_question_list()

    # 2. å±•ç¤ºç»“æœ
    if verification.has_confirmations():
        print(f"âš ï¸ å‘ç°{verification.confirmed_count}ä¸ªé—®é¢˜å·²ç¡®è®¤")
        print("æ˜¯å¦æ›´æ–°é—®é¢˜æ¸…å•? (y/n)")

        if user_confirms():
            verification.apply_updates()

    # 3. ç»§ç»­æ­£å¸¸æµç¨‹
    proceed_with_discussion()
```

**ä¼˜ç‚¹**:
- ç®€å•ç›´æ¥,æ— éœ€å¤–éƒ¨Hookç³»ç»Ÿ
- Agentå†…éƒ¨è‡ªåŠ¨å¤„ç†
- ç”¨æˆ·ä½“éªŒæµç•…

**æ–¹æ¡ˆB: æ–‡ä»¶ç³»ç»Ÿç›‘æ§** (å¤‡é€‰)
```python
# ä½¿ç”¨æ–‡ä»¶ç›‘æ§å®ç°è‡ªåŠ¨è§¦å‘
from watchdog import observers, events

class QuestionListHandler(events.FileSystemEventHandler):
    def on_created(self, event):
        if event.src_path.endswith('questions.md'):
            # æ–°å»ºé—®é¢˜æ¸…å•,è‡ªåŠ¨æ ¸å®
            launch_verification_agent(event.src_path)
```

**ä¼˜ç‚¹**:
- çœŸæ­£çš„äº‹ä»¶é©±åŠ¨
- å®Œå…¨è‡ªåŠ¨åŒ–

**ç¼ºç‚¹**:
- éœ€è¦é¢å¤–çš„ç›‘æ§è¿›ç¨‹
- å¢åŠ ç³»ç»Ÿå¤æ‚åº¦

### é˜¶æ®µ3: ç”¨æˆ·å‘½ä»¤ (å¿«æ·æ–¹å¼)

```bash
# æ‰‹åŠ¨è§¦å‘æ ¸å®
/verify-questions [æ–‡ä»¶è·¯å¾„]

# æ ¸å®å¹¶è‡ªåŠ¨æ›´æ–°
/verify-questions --update

# ä»…æ˜¾ç¤ºæŠ¥å‘Š,ä¸ä¿®æ”¹æ–‡ä»¶
/verify-questions --report-only

# æ ¸å®æœ€æ–°é—®é¢˜æ¸…å•
/verify-questions
```

---

## ğŸ“Š Hookä¼˜å…ˆçº§

```yaml
ä¼˜å…ˆçº§1 (æœ€é«˜):
  - discussion-agent å†…éƒ¨è‡ªåŠ¨æ ¸å®
  - æ¯æ¬¡è®¨è®ºå‰å¿…æ‰§è¡Œ

ä¼˜å…ˆçº§2 (æ¨è):
  - é—®é¢˜æ¸…å•åˆ›å»ºåæ‰‹åŠ¨æ ¸å®
  - ç”¨æˆ·ä¸»åŠ¨è§¦å‘

ä¼˜å…ˆçº§3 (å¯é€‰):
  - æ–‡ä»¶ç³»ç»Ÿç›‘æ§
  - å®Œå…¨è‡ªåŠ¨åŒ–(æœªæ¥)
```

---

## ğŸ§ª æµ‹è¯•æ–¹æ¡ˆ

### æµ‹è¯•ç”¨ä¾‹1: åˆ›å»ºé—®é¢˜æ¸…å•

**æ­¥éª¤**:
1. åˆ›å»ºæ–°é—®é¢˜æ¸…å• `test-questions.md`
2. é¢„æœŸ: è‡ªåŠ¨è§¦å‘æ ¸å®Agent
3. æ£€æŸ¥: ç”Ÿæˆæ ¸å®æŠ¥å‘Š

**é¢„æœŸç»“æœ**:
```
âš¡ æ£€æµ‹åˆ°æ–°é—®é¢˜æ¸…å•
ğŸ” è‡ªåŠ¨å¯åŠ¨é—®é¢˜æ¸…å•æ ¸å®...
[æ ¸å®æŠ¥å‘Š]
```

### æµ‹è¯•ç”¨ä¾‹2: è®¨è®ºå·²ç¡®è®¤é—®é¢˜

**æ­¥éª¤**:
1. åœ¨ `game-submission-questions-v2.md` ä¸­,Q8å·²ç¡®è®¤
2. ç”¨æˆ·è°ƒç”¨: "/discuss"
3. é¢„æœŸ: discussion-agent è‡ªåŠ¨è·³è¿‡Q8

**é¢„æœŸç»“æœ**:
```
åŠ è½½é—®é¢˜æ¸…å•...
âš ï¸ Q8å·²åœ¨å…¶ä»–æ–‡æ¡£ç¡®è®¤
è·³è¿‡Q8,åŠ è½½Q9...
```

### æµ‹è¯•ç”¨ä¾‹3: å®Œæˆè®¨è®º

**æ­¥éª¤**:
1. æ‰€æœ‰é—®é¢˜æ ‡è®°ä¸º âœ…
2. ç”¨æˆ·: "æ‰€æœ‰é—®é¢˜å·²ç¡®è®¤"
3. é¢„æœŸ: æœ€ç»ˆæ ¸å®å¹¶ç”Ÿæˆå®ŒæˆæŠ¥å‘Š

**é¢„æœŸç»“æœ**:
```
ğŸ‰ é—®é¢˜æ¸…å•æ ¸å®å®Œæˆ
100%å®Œæˆåº¦
å»ºè®®ä¸‹ä¸€æ­¥æ“ä½œ
```

---

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§

### P0 (ç«‹å³å®æ–½)
- [x] åˆ›å»º question-verification-agent
- [x] æ›´æ–° discussion-agent æ·»åŠ æ ¸å®æ­¥éª¤
- [ ] æµ‹è¯•åŸºæœ¬æ ¸å®åŠŸèƒ½

### P1 (çŸ­æœŸå®æ–½)
- [ ] æ·»åŠ æ‰‹åŠ¨è§¦å‘å‘½ä»¤ `/verify-questions`
- [ ] å®Œå–„æ ¸å®æŠ¥å‘Šæ ¼å¼
- [ ] æ·»åŠ æ‰¹é‡æ›´æ–°åŠŸèƒ½

### P2 (é•¿æœŸä¼˜åŒ–)
- [ ] æ–‡ä»¶ç³»ç»Ÿç›‘æ§Hook
- [ ] æ™ºèƒ½é—®é¢˜åŒ¹é…ç®—æ³•
- [ ] é—®é¢˜æ•°æ®åº“ç»Ÿä¸€ç®¡ç†

---

## ğŸ“ é…ç½®æ–‡ä»¶ç¤ºä¾‹

**`.claude/hooks/config.yaml`**:
```yaml
# é—®é¢˜æ¸…å•è‡ªåŠ¨åŒ–Hooksé…ç½®

hooks:
  - name: question-list-verification
    trigger:
      event: AgentInvoked
      agent: discussion-agent
    action:
      type: verify_questions
      priority: high
    enabled: true

  - name: question-list-created
    trigger:
      event: FileCreated
      pattern: "development/active/issues/*questions*.md"
    action:
      type: verify_questions
      auto_update: false  # è¯¢é—®ç”¨æˆ·åå†æ›´æ–°
    enabled: false  # æš‚æ—¶ç¦ç”¨,æµ‹è¯•é€šè¿‡åå¯ç”¨

  - name: question-list-completed
    trigger:
      event: QuestionListCompleted
    action:
      type: verify_questions
      final_check: true
    enabled: true
```

---

## ğŸ”„ å·¥ä½œæµç¨‹å¯¹æ¯”

### æ”¹è¿›å‰

```yaml
åˆ›å»ºé—®é¢˜æ¸…å•:
  1. åˆ›å»ºæ–‡æ¡£
  2. æ‰‹åŠ¨æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤
  3. å¯èƒ½é—æ¼å·²ç¡®è®¤é—®é¢˜

è®¨è®ºé—®é¢˜:
  1. è°ƒç”¨ /discuss
  2. discussion-agent åŠ è½½é—®é¢˜
  3. å¯èƒ½é‡å¤è®¨è®ºå·²ç¡®è®¤é—®é¢˜
  4. ç”¨æˆ·æé†’"è¿™ä¸ªé—®é¢˜ç¡®è®¤è¿‡äº†"
  5. æ‰‹åŠ¨æœç´¢ç›¸å…³æ–‡æ¡£
  6. æµªè´¹5-10åˆ†é’Ÿ
```

### æ”¹è¿›å

```yaml
åˆ›å»ºé—®é¢˜æ¸…å•:
  1. åˆ›å»ºæ–‡æ¡£
  2. [è‡ªåŠ¨] question-verification-agent æ ¸å®
  3. è‡ªåŠ¨å‘ç°å·²ç¡®è®¤é—®é¢˜
  4. ç”¨æˆ·ç¡®è®¤åè‡ªåŠ¨æ›´æ–°

è®¨è®ºé—®é¢˜:
  1. è°ƒç”¨ /discuss
  2. [è‡ªåŠ¨] discussion-agent å…ˆæ ¸å®
  3. å±•ç¤ºå·²ç¡®è®¤é—®é¢˜åˆ—è¡¨
  4. ä»…åŠ è½½æœªç¡®è®¤é—®é¢˜
  5. èŠ‚çœ5-10åˆ†é’Ÿ,ç”¨æˆ·æ»¡æ„åº¦æå‡
```

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### æ•ˆç‡æå‡
```yaml
é—®é¢˜æ ¸å®æ—¶é—´:
  æ”¹è¿›å‰: 5-10åˆ†é’Ÿæ‰‹åŠ¨æœç´¢
  æ”¹è¿›å: 10ç§’è‡ªåŠ¨å®Œæˆ
  æå‡: 30-60å€

é‡å¤è®¨è®ºæ¬¡æ•°:
  æ”¹è¿›å‰: æ¯ä¸ªé—®é¢˜æ¸…å•2-3æ¬¡é‡å¤
  æ”¹è¿›å: 0æ¬¡é‡å¤
  æå‡: 100%é¿å…

ç”¨æˆ·æ»¡æ„åº¦:
  æ”¹è¿›å‰: "è¿™ä¸ªé—®é¢˜åˆè®¨è®ºè¿‡äº†?" âŒ
  æ”¹è¿›å: "è‡ªåŠ¨å‘ç°å·²ç¡®è®¤é—®é¢˜" âœ…
```

### è´¨é‡æ”¹è¿›
```yaml
æ–‡æ¡£åŒæ­¥:
  æ”¹è¿›å‰: ç»å¸¸ä¸åŒæ­¥
  æ”¹è¿›å: è‡ªåŠ¨åŒæ­¥,ä¸€è‡´æ€§é«˜

é—®é¢˜è¿½è¸ª:
  æ”¹è¿›å‰: åˆ†æ•£åœ¨å„æ–‡æ¡£
  æ”¹è¿›å: ç»Ÿä¸€æ ¸å®,æ¸…æ™°è¿½è¸ª

å†³ç­–è´¨é‡:
  æ”¹è¿›å‰: å¯èƒ½é—æ¼å†å²å†³ç­–
  æ”¹è¿›å: å®Œæ•´å±•ç¤ºæ‰€æœ‰ç›¸å…³å†³ç­–
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [question-verification-agent.md](../agents/question-verification-agent.md) - æ ¸å®Agent
- [discussion-agent.md](../agents/discussion-agent.md) - è®¨è®ºAgent(å·²é›†æˆ)
- [question-list-verification-workflow_2025-01-11.md](../../development/workflow-improvements/question-list-verification-workflow_2025-01-11.md) - å·¥ä½œæµç¨‹æ”¹è¿›

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**: 2025-01-11
**ç‰ˆæœ¬**: v1.0
**çŠ¶æ€**: âœ… Agentå·²åˆ›å»º,é›†æˆæ–¹æ¡ˆå·²è®¾è®¡
**ä¸‹ä¸€æ­¥**: å®æ–½discussion-agentå†…éƒ¨é›†æˆ,æµ‹è¯•éªŒè¯
