# 自然语言交互系统 - 快速测试指南

> **目的**: 快速验证自然语言交互系统是否正常工作
> **创建时间**: 2025-01-11
> **版本**: v1.0

---

## 🚀 测试前准备

### 1. 重启Claude Code

**为什么要重启**:
- SessionStart Hook需要重启才能触发
- 自然语言交互系统需要在会话开始时加载

**重启方法**:
- 关闭Claude Code
- 重新打开

**预期看到**:
```
============================================================
🎯 惊蛰计划 v1.19
============================================================
📊 当前状态: 设计讨论
💬 提示: 用自然语言交流即可，无需记住命令
   例如: "看看进度"、"同步一下"、"今天先这样"
============================================================
✅ 准备就绪!
============================================================
```

**关键变化**:
- ✅ 版本号从v1.18 → v1.19
- ✅ 命令提示移除
- ✅ 添加自然语言提示

---

## 🧪 测试场景

### 测试1: 查询进度（静默执行）

**输入**:
```
看看进度到哪了
```

**预期响应**:
```
好的，让我查看一下...

[调用 /check-progress]

📊 当前进度：96/149 (64%)

已完成6个模块，还剩53个问题。
今天完成了3个问题，进度不错！

要继续讨论吗？
```

**检查点**:
- ✅ AI没有说"我将调用 /check-progress"
- ✅ 直接执行了查询工具
- ✅ 语气自然流畅
- ✅ 没有要求用户确认

---

### 测试2: 完成任务（推荐同步）

**输入**:
```
这个问题确认了
```

**预期响应**:
```
这个问题确认了！

要同步文档吗？
我会调用 /sync-docs 将已确认问题同步到设计文档和CHANGELOG
（大约需要1-2分钟）
```

**检查点**:
- ✅ 确认了任务完成
- ✅ 主动推荐同步文档
- ✅ 说明了操作的影响
- ✅ 等待用户确认

---

### 测试3: 用户确认同步

**输入**:
```
好
```

**预期响应**:
```
[调用 /sync-docs]

同步完成！
- 更新了 X 个设计文档
- 更新了 CHANGELOG.md
- ...
```

**检查点**:
- ✅ 执行了同步操作
- ✅ 显示了同步结果

---

### 测试4: 结束会话（推荐总结）

**输入**:
```
今天先这样
```

**预期响应**:
```
好的！今天完成了不少工作 🎉

要生成今日总结吗？
我会：
- 记录完成的任务
- 更新进度
- 规划下一步

（大约需要1分钟）
```

**检查点**:
- ✅ 肯定了今日成果
- ✅ 主动推荐生成总结
- ✅ 说明了操作内容
- ✅ 等待用户确认

---

### 测试5: 正在讨论（不要打断）

**输入**:
```
推荐位机制怎么设计？权重如何计算？
```

**预期响应**:
```
[详细解释推荐位机制设计和权重计算逻辑]
```

**检查点**:
- ✅ 专注回答问题
- ❌ 没有推荐任何工具
- ❌ 没有调用任何命令
- ✅ 保持对话连贯

---

### 测试6: 继续提问（仍然不打断）

**输入**:
```
那时间衰减呢？
```

**预期响应**:
```
[继续解释时间衰减机制]
```

**检查点**:
- ✅ 继续回答问题
- ❌ 仍然没有推荐工具
- ✅ 对话流畅自然

---

### 测试7: 任务完成（再次推荐）

**输入**:
```
明白了，这个方案可以
```

**预期响应**:
```
推荐位机制方案已确认！

要同步文档吗？
我会调用 /sync-docs 将这个方案同步到设计文档
（大约需要1-2分钟）
```

**检查点**:
- ✅ 确认了方案
- ✅ 在合适的时机推荐同步
- ✅ 此时推荐不突兀

---

## 🎯 测试评估

### 成功标准

**核心功能**:
- ✅ 查询类操作静默执行
- ✅ 修改类操作请求确认
- ✅ 任务完成后主动推荐
- ✅ 思考中不推荐工具

**对话风格**:
- ✅ 语气自然流畅
- ✅ 不强调命令名
- ✅ 理解上下文

**推荐时机**:
- ✅ 在黄金时机推荐
- ✅ 不在禁止时机推荐
- ✅ 提供选择权

### 常见问题

**问题1: AI还是说"我将调用XXX命令"**

**原因**: SessionStart Hook没有正确加载系统提示

**解决方案**:
1. 检查 `.claude/settings.json` 中SessionStart Hook配置
2. 确认prompt hook存在且正确
3. 重启Claude Code

---

**问题2: AI没有推荐工具**

**原因**: 可能是不在推荐时机

**检查**:
- 用户是否正在深入思考？
- 是否有明确完成的任务？
- 是否在会话结束阶段？

**解决方案**:
- 等待明确的完成信号（"好了"、"确认了"）
- 或者结束会话（"今天先这样"）

---

**问题3: AI过度推荐**

**原因**: 推荐时机判断过于激进

**反馈**:
- 记录具体场景
- 更新 tool-timing-prompt.md
- 调整推荐阈值

---

## 📊 测试记录表

| 测试场景 | 输入 | 预期 | 实际 | 通过 |
|---------|------|------|------|------|
| 查询进度 | "看看进度到哪了" | 静默调用 /check-progress | | ☐ |
| 完成任务 | "这个问题确认了" | 推荐同步文档 | | ☐ |
| 用户确认 | "好" | 执行同步 | | ☐ |
| 结束会话 | "今天先这样" | 推荐生成总结 | | ☐ |
| 正在讨论 | "推荐位机制怎么设计？" | 不推荐工具 | | ☐ |
| 继续提问 | "那时间衰减呢？" | 仍然不推荐 | | ☐ |
| 方案确认 | "这个方案可以" | 推荐同步 | | ☐ |

---

## 💡 测试技巧

### 技巧1: 从简单开始

先测试最简单的查询：
```
进度？
```

如果AI能自然响应，说明系统已加载。

### 技巧2: 观察AI响应风格

好的响应:
```
好的，让我查看一下...
```

不好的响应:
```
我将调用 /check-progress 命令
```

### 技巧3: 测试上下文理解

连续对话测试AI是否理解上下文：
```
你: 这个问题确认了
AI: 要同步文档吗？
你: 不需要
AI: 好的 👌

[几分钟后]

你: 另一个问题也确认了
AI: 要同步文档吗？
```

**检查**: AI是否在你多次说"不需要"后，减少推荐频率？

### 技巧4: 边界测试

测试特殊情况：
- 用户正在思考时不要推荐
- 用户刚拒绝过不要重复推荐
- 用户只是闲聊不要推荐

---

## 🐛 发现问题？

### 报告格式

```
**问题描述**:
[简洁描述问题]

**输入**:
[你的输入]

**预期**:
[你期望的响应]

**实际**:
[实际的响应]

**重现步骤**:
1. ...
2. ...

**建议**:
[你的改进建议]
```

### 报告位置

将问题反馈记录在：
`development/issues/natural-language-issues.md`

---

## 🎉 测试完成后

### 如果测试通过

✅ 恭喜！自然语言交互系统部署成功！

**下一步**:
1. 开始正常使用
2. 观察AI的表现
3. 收集改进建议
4. 定期优化prompt

### 如果测试失败

❌ 系统可能有问题

**排查步骤**:
1. 检查文件是否都存在
2. 检查settings.json配置
3. 查看错误日志
4. 参考实施报告排查

---

**版本**: v1.0
**创建时间**: 2025-01-11
**适用版本**: v1.19
**更新频率**: 根据测试结果更新
