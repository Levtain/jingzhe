# 开发日志 - 游戏提交系统设计讨论 (2025-01-08)

> **惊蛰计划 v1.16 - 游戏提交系统模块**
> 日期: 2025-01-08
> 参与人员: 蜡烛先生 + Claude
> 工作内容: 游戏提交系统需求收集、问题确认、设计检视

---

## 📋 今日工作概览

### ✅ 已完成任务

1. **游戏提交系统需求收集完成**
   - 创建完整需求规格v2.0 (624行)
   - 设计7步提交流程
   - 定义所有字段和验证规则
   - 设计数据库表结构

2. **6个核心设计问题确认**
   - Q1: 作者列表生成 → ✅ 自动同步团队快照
   - Q2: 赛道选择 → ✅ 手动选择+智能约束
   - Q3: 编辑器功能 → ✅ Markdown+实时预览
   - Q4: 封面图验证 → ✅ 严格验证+拒绝上传
   - Q5: 平台引擎 → ✅ 平台多选+引擎单选
   - Q6: 提交清单 → ✅ 无等待+可撤回

3. **源码上传功能需求补充**
   - 添加可选源码上传功能
   - 定义硬核玩家标记机制
   - 提出3个待确认问题(Q7-Q9)

4. **全面设计问题检视**
   - 发现18个潜在问题
   - 9个高优先级 + 9个中优先级
   - 创建详细检视报告
   - 提供解决方案建议

5. **文档更新与归档**
   - 更新问题清单v2.0
   - 更新主问题清单questions.md
   - 归档旧问题清单v1.0
   - 创建设计检视报告

---

## 📊 工作成果统计

### 文档产出

| 文档名称 | 类型 | 规模 | 状态 |
|---------|------|------|------|
| game-submission-requirements-v2.md | 需求文档 | 624行 | ✅ 已完成 |
| game-submission-questions-v2.md | 问题清单 | 471行 | ✅ 已更新 |
| game-submission-review_2025-01-08.md | 检视报告 | 详细分析 | ✅ 已创建 |
| questions.md | 主清单 | 已更新 | ✅ 已更新 |
| dev-log-2025-01-08.md | 开发日志 | 本文档 | ✅ 本文档 |

### 问题统计

| 类别 | 已确认 | 待确认 | 总数 |
|------|--------|--------|------|
| 核心设计问题 | 6 | 3 | 9 |
| 设计检视问题 | 0 | 18 | 18 |
| **总计** | **6** | **21** | **27** |

---

## 🎯 关键决策记录

### 1. 作者列表生成机制 (Q1)

**决策**: 自动同步团队快照

**理由**:
- 避免手动管理的不一致问题
- 防止遗漏成员或添加非成员
- 降低开发和维护复杂度
- 数据模型简单: games表直接关联team_id

**影响**:
- 数据库设计: 不需要独立的authors表
- 表单验证: 无需校验作者身份
- 公平性: 自动确保只有团队成员被列为作者

---

### 2. 赛道选择机制 (Q2)

**决策**: 手动选择 + 智能约束

**智能约束规则**:
- 团队人数 = 1: 可选"个人赛道"或"未完成"
- 团队人数 ≥ 2: "个人赛道"选项禁用,只能选"团队赛道"或"未完成"
- "未完成"选项始终可选

**理由**:
- 用户有选择权,保留灵活性
- 智能约束防止选错(比如2人选个人赛道)
- 支持未完成赛道
- 用户体验友好,选项清晰

---

### 3. 游戏正文编辑器 (Q3)

**决策**: Markdown编辑器 + 实时预览

**技术选型**:
- CodeMirror 6 (推荐) 或 Monaco Editor
- 左右分屏布局
- 工具栏: 插入常用语法
- 混合模式: 上传到服务器 + 外部图床链接

**理由**:
- 技术成熟,易于实现
- 用户可学习Markdown语法(通用技能)
- 便于版本控制
- 图片上传灵活性高

---

### 4. 封面图验证策略 (Q4)

**决策**: 严格验证 + 拒绝上传

**规格要求**:
- 推荐尺寸: 1920x1080 (16:9)
- 最小尺寸: 960x540
- 文件大小: <2MB
- 格式: JPG/PNG/WebP

**理由**:
- 确保所有封面图质量一致
- 页面展示效果好
- 避免服务端处理复杂度
- 用户得到明确反馈

---

### 5. 平台和引擎选项 (Q5)

**决策**: 平台多选 + 引擎单选

**平台选项**: Windows / macOS / Linux / Web / Android / iOS (至少选1个)

**引擎选项**: Unity / Unreal / Godot / GameMaker / RPG Maker / Construct / 自定义(单选)

**理由**:
- 准确表达多平台游戏
- 引擎数据标准化,便于统计
- 链接说明帮助用户理解游戏要求

---

### 6. 提交清单机制 (Q6)

**决策**: 无等待时间 + 可撤回

**撤回规则**:
- 评分期开始前: 可随时撤回,修改后重新提交
- 评分期开始后: 不允许撤回
- 修改历史: 记录每次修改的时间和内容

**理由**:
- 用户体验流畅,无强制等待
- 允许纠错
- 快速跳转链接降低阅读成本

---

## 🔍 设计问题检视发现

### 高优先级问题 (9个)

1. **P1: 7步流程定义不一致** → 需明确是7个页面跳转还是单页长表单
2. **P2: Draft模式触发时机不明确** → 何时算"创建"?
3. **P4: 字符限制单位不统一** → "100字"vs"100字符"
4. **P5: 游戏简介"确切100字"验证逻辑缺失**
5. **P7: 游戏链接"有效性检查"未定义**
6. **P8: 团队成员变更时的游戏作者处理逻辑缺失**
7. **P9: 评分期版本锁定机制冲突**
8. **P11: Draft草稿的重复提交防护缺失**
9. **P12: 游戏撤回后的作者列表锁定问题**
10. **P15: 编辑器技术选型成本被低估**
11. **P16: 数据库外键约束缺失**

### 中优先级问题 (7个)

- P3: 步骤6"作者信息"显示不完整
- P6: 封面图规格验证的边界情况
- P10: 成就系统集成的"硬核玩家"标记逻辑
- P13: 视频链接嵌入的兼容性问题
- P14: 提交确认清单的跳转逻辑
- P17: game_dimensions表的独立性问题
- P18: game_tags表的tag_type字段设计冗余

---

## 📝 新增需求记录

### 源码上传功能 (2025-01-08补充)

**功能描述**:
- 复选框: "☐ 我愿意公开游戏源码"
- 勾选后显示: 源码仓库链接输入框(GitHub/GitLab等)
- 后台自动标记该玩家为"硬核玩家"

**待确认问题**:
- **Q7**: 团队赛道如何处理?团队作品中谁算硬核玩家?
- **Q8**: 硬核玩家标记仅对个人赛道有效?还是团队也有效?
- **Q9**: 如果是团队,是否所有成员都标记为硬核?还是仅队长?

---

## 🎓 经验教训

### 成功经验

1. **用户需求收集方法**
   - 先收集用户原始需求(11项)
   - 提炼设计问题(6个核心问题)
   - 逐个确认后再补充细节

2. **需求文档组织**
   - 分7个部分组织需求
   - 每个字段明确定义类型、必填、验证规则
   - 提供具体UI示例

3. **问题检视方法**
   - 从需求矛盾、验证规则、系统集成、边界场景、数据库设计5个维度检视
   - 按优先级分类问题
   - 提供具体解决方案

### 改进建议

1. **技术选型评估**
   - 编辑器选型(CodeMirror 6)需要更详细的成本评估
   - 建议第一届使用现成库(toast-ui.editor)

2. **验证规则设计**
   - 字符限制单位需要统一("字符"vs"字")
   - 需要提供前端实时计数器

3. **系统集成设计**
   - 与团队系统、评分系统的集成需要更详细的边界场景处理
   - 需要设计成员快照的详细数据结构

---

## 📅 下一步计划

### 短期任务 (1-2天)

1. **确认Q7-Q9**: 源码上传相关功能
2. **解决P1-P7**: 需求澄清阶段问题
   - P1: 7步流程定义
   - P2: Draft触发时机
   - P4: 字符限制单位
   - P5: 游戏简介验证
   - P6: 封面图边界情况
   - P7: 链接有效性检查

### 中期任务 (3-5天)

3. **解决P8-P18**: 系统设计和数据库优化
   - P8-P12: 系统集成和边界场景
   - P15: 编辑器技术选型
   - P16-P18: 数据库设计优化

4. **创建设计文档v1.0**
   - 基于确认后的需求
   - 完成详细设计
   - API接口设计
   - UI/UX原型

### 长期任务 (1-2周)

5. **技术评审**
   - 编辑器选型技术评审
   - 数据库设计评审
   - API接口评审

6. **开发计划制定**
   - 前端开发计划
   - 后端开发计划
   - 测试计划

---

## 📊 整体进度更新

### 问题清单进度

| 类别 | 已确认 | 部分确认 | 未讨论 | 总数 |
|------|--------|----------|--------|------|
| 评分系统相关 | 24 | 3 | 2 | 29 |
| 团队系统相关 | 20✅ | 0 | 0 | 20 |
| 排名系统相关 | 20 | 0 | 0 | 20 |
| **游戏提交系统** | **6✅** | **0** | **3** | **9** |
| 其他系统问题 | 4 | 0 | 12 | 16 |
| 前端功能问题 | 0 | 0 | 29 | 29 |
| **总计** | **74** | **3** | **46** | **123** |

**游戏提交系统完成度**: 6/9 = 67%

**设计问题完成度**: 6/27 = 22% (核心问题) + 0% (检视问题)

---

## 🔗 相关文档链接

### 需求与问题文档
- [游戏提交系统需求规格 v2.0](../issues/game-submission-requirements-v2.md)
- [游戏提交系统问题清单 v2.0](../issues/game-submission-questions-v2.md)
- [游戏提交系统设计检视报告](../analysis/game-submission-review_2025-01-08.md)
- [主问题清单 questions.md](../issues/questions.md)

### 归档文档
- [游戏提交系统问题清单 v1.0 (已归档)](../issues/archive/game-submission-questions-v1%20archived_2025-01-08.md)

### 相关系统设计
- [团队系统设计文档 v1.3](../../docs/design/惊蛰计划-团队系统设计文档_v1.3.md)
- [评分系统设计方案 v2.0](../../docs/design/评分系统设计方案_v1.0.md)

---

## 💬 重要对话记录

### 用户反馈模式

1. **偏好简洁决策**
   - "自动同步吧"
   - "A" (选择选项A)
   - "平台多选引擎单选吧"
   - "我觉得按你的想法走就可以"

2. **重视灵活性**
   - 赛道选择: 手动选择+智能约束(而非完全自动)
   - 提交清单: 无等待时间(尊重用户)

3. **关注第一届可行性**
   - 编辑器选型: 建议使用现成库(降低风险)
   - 验证规则: 简化但不失准确性

### 补充需求时机

- 在确认Q6时补充源码上传功能
- 体现了需求迭代的特点
- 需求收集是一个渐进过程

---

## ✅ 今日工作总结

### 完成情况评估

- ✅ **需求收集**: 100% 完成
- ✅ **核心问题确认**: 67% 完成 (6/9)
- ✅ **设计检视**: 100% 完成
- ⏳ **问题解决**: 0% 完成 (0/27待解决问题)

### 工作亮点

1. **需求文档完整详细**: 624行需求规格,覆盖所有功能点
2. **问题检视全面深入**: 发现18个潜在问题,提供解决方案
3. **决策记录清晰**: 每个决策都有理由和影响分析
4. **文档组织良好**: 需求、问题、检视报告分类清晰

### 遗留问题

1. **Q7-Q9待确认**: 源码上传功能相关
2. **P1-P18待解决**: 设计检视发现的18个问题
3. **设计文档待创建**: 基于确认后的需求

---

**日志记录时间**: 2025-01-08 晚
**记录人**: Claude (AI Assistant)
**下次讨论**: 待用户确认Q7-Q9后继续
**预计完成时间**: 4-6天完成所有问题确认
