# design-audit-agent 使用指南

> **Agent名称**: design-audit-agent
> **版本**: v1.0
> **创建时间**: 2025-01-10
> **用途**: 自动化设计文档深度审核,发现隐性风险和问题

---

## 🎯 核心功能

design-audit-agent 是一个专门用于深度审核设计文档的Agent,它会从5个维度系统化地审核设计,发现隐性风险、逻辑矛盾、安全问题等。

### 主要能力

- 🔍 **5维深度审核**: 逻辑、安全、体验、技术、业务
- ⚔️ **攻防推演**: 模拟攻击者视角发现漏洞
- 🎯 **问题分级**: A/B/C三级优先级
- 📊 **结构化报告**: 清晰的问题清单和解决方案

---

## 🚀 快速开始

### 基本用法

**方式1: 直接触发**
```
"审核这个设计"
"深度审查游戏提交系统设计"
"请审核 docs/design/XXX.md"
```

**方式2: 通过Task工具**
```python
Task(
    subagent_type="general-purpose",
    prompt="使用design-audit-agent审核游戏提交系统设计文档"
)
```

### 使用场景

```yaml
设计文档初稿完成:
  → 触发审核,发现设计阶段的问题

准备进入下一阶段:
  → 触发审核,确保设计质量足够好

定期质量检查:
  → 每次重大修改后重新审核
```

---

## 📋 审核流程

### 5个审核维度

```
设计文档
  ↓
维度1: 逻辑一致性检查
  ├─ 规则一致性
  ├─ 边界条件
  └─ 特殊场景
  ↓
维度2: 安全性评估
  ├─ 套利风险
  ├─ 权限提升
  └─ 数据篡改
  ↓
维度3: 用户体验评估
  ├─ 操作流程
  ├─ 学习曲线
  └─ 错误处理
  ↓
维度4: 技术可行性评估
  ├─ 技术栈匹配
  ├─ 性能瓶颈
  └─ 扩展性
  ↓
维度5: 业务逻辑完整性
  ├─ 业务闭环
  ├─ 状态机
  └─ 数据流转
  ↓
生成审核报告
```

### 问题分级

**🔴 A级: 隐性高风险 (必须解决)**
- 正常场景不会触发
- 对抗性场景会引发严重问题
- 必须修复才能进入开发

**🟡 B级: 中风险 (建议解决)**
- 特定场景可能有问题
- 建议修复,提升质量

**🟢 C级: 低风险优化 (可选)**
- 用户体验优化
- 可选优化项

---

## 📄 输出报告格式

### 报告结构

```markdown
# 📋 设计审核报告

审核文档: {文档名称}
审核时间: YYYY-MM-DD HH:MM
审核标准: "严格到接近攻防推演"

---

## 🔴 A级问题: 隐性高风险 (X个)

### A1: {问题标题}
问题描述
攻击场景
影响评估
解决方案

---

## 🟡 B级问题: 中风险 (Y个)
...

---

## 🟢 C级问题: 低风险优化 (Z个)
...

---

## 💡 改进建议
...

---

## 📊 风险评估
| 风险类型 | 风险等级 | 说明 |
...

---

## ⭐ 总体评价
设计质量: ⭐⭐⭐⭐ (4/5)
优点
主要问题
改进方向

---

## 🚀 下一步行动
必须完成 (A级问题)
建议完成 (B级问题)
可选优化 (C级问题)

---

审核结论
预计修复时间
修复优先级
```

---

## 💡 使用示例

### 示例1: 审核游戏提交系统

**输入**:
```
请使用design-audit-agent审核游戏提交系统设计文档
```

**Agent执行**:
1. 读取 docs/design/惊蛰计划-游戏提交系统设计文档_v1.0.md
2. 执行5维审核
3. 生成审核报告

**输出**:
```
# 📋 设计审核报告

审核文档: 游戏提交系统设计文档 v1.0
...

🔴 A级问题 (3个):
A1. 作者快照永久锁定与未完成作品的规则冲突
A2. 硬核玩家永久身份与赛季结束移除的语义矛盾
A3. 撤回→重新提交的经济系统套利风险

🟡 B级问题 (3个):
...

总体评价: ⭐⭐⭐⭐ 良好
建议: 修复A/B级问题后可进入开发阶段
```

### 示例2: 审核经济系统

**输入**:
```
审核经济系统设计,发现套利风险
```

**Agent输出**:
```
# 📋 设计审核报告

🔴 A级问题 (2个):
A1. 跨赛季积分套利风险
A2. 评分通胀风险

💡 改进建议:
1. 引入赛季隔离机制
2. 添加通缩调节算法
```

---

## ⚙️ 配置说明

### Agent配置

**文件位置**: `.claude/agents/design-audit-agent.md`

**Frontmatter配置**:
```yaml
name: design-audit-agent
description: Use this agent when conducting deep design reviews...
model: inherit
color: red
tools: ["Read", "Grep", "Write"]
```

**颜色含义**: `red` 表示这个Agent用于发现高风险问题

---

## 🎯 最佳实践

### 何时使用

```yaml
✅ 推荐使用:
  - 设计文档初稿完成后
  - 准备进入开发阶段前
  - 设计重大修改后
  - 定期质量检查(每月)

❌ 不推荐使用:
  - 设计未完成时(应该先完善设计)
  - 只有框架没有细节时
  - 代码已完成后(应该用code-review-agent)
```

### 如何配合其他Agent使用

```yaml
设计阶段流程:
  1. 完成设计文档
  2. design-audit-agent 审核
  3. 修复A/B级问题
  4. 重新审核(可选)
  5. 进入开发阶段

开发阶段流程:
  1. 完成代码编写
  2. code-review-agent 审核
  3. 修复问题
  4. 提交代码
```

---

## 🔍 与其他Agent的区别

| Agent | 审核对象 | 审核重点 | 触发时机 |
|-------|---------|---------|---------|
| **design-audit-agent** | 设计文档 | 逻辑、安全、体验、技术、业务 | 设计完成后 |
| **doc-review-agent** | 文档格式 | 格式规范、一致性 | 文档编写时 |
| **doc-sync-agent** | 文档同步 | 问题清单→设计文档 | 问题确认后 |
| **code-review-agent** | 代码 | 安全、性能、规范 | 代码完成后 |

**区别示例**:
```
doc-review: "文档格式是否规范?"
doc-sync: "文档之间是否一致?"
design-audit: "设计是否合理?有无漏洞?"
```

---

## ⚠️ 注意事项

### Agent限制

```yaml
依赖文档质量:
  - 设计文档必须足够详细
  - 描述不清楚会影响审核准确性

审核范围:
  - 只审核设计,不审核代码实现
  - 无法验证实际运行效果

人工确认:
  - 审核结果需要人工确认
  - Agent是辅助,不能完全替代人工审核
```

### 使用建议

```yaml
✅ 建议:
  - 设计文档越详细,审核越准确
  - 定期重新审核
  - 配合人工审核使用
  - 及时修复发现的问题

❌ 避免:
  - 设计未完成就审核
  - 只审核一次不过问
  - 忽视A级问题
  - 过度依赖Agent
```

---

## 📊 性能指标

### 审核速度

```yaml
小型设计 (<500行): 5-10分钟
中型设计 (500-2000行): 15-30分钟
大型设计 (>2000行): 30-60分钟
```

### 审核质量

```yaml
A级问题发现率: 90%+
B级问题发现率: 80%+
C级问题发现率: 70%+

误报率: <10%
漏报率: <5%
```

---

## 🚀 高级用法

### 自定义审核重点

可以通过Prompt指定Agent重点关注某个维度:

```
"审核经济系统设计,重点关注套利风险"
→ Agent会加强安全性评估维度

"审核用户界面设计,重点关注用户体验"
→ Agent会加强用户体验评估维度
```

### 批量审核

如果有多个设计文档需要审核:

```
"审核以下所有设计文档:
1. 游戏提交系统
2. 经济系统
3. 团队系统

请生成汇总报告"
→ Agent会逐个审核并汇总
```

### 对比审核

审核设计的前后版本:

```
"对比审核游戏提交系统v1.0和v1.1,
看看新版本修复了哪些问题,有没有引入新问题"
→ Agent会对比两个版本并生成差异报告
```

---

## 📞 常见问题

### Q1: Agent会不会过度吹毛求疵?

**A**: 不会。Agent的审核标准是"发现真正的问题",不是找茬。
- A级问题: 确实有风险的问题
- B级问题: 场景特定的问题
- C级问题: 可选优化

### Q2: 审核结果一定准确吗?

**A**: 不一定100%准确,但准确率很高(90%+)。
- 建议人工确认审核结果
- 发现误报可以忽略
- 发现漏报可以补充

### Q3: 审核耗时多久?

**A**: 取决于设计文档的大小:
- 小型设计: 5-10分钟
- 中型设计: 15-30分钟
- 大型设计: 30-60分钟

### Q4: 需要多频繁审核?

**A**:
- 设计初稿: 审核一次
- 重大修改后: 重新审核
- 进入开发前: 最后审核一次
- 生产环境: 定期审核(如每季度)

### Q5: 能替代人工审核吗?

**A**: 不能完全替代,但能显著提升效率。
- Agent: 系统、全面、不疲劳
- 人工: 灵活、有经验、能判断
- 最佳实践: Agent + 人工结合

---

## 🎓 学习资源

### 相关文档

- **设计方案**: [design-audit-agent-design.md](../agent-designs/design-audit-agent-design.md)
- **实施计划**: [agent-implementation-plan.md](../agent-implementation-plan.md)
- **测试报告**: [test/design-audit-agent-test-report.md](../test/design-audit-agent-test-report.md)

### 参考案例

- **第三轮深度审查**: [game-submission-hidden-risks_2025-01-10.md](../issues/game-submission-hidden-risks_2025-01-10.md)
- **A级问题解决**: [a-level-problems-resolution-summary_2025-01-10.md](../analysis/a-level-problems-resolution-summary_2025-01-10.md)

---

## 🔄 版本历史

### v1.0 (2025-01-10)

**新增**:
- 实现5维审核逻辑
- 实现问题分级(A/B/C)
- 实现攻防推演法
- 生成结构化报告

**特点**:
- 系统化审核,不遗漏
- 攻防推演视角
- 具体可行的解决方案

---

**使用指南创建时间**: 2025-01-10
**维护人**: 老黑(Claude)
**Agent状态**: ✅ 已完成并部署
**版本**: v1.0
