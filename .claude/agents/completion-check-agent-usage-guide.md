# completion-check-agent 使用指南

> **Agent名称**: completion-check-agent
> **版本**: v1.0
> **创建时间**: 2025-01-10
> **用途**: 智能验证模块完整性,防止遗漏问题,确保设计或开发质量达标

---

## 🎯 核心功能

completion-check-agent 是一个专门用于模块完整性验证的Agent,它能系统化检查所有必需的文档和问题,确保模块真正"完成"并可以进入下一阶段。

### 主要能力

- 📄 **文档完整性检查**: 验证所有必需文档是否存在
- ✅ **问题完成度检查**: 确认100%问题已确认
- 🔄 **文档同步状态检查**: 验证决策已同步到设计文档
- 🔢 **版本号一致性检查**: 确保所有文档版本号统一
- 🔗 **交叉引用有效性检查**: 验证所有链接有效
- 📊 **总体评估**: 提供完成度评分和TODO清单

---

## 🚀 快速开始

### 基本用法

**方式1: 验证当前模块**
```
"检查模块完整性"
"验证完成度"
"检查是否可以进入下一阶段"
```

**方式2: 验证特定模块**
```
"检查游戏提交系统模块是否完成"
"验证评分系统设计完整性"
```

### 使用场景

```yaml
设计阶段完成后:
  → 所有问题讨论完成
  → "检查模块完整性"
  → Agent生成5维验证报告
  → 根据TODO清单补充

准备进入开发阶段:
  → "检查是否可以开始开发"
  → Agent验证设计完整性
  → 确认无阻塞性问题
```

---

## 📋 验证维度详解

### 维度1: 📄 文档完整性

**检查内容**:
- 设计文档是否存在
- 问题清单是否存在
- CHANGELOG是否存在
- 决策记录是否存在(可选)

**输出示例**:
```markdown
### 📄 文档完整性

✅ **存在的文档**:
- ✅ 设计文档: docs/design/游戏提交系统设计文档_v1.0.md
- ✅ 问题清单: development/active/issues/game-submission-questions-v2.md
- ⚠️  决策记录: development/workspace/drafts/decisions/game-submission-decisions.md (不存在)

❌ **缺失的文档**:
- ❌ API文档: docs/api/game-submission-api.md (建议创建)
- ❌ 测试计划: tests/game-submission-test-plan.md (建议创建)

✅ **文档完整性**: 80% (4/5项必需文档)
```

**完成标准**:
- 设计阶段: 设计文档 + 问题清单 + CHANGELOG
- 开发阶段: 设计文档 + API文档 + 测试计划 + 部署文档

### 维度2: ✅ 问题完成度

**检查内容**:
- 所有问题是否已确认(标记✅)
- 是否有未讨论的问题
- 是否有部分确认的问题

**输出示例**:
```markdown
### ✅ 问题完成度

**问题清单**: game-submission-questions-v2.md
- ✅ 已确认: 29个问题 (100%)
- 🔄 讨论中: 0个问题
- ❌ 未讨论: 0个问题

**完成度**: ⭐⭐⭐⭐⭐ 100%

✅ **问题100%完成,可以进行下一阶段**
```

**完成标准**:
- 设计阶段: 100%问题已确认
- 开发阶段: 所有功能已实现 + 测试通过

### 维度3: 🔄 文档同步状态

**检查内容**:
- 已确认问题是否已同步到设计文档
- 数值/规则是否一致
- 章节引用是否正确

**输出示例**:
```markdown
### 🔄 文档同步状态

✅ **一致的文档** (4个):
- 评分系统设计方案_v1.0.md
- 排名系统技术实现文档_v1.0.md
- 用户角色与权限定义.md
- CHANGELOG.md

⚠️ **发现不一致** (1个):
- scoring-system-questions.md vs 评分系统设计方案_v1.0.md
  → Q1.5: 问题清单说"评审团权重×3",设计文档说"×2"
  → 建议: 同步正确的数值

❌ **缺失同步** (2个):
- Q2.1-Q2.3 已确认但未同步到设计文档
  → 缺失在: 排名系统技术实现文档_v1.0.md
  → 建议: 立即同步

**同步完整性**: 70% (需要补充2个问题的同步)
```

**完成标准**:
- 所有问题已同步到设计文档
- 无数值/规则不一致
- 章节引用正确

### 维度4: 🔢 版本号一致性

**检查内容**:
- CHANGELOG.md 当前版本
- claude.md 当前版本
- 设计文档版本号
- 问题清单引用的版本号

**输出示例**:
```markdown
### 🔢 版本号一致性

**当前版本**: v1.2

✅ **版本号一致**:
- CHANGELOG.md: v1.2 ✅
- claude.md: v1.2 ✅
- 大部分设计文档: v1.0 (可以接受,非关键文档)

⚠️ **版本号不一致**:
- 评分系统设计文档: v1.0
  → 建议: 更新为 v1.2

❌ **失效的交叉引用** (2个):
- {file}:{line} → 引用了旧版本 v1.0
  → 应该引用: v1.2
```

**完成标准**:
- CHANGELOG和claude.md版本号一致
- 设计文档版本号与当前版本匹配
- 无失效的版本引用

### 维度5: 🔗 交叉引用有效性

**检查内容**:
- [文档名](路径) 是否有效
- §章节号 引用是否正确
- @文件引用 是否存在

**输出示例**:
```markdown
### 🔗 交叉引用有效性

✅ **有效的引用**: 25个

❌ **失效的引用** (2个):
- development/active/issues/questions.md:45 → [已归档文档](../archive/old.md)
  → 文件已移动,应该引用: ../archive/scoring-system-discussion-2025-01-05.md

- docs/design/system-design.md:78 → §5.2
  → §5.2 不存在,应该是 §5.1

**引用有效性**: 92% (25/27有效)
```

**完成标准**:
- 100%内部链接有效
- 外部链接(可选)尽量有效

---

## 📊 完整报告示例

```markdown
# ✅ 模块完成度验证报告

**验证模块**: 评分系统设计
**验证时间**: 2025-01-10 23:45
**验证标准**: "全面检查,确保无遗漏"
**验证人**: completion-check-agent

---

## 📄 文档完整性

✅ **存在的文档**:
- ✅ 设计文档: docs/design/评分系统设计方案_v1.0.md
- ✅ 问题清单: development/active/issues/scoring-system-questions.md
- ✅ CHANGELOG: CHANGELOG.md
- ⚠️  决策记录: (不存在,可选)

❌ **缺失的文档**:
- ❌ API文档: docs/api/scoring-api.md (建议创建)

✅ **文档完整性**: 75% (3/4项必需文档)

---

## ✅ 问题完成度

**问题清单**: scoring-system-questions.md
- ✅ 已确认: 29个问题 (100%)
- 🔄 讨论中: 0个问题
- ❌ 未讨论: 0个问题

**完成度**: ⭐⭐⭐⭐⭐ 100%

✅ **问题100%完成,可以进行下一阶段**

---

## 🔄 文档同步状态

✅ **一致的文档** (5个):
- 评分系统设计方案_v1.0.md
- 排名系统技术实现文档_v1.0.md
- 用户角色与权限定义.md
- CHANGELOG.md
- claude.md

✅ **无发现不一致**

✅ **同步完整性**: 100% (所有问题已同步)

---

## 🔢 版本号一致性

**当前版本**: v1.2

✅ **版本号一致**:
- CHANGELOG.md: v1.2 ✅
- claude.md: v1.2 ✅
- 设计文档: v1.0 (可以接受,非关键文档)

✅ **无版本号冲突**

---

## 🔗 交叉引用有效性

✅ **有效的引用**: 42个

❌ **失效的引用** (1个):
- docs/design/scoring-system.md:123 → [参考文档](../obsolete.md)
  → 文件已删除
  → 建议: 移除此引用或更新为正确路径

**引用有效性**: 97.6% (42/43有效)

---

## 📊 总体评估

**完成度评分**: ⭐⭐⭐⭐⭐ (5/5星)

**完成的部分**:
1. ✅ 所有必需文档完整
2. ✅ 所有问题100%确认并同步
3. ✅ 版本号统一
4. ✅ 交叉引用基本有效

**待完成的部分**:
1. 🟡 建议创建API文档(开发阶段需要)
2. 🟢 可选: 修复1个失效引用

---

## 📝 待办事项清单

### 🔴 必须完成 (阻塞进入下一阶段)

**无阻塞性问题!** ✅

### 🟡 建议完成 (提升质量)

- [ ] 创建API文档: docs/api/scoring-api.md
  **预计时间**: 30分钟
  **建议**: 开发前创建,便于API设计讨论

### 🟢 可选优化 (锦上添花)

- [ ] 修复失效引用: docs/design/scoring-system.md:123
  **预计时间**: 5分钟
  **建议**: 移除或更新为正确路径

---

## 💡 下一步行动

### 立即行动:
1. ✅ **可以进入开发阶段**
2. 📝 建议先创建API文档

### 建议行动:
1. 使用 code-review-agent 审核未来代码
2. 准备开发环境和工具

---

## 🎯 结论

**完成状态**: ✅ 可以进入开发阶段

**理由**:
- 所有问题100%确认并同步到设计文档
- 版本号统一
- 无阻塞性问题
- 文档完整性达标

**建议**:
- ✅ 可以立即开始开发
- 🟡 建议先创建API文档
- 🟢 可选修复失效引用

---

**报告生成时间**: 2025-01-10 23:45
**Agent版本**: v1.0
**下次验证建议**: 开发完成后重新验证开发完整性
```

---

## 💡 使用技巧

### 技巧1: 设计完成后验证

```yaml
时机: 所有问题讨论完成后
目的: 确保可以进入开发阶段
检查重点:
  - 问题100%完成
  - 决策已同步
  - 无A级问题
```

### 技巧2: 开发完成后验证

```yaml
时机: 代码开发完成后
目的: 确保可以部署上线
检查重点:
  - 功能全部实现
  - 测试通过
  - 文档完整
```

### 技巧3: 版本发布前验证

```yaml
时机: 准备发布新版本前
目的: 确保质量达标
检查重点:
  - 版本号统一
  - CHANGELOG更新
  - 交叉引用有效
```

### 技巧4: 定期健康检查

```yaml
时机: 每周或每里程碑
目的: 及时发现问题
检查重点:
  - 文档同步状态
  - 版本号一致性
  - 引用有效性
```

---

## ⚠️ 注意事项

### 何时使用

```yaml
✅ 推荐使用:
  - 模块设计完成
  - 准备进入下一阶段
  - 版本发布前
  - 定期健康检查

❌ 不推荐使用:
  - 问题讨论进行中
  - 只想检查单个文档
  - 快速查看进度(用 /check-progress)
```

### 理解评估结果

```yaml
5星 (⭐⭐⭐⭐⭐):
  - 无必须完成的待办
  - 可以立即进入下一阶段

4星 (⭐⭐⭐⭐):
  - 有少量建议待办
  - 修复后进入下一阶段

3星及以下:
  - 有必须完成的待办
  - 完成后重新验证
```

---

## 🔄 与其他Agent的配合

### 设计阶段完整流程

```yaml
1. discussion-agent
   → 讨论所有问题

2. completion-check-agent ← 本Agent
   → 验证设计完整性

3. doc-sync-agent
   → 补充缺失的同步

4. design-audit-agent
   → 质量深度审核

5. completion-check-agent
   → 再次验证,确认可以进入开发
```

### 开发阶段完整流程

```yaml
1. 代码开发
   → 实现所有功能

2. completion-check-agent ← 本Agent
   → 验证开发完整性

3. code-review-agent
   → 代码审核

4. completion-check-agent
   → 最终验证,确认可以部署
```

---

## 📞 常见问题

### Q1: 和/sync-docs有什么区别?

**A**:
- `/sync-docs`: 同步问题决策到设计文档,更新版本号
- `completion-check-agent`: 全面检查模块完整性,不修改文件

### Q2: 检查到问题会自动修复吗?

**A**: 不会。本Agent只检查和报告,不修改文件。
- 使用 `doc-sync-agent` 同步文档
- 使用 `design-audit-agent` 深度审核
- 手动修复其他问题

### Q3: 多久应该运行一次?

**A**:
- **设计阶段**: 模块完成后1次
- **开发阶段**: 开发完成后1次
- **版本发布**: 发布前1次
- **定期检查**: 每周或每里程碑1次

### Q4: 完成度评分标准是什么?

**A**:
- **5星**: 无必须完成的待办,可进入下一阶段
- **4星**: 有少量建议待办,质量很好
- **3星**: 有一些必须完成的待办
- **2星及以下**: 有严重问题,需要大量补充

### Q5: 必须完成所有待办吗?

**A**:
- **🔴 必须完成**: 是,阻塞进入下一阶段
- **🟡 建议完成**: 强烈建议,提升质量
- **🟢 可选优化**: 可选,锦上添花

---

## 🎓 最佳实践

### 实践1: 里程碑验证

```yaml
每个模块完成后:
  1. completion-check-agent 验证
  2. 根据TODO清单补充
  3. 重新验证确认
  4. 进入下一阶段
```

### 实践2: 质量门禁

```yaml
建立质量标准:
  - 设计阶段: 必须4星以上
  - 开发阶段: 必须5星
  - 发布前: 必须5星
```

### 实践3: 团队协作

```yaml
多人协作时:
  1. 设计者完成后调用验证
  2. 生成报告给团队review
  3. 团队确认后进入下一阶段
  4. 所有人看到同一份报告
```

---

## 📈 效果对比

### 使用前

```yaml
问题1: 不清楚是否真的完成
  - 不知道还缺什么
  - 可能遗漏重要文档

问题2: 没有明确标准
  - 不知道是否可以进入下一阶段
  - 主观判断质量

问题3: 容易遗漏问题
  - 忘记同步决策
  - 忘记更新版本号
```

### 使用后

```yaml
解决1: 系统化检查
  - 5个维度全面验证
  - 清晰的待办清单

解决2: 明确的完成标准
  - 量化评分(1-5星)
  - 明确是否可进入下一阶段

解决3: 防止遗漏
  - 不会忘记同步
  - 不会忘记更新版本号
```

---

## 🔄 版本历史

### v1.0 (2025-01-10)

**新增**:
- 5维验证系统
- 完成度评分
- TODO清单生成
- 下一步行动建议

**特点**:
- 系统化检查
- 防止遗漏
- 明确的完成标准

---

**使用指南创建时间**: 2025-01-10
**维护人**: 老黑(Claude)
**Agent状态**: ✅ 已完成并部署
**版本**: v1.0
