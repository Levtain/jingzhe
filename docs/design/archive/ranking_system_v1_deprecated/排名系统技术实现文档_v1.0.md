# æƒŠè›°è®¡åˆ’ç¬¬ä¸€å±Š - æ’åç³»ç»ŸæŠ€æœ¯å®ç°æ–‡æ¡£

> **ç‰ˆæœ¬**: v1.0
> **æ—¥æœŸ**: 2025-01-06
> **ä½œè€…**: è€é»‘(Claude)
> **çŠ¶æ€**: æŠ€æœ¯æ ‡å‡†æ–‡æ¡£
> **é€‚ç”¨**: ç¬¬ä¸€å±Šæ¯”èµ›

---

## æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£æ˜¯æƒŠè›°è®¡åˆ’ç¬¬ä¸€å±Šæ’åç³»ç»Ÿçš„å®Œæ•´æŠ€æœ¯å®ç°è§„èŒƒ,åŸºäºä»¥ä¸‹èµ„æ–™æ•´åˆè€Œæˆ:
- å¯è¡Œæ€§ç ”åˆ¤æŠ¥å‘Š(6ç¯‡æŠ€æœ¯æ–‡æ¡£åˆ†æ)
- æƒŠè›°è®¡åˆ’ç¬¬ä¸€å±Šè¯„åˆ†æ’åç³»ç»Ÿå®æ–½æ–¹æ¡ˆ
- è¯„åˆ†ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ_v1.0

**æ ¸å¿ƒåŸåˆ™**:
> "é€æ˜ä¼˜äºå¤æ‚,ç¨³å®šä¼˜äºå®Œç¾"

---

## ä¸€ã€ç³»ç»Ÿæ¶æ„æ€»è§ˆ

### 1.1 è®¾è®¡ç†å¿µ

ä¸‰å¤§æ”¯æŸ±:
1. **å¯è§£é‡Šæ€§** - æ¯ä¸ªè®¡ç®—æ­¥éª¤éƒ½èƒ½ç”¨ä¸€å¥è¯å‘ç”¨æˆ·è§£é‡Šæ¸…æ¥š
2. **æŠ—æ‰°åŠ¨æ€§** - èƒ½æŠµå¾¡å¸¸è§åˆ·åˆ†è¡Œä¸º,ä½†ä¸è¿½æ±‚å®Œç¾é˜²å¾¡
3. **æ¸è¿›å…¬å¹³** - æ‰¿è®¤ç¬¬ä¸€å±Šçš„ä¸å®Œç¾,ä½†ç¡®ä¿åŸºæœ¬å…¬å¹³,å¹¶æ‰¿è¯ºæŒç»­æ”¹è¿›

### 1.2 ç³»ç»Ÿæµç¨‹å›¾

```
ç”¨æˆ·è¯„åˆ†
    â†“
[é¢„å¤„ç†å±‚]
â”œâ”€â”€ è‡ªè¯„è¿‡æ»¤(è‡ªåŠ¨)
â”œâ”€â”€ é«˜å±è¡Œä¸ºæ ‡è®°(è‡ªåŠ¨+äººå·¥å¤æ ¸)
â””â”€â”€ åŸºç¡€å®Œæ•´æ€§æ£€æŸ¥
    â†“
[èµ„æ ¼åˆ¤å®šå±‚] â†’ æœªè¾¾é—¨æ§› â†’ æ˜¾ç¤º"æœªè¾¾æ’åé—¨æ§›"
    â†“ (æ€»è¯„åˆ†äººæ¬¡ > 15, ç¬¬ä¸€å±Š)
[è®¡ç®—æ ¸å¿ƒå±‚]
â”œâ”€â”€ æˆªå°¾å‡å€¼(å»æç«¯å€¼,10%)
â”œâ”€â”€ è´å¶æ–¯å¹³æ»‘(é˜²å°æ ·æœ¬åå·®,k=20)
â””â”€â”€ å¹¶åˆ—è£å†³(ä¸‰çº§tie-breaker)
    â†“
[è¾“å‡ºå±‚]
â”œâ”€â”€ å„ç»´åº¦ç‹¬ç«‹æ’å
â”œâ”€â”€ "ä¼˜é€‰æ¸¸æˆ"æ ‡è¯†(3+ç»´åº¦Top10)
â””â”€â”€ ç”¨æˆ·å¯è§çš„å¾—åˆ†è§£é‡Š
```

### 1.3 ä¸ç°æœ‰è®¾è®¡çš„å…³ç³»

**å®Œå…¨å…¼å®¹**:
- âœ… é©å‘½æ€§æ’åç³»ç»Ÿ: 12ä¸ªç‹¬ç«‹æ¦œå•
- âœ… ä¼˜é€‰æ¸¸æˆæœºåˆ¶: 3ä¸ªç»´åº¦å‰10
- âœ… æ’åèµ„æ ¼: >15äººæ¬¡(ç¬¬ä¸€å±Š)
- âœ… è¯„å®¡å›¢æƒé‡Ã—2: ä»…å½±å“è¯„åˆ†äººæ¬¡ç»Ÿè®¡
- âœ… åä½œå¼Šæœºåˆ¶: é«˜å±ç›‘æµ‹+é«˜é¢‘å·®è¯„æ£€æµ‹

**æ–°å¢å†…å®¹**:
- ğŸ†• æ’åè®¡ç®—æ–¹æ³•: æˆªå°¾å‡å€¼+è´å¶æ–¯å¹³æ»‘
- ğŸ†• å¹¶åˆ—å¤„ç†è§„åˆ™: ä¸‰çº§tie-breaker
- ğŸ†• ç›‘æ§æŒ‡æ ‡ä½“ç³»: ç®—æ³•å¥åº·åº¦+å…¬å¹³æ€§+æ€§èƒ½

---

## äºŒã€æ ¸å¿ƒç®—æ³•è§„èŒƒ

### 2.1 æ•°æ®é¢„å¤„ç†

#### å‡½æ•°: `preprocess_ratings(game, dimension)`

**è¾“å…¥**:
- `game`: æ¸¸æˆå¯¹è±¡
- `dimension`: è¯„åˆ†ç»´åº¦(å¦‚"åˆ›æ–°æ€§")

**è¾“å‡º**: `(æœ‰æ•ˆè¯„åˆ†åˆ—è¡¨, å¯ç–‘è¯„åˆ†åˆ—è¡¨, æ€»æœ‰æ•ˆäººæ¬¡)`

**å¤„ç†è§„åˆ™**:

```python
# è§„åˆ™1: æ’é™¤è‡ªè¯„
if rating.rater_id == game.creator_id:
    continue

# è§„åˆ™2: é«˜å±è¡Œä¸ºæ ‡è®°(ä»…æ ‡è®°,ä¸è‡ªåŠ¨æ’é™¤)
if rating.is_high_risk:
    suspicious_ratings.append(rating)
    valid_ratings.append(rating)  # ä»è®¡å…¥,è®°å½•å®¡è®¡æ—¥å¿—
    continue

# è§„åˆ™3: å®Œæ•´æ€§æ£€æŸ¥
if not (0 <= rating.score <= 10):
    continue

# è§„åˆ™4: è®¡ç®—æœ‰æ•ˆäººæ¬¡(è¯„å®¡å›¢Ã—2)
contestant_count = len([r for r in valid_ratings if r.rater_type == 'contestant'])
jury_count = len([r for r in valid_ratings if r.rater_type == 'jury'])
total_effective_ratings = contestant_count + 2 * jury_count
```

**å…³é”®è®¾è®¡**:
- è‡ªè¯„: å®Œå…¨æ’é™¤
- é«˜å±è¯„åˆ†: æ ‡è®°ä½†ä»è®¡å…¥,é¿å…è¯¯æ€
- äººæ¬¡è®¡ç®—: è¯„å®¡å›¢Ã—2,ä¸æ’åèµ„æ ¼ä¿æŒä¸€è‡´

---

### 2.2 æ’åèµ„æ ¼åˆ¤å®š

#### å‡½æ•°: `check_ranking_eligibility(total_effective_ratings, total_games, total_jury, contestant_count, jury_count)`

**é…ç½®å‚æ•°**:
```python
# å‚èµ›è€…ç»„é—¨æ§›(åŠ¨æ€)
MIN_RATINGS_ABSOLUTE = 20  # ç»å¯¹åº•çº¿
MIN_RATINGS_PERCENT = 0.3  # 30%è§„åˆ™

# è¯„å®¡å›¢ç»„é—¨æ§›(åŠ¨æ€)
MIN_JURY_ABSOLUTE = 5  # ç»å¯¹åº•çº¿
MIN_JURY_PERCENT = 0.5  # 50%è§„åˆ™

# å¼ºåˆ¶è¯„åˆ†æ•°é‡
MIN_RATED_GAMES_BY_CREATOR = 10  # å‚èµ›è€…å¿…é¡»è¯„åˆ†çš„æ¸¸æˆæ•°
```

**åˆ¤å®šé€»è¾‘**:

```python
def check_ranking_eligibility(total_effective_ratings, total_games, total_jury,
                              contestant_count, jury_count, rated_games_by_creator):
    """
    æ’åèµ„æ ¼åˆ¤å®š(ç¬¬ä¸€å±Šä¿®æ­£ç‰ˆ)

    æ–°å¢3ä¸ªæ£€æŸ¥:
    1. å‚èµ›è€…æ˜¯å¦è¯„åˆ†äº†è‡³å°‘10ä¸ªæ¸¸æˆ
    2. å‚èµ›è€…ç»„æ˜¯å¦è¾¾åˆ°åŠ¨æ€é—¨æ§›
    3. è¯„å®¡å›¢ç»„æ˜¯å¦è¾¾åˆ°åŠ¨æ€é—¨æ§›
    """

    # æ£€æŸ¥1: å‚èµ›è€…æ˜¯å¦è¯„åˆ†äº†è¶³å¤Ÿçš„æ¸¸æˆ(è½¯æ€§å¼ºåˆ¶)
    if rated_games_by_creator < MIN_RATED_GAMES_BY_CREATOR:
        return {
            'eligible': False,
            'reason': f'éœ€è¦è¯„åˆ†è‡³å°‘{MIN_RATED_GAMES_BY_CREATOR}ä¸ªæ¸¸æˆæ‰èƒ½è¿›å…¥æ’å(å·²è¯„åˆ†{rated_games_by_creator}ä¸ª)',
            'actual_count': total_effective_ratings
        }

    # æ£€æŸ¥2: å‚èµ›è€…ç»„åŠ¨æ€é—¨æ§›
    contestant_threshold = max(MIN_RATINGS_ABSOLUTE, int(total_games * MIN_RATINGS_PERCENT))
    if contestant_count < contestant_threshold:
        return {
            'eligible': False,
            'reason': f'å‚èµ›è€…è¯„åˆ†äººæ¬¡ä¸è¶³(éœ€è¦{contestant_threshold}ï¼Œå®é™…{contestant_count})',
            'actual_count': total_effective_ratings
        }

    # æ£€æŸ¥3: è¯„å®¡å›¢ç»„åŠ¨æ€é—¨æ§›
    jury_threshold = max(MIN_JURY_ABSOLUTE, int(total_jury * MIN_JURY_PERCENT))
    if jury_count < jury_threshold:
        return {
            'eligible': False,
            'reason': f'è¯„å®¡å›¢è¯„åˆ†äººæ¬¡ä¸è¶³(éœ€è¦{jury_threshold}ï¼Œå®é™…{jury_count})',
            'actual_count': total_effective_ratings
        }

    # æ‰€æœ‰æ£€æŸ¥é€šè¿‡
    return {'eligible': True}
```

**ç¤ºä¾‹è®¡ç®—**:

```python
# åœºæ™¯: 100ä¸ªæ¸¸æˆå‚èµ›,10ä¸ªè¯„å®¡å›¢
check_ranking_eligibility(
    total_effective_ratings=41,
    total_games=100,
    total_jury=10,
    contestant_count=35,
    jury_count=3,
    rated_games_by_creator=12
)

# ç»“æœ: âœ… eligible=True
# - å‚èµ›è€…è¯„åˆ†äº†12ä¸ªæ¸¸æˆ â‰¥ 10 âœ“
# - å‚èµ›è€…è¯„åˆ†35äººæ¬¡ â‰¥ max(20, 100Ã—30%=30) âœ“
# - è¯„å®¡å›¢è¯„åˆ†3äººæ¬¡ â‰¥ max(5, 10Ã—50%=5) âœ“
```

**è¾“å‡º**:
- è¾¾æ ‡: è¿›å…¥æ’åè®¡ç®—æµç¨‹
- æœªè¾¾æ ‡: æ˜¾ç¤ºå…·ä½“æœªè¾¾æ ‡åŸå› ,ä½†ä»æ˜¾ç¤ºåŸå§‹å¹³å‡åˆ†ä¾›å‚è€ƒ

**ç¬¬ä¸€å±Šè¡¥å……è¯´æ˜**:
- å¦‚æœå‚èµ›æ¸¸æˆ<50ä¸ª,å‚èµ›è€…ç»„é—¨æ§›ä¿æŒ20äººæ¬¡ä¸å˜
- å‚èµ›è€…å¿…é¡»è¯„åˆ†â‰¥10ä¸ªæ¸¸æˆ,è‡ªå·±çš„æ¸¸æˆæ‰èƒ½æ’å(è½¯æ€§å¼ºåˆ¶)

---

### 2.3 æˆªå°¾å‡å€¼(æŠ—æç«¯å€¼)

#### å‡½æ•°: `winsorized_mean(scores)`

**ç®—æ³•åŸç†**:
å»æ‰æœ€é«˜å’Œæœ€ä½å„10%çš„è¯„åˆ†,å¯¹å‰©ä½™è¯„åˆ†æ±‚ç®—æœ¯å¹³å‡ã€‚

**é…ç½®å‚æ•°**:
```python
TRIM_PERCENT = 0.1  # å»æ‰æœ€é«˜å’Œæœ€ä½å„10%
MIN_SAMPLES_FOR_TRIM = 10  # å°‘äº10ä¸ªè¯„åˆ†æ—¶ä¸æˆªæ–­
```

**å®ç°é€»è¾‘**:

```python
def winsorized_mean(scores):
    n = len(scores)

    # å°æ ·æœ¬ä¿æŠ¤
    if n < 10:
        return sum(scores) / n, {'method': 'arithmetic_mean'}

    # è®¡ç®—æˆªæ–­æ•°é‡
    k = int(n * 0.1)

    # è‡³å°‘æˆªæ‰1ä¸ªæœ€é«˜åˆ†å’Œ1ä¸ªæœ€ä½åˆ†
    if k == 0 and n >= 10:
        k = 1

    # æ’åºå¹¶æˆªæ–­
    sorted_scores = sorted(scores)
    trimmed_scores = sorted_scores[k:n-k]

    # è®¡ç®—å‡å€¼
    result = sum(trimmed_scores) / len(trimmed_scores)

    return result, {
        'method': 'winsorized_mean',
        'trim_percent': 0.1,
        'trimmed_count': 2 * k,
        'original_count': n,
        'remaining_count': len(trimmed_scores)
    }
```

**ç¤ºä¾‹**:
```
åŸå§‹è¯„åˆ†: [9, 9, 8, 8, 8, 7, 7, 6, 1, 1] (10ä¸ª)
æ’åºå: [1, 1, 6, 7, 7, 8, 8, 8, 9, 9]
æˆªæ–­: å»æ‰æœ€ä½1ä¸ª(1)å’Œæœ€é«˜1ä¸ª(9)
å‰©ä½™: [1, 6, 7, 7, 8, 8, 8, 9]
æˆªå°¾å‡å€¼: 6.75åˆ†
```

**è®¾è®¡ç†ç”±**:
- ä¸ç”¨ä¸­ä½æ•°: ä¿ç•™æ›´å¤šä¿¡æ¯
- ä¸ç”¨Huber Mean: é¿å…è¿­ä»£æ”¶æ•›é—®é¢˜
- å›ºå®š10%: ç®€å•å¯è§£é‡Š

**ç”¨æˆ·å¯ç†è§£ç‰ˆæœ¬**:
> "å»æ‰æœ€é«˜10%å’Œæœ€ä½10%çš„æç«¯è¯„åˆ†å,å¯¹å‰©ä½™è¯„åˆ†æ±‚å¹³å‡ã€‚ä¾‹å¦‚100ä¸ªè¯„åˆ†,å»æ‰æœ€é«˜çš„10ä¸ªå’Œæœ€ä½çš„10ä¸ª,ç”¨ä¸­é—´80ä¸ªè®¡ç®—å¹³å‡åˆ†ã€‚"

---

### 2.4 è´å¶æ–¯å¹³æ»‘(é˜²å°æ ·æœ¬åå·®)

#### å‡½æ•°: `bayesian_smoothing(robust_mean, effective_rating_count, global_mean)`

**ç®—æ³•åŸç†**:
å°æ ·æœ¬å‘å…¨å±€å‡å€¼å›å½’,å¤§æ ·æœ¬å‡ ä¹ä¸å—å½±å“ã€‚

**é…ç½®å‚æ•°**:
```python
BAYESIAN_K = 20  # å¹³æ»‘å¼ºåº¦å‚æ•°
```

**æ•°å­¦å…¬å¼**:
```
S' = (n Ã— S + k Ã— Î¼) / (n + k)

å…¶ä¸­:
- S' = å¹³æ»‘åçš„æœ€ç»ˆå¾—åˆ†
- S = æˆªå°¾å‡å€¼
- n = è¯„åˆ†äººæ¬¡(è¯„å®¡å›¢Ã—2)
- k = 20 (å¹³æ»‘å¼ºåº¦å‚æ•°)
- Î¼ = å…¨å±€å¹³å‡åˆ†
```

**å®ç°é€»è¾‘**:

```python
def bayesian_smoothing(robust_mean, effective_rating_count, global_mean):
    k = 20

    if effective_rating_count == 0:
        return global_mean, {'method': 'global_mean_only'}

    # è®¡ç®—å¹³æ»‘ååˆ†æ•°
    smoothed = (effective_rating_count * robust_mean + k * global_mean) / (effective_rating_count + k)

    return smoothed, {
        'method': 'bayesian_smoothing',
        'k': k,
        'global_mean': global_mean,
        'effective_rating_count': effective_rating_count,
        'influence_ratio': k / (effective_rating_count + k),  # å…¨å±€å‡å€¼çš„å½±å“æ¯”ä¾‹
        'robust_mean': robust_mean
    }
```

**æ•ˆæœç¤ºä¾‹**:

å‡è®¾å…¨å±€å¹³å‡ Î¼ = 7.2åˆ†, k = 20

| æ¸¸æˆè¯„åˆ†äººæ•° | åŸå§‹å¹³å‡åˆ† | å¹³æ»‘åå¾—åˆ† | è°ƒæ•´å¹…åº¦ | å…¨å±€å‡å€¼å½±å“ |
|-----------|----------|----------|---------|------------|
| 3äºº | 9.0åˆ† | 7.8åˆ† | -1.2åˆ† | 87% |
| 10äºº | 8.5åˆ† | 8.0åˆ† | -0.5åˆ† | 67% |
| 20äºº | 8.3åˆ† | 7.75åˆ† | -0.55åˆ† | 50% |
| 50äºº | 8.3åˆ† | 8.2åˆ† | -0.1åˆ† | 29% |
| 100äºº | 8.3åˆ† | 8.28åˆ† | -0.02åˆ† | 17% |

**è®¾è®¡ç†ç”±**:
- k=20: çº¦éœ€20ä¸ªè¯„åˆ†æ‰èƒ½æ‘†è„±å…¨å±€å‡å€¼çš„ä¸€åŠå½±å“
- å¯¹äº50-200äººçš„æ¯”èµ›,20æ˜¯åˆç†çš„"å¯ä¿¡æ ·æœ¬"é˜ˆå€¼

**é‡è¦è¯´æ˜**:
- `effective_rating_count`: ä½¿ç”¨"äººæ¬¡"è€Œé"äººæ•°"(è¯„å®¡å›¢Ã—2)
- è¿™ä¸æ’åèµ„æ ¼çš„"äººæ¬¡"æ¦‚å¿µä¿æŒä¸€è‡´

**ç”¨æˆ·å¯ç†è§£ç‰ˆæœ¬**:
> "å¦‚æœä½ çš„æ¸¸æˆè¯„åˆ†äººæ•°è¾ƒå°‘,æˆ‘ä»¬ä¼šå‚è€ƒå…¨å±€å¹³å‡æ°´å¹³è¿›è¡Œè°ƒæ•´ã€‚ä¾‹å¦‚å…¨å±€å¹³å‡7.2åˆ†,ä½ çš„æ¸¸æˆåªæœ‰3äººè¯„9.0åˆ†,æˆ‘ä»¬ä¼šè°ƒæ•´ä¸º7.8åˆ†,é¿å…å¶ç„¶æ€§ã€‚éšç€è¯„åˆ†äººæ•°å¢åŠ ,è°ƒæ•´å¹…åº¦ä¼šå‡å°ã€‚"

---

### 2.5 å…¨å±€å‡å€¼è®¡ç®—

#### å‡½æ•°: `calculate_global_mean(all_games, dimension)`

**ä¿®æ­£è¯´æ˜**: å…¨å±€å‡å€¼åªåŒ…å«**é€šè¿‡æ’åé—¨æ§›çš„æ¸¸æˆ**

**å®ç°é€»è¾‘**:

```python
def calculate_global_mean(all_games, dimension):
    robust_means = []

    for game in all_games:
        # æ­¥éª¤1: é¢„å¤„ç†è¯„åˆ†
        valid_ratings, _, total_count = preprocess_ratings(game, dimension)

        # æ­¥éª¤2: æ£€æŸ¥æ˜¯å¦é€šè¿‡æ’åé—¨æ§›
        if total_count <= 15:  # ç¬¬ä¸€å±Šé—¨æ§›>15
            continue  # æœªè¾¾é—¨æ§›çš„æ¸¸æˆä¸è®¡å…¥å…¨å±€å‡å€¼

        # æ­¥éª¤3: è®¡ç®—æˆªå°¾å‡å€¼
        if len(valid_ratings) > 0:
            scores = [r.score for r in valid_ratings]
            robust_mean, _ = winsorized_mean(scores)
            robust_means.append(robust_mean)

    if not robust_means:
        return 7.0  # é»˜è®¤å…¨å±€å‡å€¼

    return sum(robust_means) / len(robust_means)
```

**è®¾è®¡ç†ç”±**:
- **é€»è¾‘ä¸€è‡´æ€§**: åªæœ‰è¿‡äº†é—¨æ§›çš„æ¸¸æˆæ‰å‚ä¸æ’å,å…¨å±€å‡å€¼ä½œä¸ºæ’åè®¡ç®—åŸºå‡†ä¹Ÿåº”åŸºäºæ’åæ¸¸æˆ
- **å…¬å¹³æ€§**: æœªè¾¾é—¨æ§›çš„æ¸¸æˆè´¨é‡å‚å·®ä¸é½,åŒ…å«å®ƒä»¬ä¼šæ‰­æ›²å…¨å±€å‡å€¼
- **ç”¨æˆ·æœŸæœ›**: ç”¨æˆ·ç†è§£çš„å…¨å±€å‡å€¼æ˜¯"æ‰€æœ‰å¯æ’åæ¸¸æˆçš„å¹³å‡æ°´å¹³"

**é‡è¦å˜æ›´** (v2.4):
- æ—§ç‰ˆ: åŒ…å«æ‰€æœ‰æœ‰è¯„åˆ†çš„æ¸¸æˆ âŒ
- æ–°ç‰ˆ: åªåŒ…å«é€šè¿‡æ’åé—¨æ§›çš„æ¸¸æˆ âœ…

---

### 2.6 å¹¶åˆ—å¤„ç†è§„åˆ™

#### å‡½æ•°: `break_ties(game_a, game_b)`

**é…ç½®å‚æ•°**:
```python
TIE_EPSILON = 0.01  # è§†ä¸ºå¹¶åˆ—çš„åˆ†æ•°å·®å¼‚é˜ˆå€¼(ä¿®æ­£:0.001â†’0.01)
```

**ä¸‰çº§Tie-breaker**:

```python
def break_ties(game_a, game_b):
    score_diff = abs(game_a['final_score'] - game_b['final_score'])

    # å¤§äº0.01åˆ†: ä¸æ˜¯å¹¶åˆ—
    if score_diff >= 0.01:
        return None

    # Tie-breaker 1: è¯„åˆ†äººæ¬¡å¤šçš„ä¼˜å…ˆ
    if game_a['effective_rating_count'] != game_b['effective_rating_count']:
        return 'A' if game_a['effective_rating_count'] > game_b['effective_rating_count'] else 'B'

    # Tie-breaker 2: æ–¹å·®å°çš„ä¼˜å…ˆ(æ›´ç¨³å®š)
    if abs(game_a['variance'] - game_b['variance']) > 1e-6:
        return 'A' if game_a['variance'] < game_b['variance'] else 'B'

    # Tie-breaker 3: è¯„å®¡å›¢è¯„åˆ†å æ¯”é«˜çš„ä¼˜å…ˆ
    jury_ratio_a = game_a['jury_count'] / game_a['rating_count']
    jury_ratio_b = game_b['jury_count'] / game_b['rating_count']

    if abs(jury_ratio_a - jury_ratio_b) > 0.01:
        return 'A' if jury_ratio_a > jury_ratio_b else 'B'

    # æ‰€æœ‰æ¡ä»¶éƒ½ç›¸åŒ -> å…è®¸å¹¶åˆ—
    return 'tie'
```

**è®¾è®¡ç†å¿µ**:
- ä¸ä¿®æ”¹åˆ†æ•°æœ¬èº«,åªå½±å“æ’åé¡ºåº
- æ˜ç¡®çš„ä¼˜å…ˆçº§é¡ºåº
- æœ€ç»ˆå¯æ¥å—å¹¶åˆ—

**ç”¨æˆ·å¯ç†è§£ç‰ˆæœ¬**:
> "å¦‚æœä¸¤äººåˆ†æ•°ç›¸åŒ(å·®è·<0.01åˆ†),æˆ‘ä»¬ä¼šä¾æ¬¡æ¯”è¾ƒ: 1) è¯„åˆ†äººæ¬¡å¤šçš„ä¼˜å…ˆ; 2) è¯„åˆ†æ›´ç¨³å®šçš„ä¼˜å…ˆ(æ–¹å·®å°); 3) è¯„å®¡å›¢è¯„åˆ†å æ¯”é«˜çš„ä¼˜å…ˆã€‚å¦‚æœè¿™äº›éƒ½ç›¸åŒ,åˆ™å…è®¸å¹¶åˆ—æ’åã€‚"

---

## ä¸‰ã€å®Œæ•´è®¡ç®—æµç¨‹

### 3.1 å•ç»´åº¦æ’åè®¡ç®—

#### å‡½æ•°: `calculate_dimension_ranking(all_games, dimension)`

**æ­¥éª¤**:

```
æ­¥éª¤1: è®¡ç®—å…¨å±€å‡å€¼
â””â”€â”€ ä»…åŒ…å«é€šè¿‡æ’åé—¨æ§›çš„æ¸¸æˆ(>15äººæ¬¡)

æ­¥éª¤2: è®¡ç®—æ¯ä¸ªæ¸¸æˆçš„æœ€ç»ˆå¾—åˆ†
â”œâ”€â”€ 2.1 é¢„å¤„ç†è¯„åˆ†
â”œâ”€â”€ 2.2 æ£€æŸ¥æ’åèµ„æ ¼
â”œâ”€â”€ 2.3 è®¡ç®—æˆªå°¾å‡å€¼
â””â”€â”€ 2.4 è´å¶æ–¯å¹³æ»‘

æ­¥éª¤3: æ’åº(ä»…å¯¹æ’åçš„æ¸¸æˆ)
â””â”€â”€ æŒ‰final_scoreé™åºæ’åˆ—

æ­¥éª¤4: åº”ç”¨tie-breaker
â””â”€â”€ å¤„ç†åŒåˆ†æƒ…å†µ

æ­¥éª¤5: åˆ†é…åæ¬¡(è€ƒè™‘å¹¶åˆ—)
â”œâ”€â”€ æœ‰æ’åçš„: æ˜¾ç¤ºæ’å(å¦‚"1", "T-2")
â””â”€â”€ æœªæ’åçš„: æ˜¾ç¤º"æœªè¾¾é—¨æ§›"

æ­¥éª¤6: è¿”å›å®Œæ•´ç»“æœ
```

**ä¼ªä»£ç **:

```python
def calculate_dimension_ranking(all_games, dimension):
    # æ­¥éª¤1: è®¡ç®—å…¨å±€å‡å€¼
    global_mean = calculate_global_mean(all_games, dimension)

    # æ­¥éª¤2: è®¡ç®—æ¯ä¸ªæ¸¸æˆçš„æœ€ç»ˆå¾—åˆ†
    results = []
    for game in all_games:
        game_result = calculate_game_final_score(game, dimension, global_mean)
        results.append(game_result)

    # æ­¥éª¤3-4: æ’åºå¹¶åº”ç”¨tie-breaker
    ranked_games = [g for g in results if g['is_ranked']]
    sorted_ranked = sort_and_apply_tie_breaker(ranked_games)

    # æ­¥éª¤5: åˆ†é…åæ¬¡
    assign_ranks(sorted_ranked)

    # æ­¥éª¤6: åˆå¹¶æœªæ’åæ¸¸æˆ
    unranked_games = [g for g in results if not g['is_ranked']]
    return sorted_ranked + unranked_games
```

---

### 3.2 æ•°æ®æµè½¬ç¤ºä¾‹

**åœºæ™¯**: æŸæ¸¸æˆåœ¨"åˆ›æ–°æ€§"ç»´åº¦

```
è¾“å…¥æ•°æ®:
- 15ä¸ªå‚èµ›è€…è¯„åˆ†: [9, 8, 10, 7, 8, 9, 6, 10, 8, 7, 9, 10, 8, 7, 9]
- 3ä¸ªè¯„å®¡å›¢è¯„åˆ†: [9, 10, 8]
- é«˜å±æ ‡è®°: 0ä¸ª

å¤„ç†æµç¨‹:

1. é¢„å¤„ç†:
   - æœ‰æ•ˆè¯„åˆ†: 18ä¸ª
   - è¯„åˆ†äººæ¬¡: 15 + 2Ã—3 = 21äººæ¬¡ âœ“ è¾¾æ ‡

2. å…¨å±€å‡å€¼: 7.15åˆ†(å‡è®¾)

3. æˆªå°¾å‡å€¼:
   - åŸå§‹è¯„åˆ†æ’åº: [6, 7, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9, 10, 10, 10, 9, 10, 8]
   - å»æ‰æœ€ä½1ä¸ª(6)å’Œæœ€é«˜1ä¸ª(10)
   - å‰©ä½™16ä¸ªè¯„åˆ†çš„å¹³å‡: 8.42åˆ†

4. è´å¶æ–¯å¹³æ»‘:
   - robust_mean = 8.42
   - effective_count = 21
   - global_mean = 7.15
   - k = 20
   - smoothed = (21Ã—8.42 + 20Ã—7.15) / (21+20) = 7.81åˆ†

5. è¾“å‡º:
   - æœ€ç»ˆå¾—åˆ†: 7.81åˆ†
   - åŸå§‹å¹³å‡: 8.39åˆ†
   - æˆªå°¾å‡å€¼: 8.42åˆ†
   - è¯„åˆ†äººæ•°: 18äºº
   - è¯„åˆ†äººæ¬¡: 21äººæ¬¡
```

---

## å››ã€é…ç½®å‚æ•°è§„èŒƒ

### 4.1 æ¨èé…ç½®(ç¬¬ä¸€å±Š)

```yaml
ranking_config:
  # ===== å‚èµ›è€…è¯„åˆ†èµ„æ ¼(è½¯æ€§å¼ºåˆ¶) =====
  min_rated_games_by_creator: 10  # å‚èµ›è€…å¿…é¡»è¯„åˆ†è‡³å°‘10ä¸ªæ¸¸æˆ

  # ===== å‚èµ›è€…ç»„é—¨æ§›(åŠ¨æ€) =====
  min_ratings_absolute: 15  # ç¬¬ä¸€å±Šç»å¯¹åº•çº¿
  min_ratings_percent: 0.3  # 30%è§„åˆ™

  # ===== è¯„å®¡å›¢ç»„é—¨æ§›(åŠ¨æ€) =====
  min_jury_absolute: 5  # ç»å¯¹åº•çº¿
  min_jury_percent: 0.5  # 50%è§„åˆ™

  # ===== æˆªå°¾å‡å€¼ =====
  trim_percent: 0.1  # å»æ‰æœ€é«˜å’Œæœ€ä½å„10%
  min_samples_for_trim: 10  # å°‘äº10ä¸ªè¯„åˆ†æ—¶ä¸æˆªæ–­

  # ===== è´å¶æ–¯å¹³æ»‘ =====
  bayesian_k: 20  # å¹³æ»‘å¼ºåº¦å‚æ•°
  default_global_mean: 7.0  # é»˜è®¤å…¨å±€å‡å€¼(å½“æ— æ•°æ®æ—¶ä½¿ç”¨)

  # ===== å¹¶åˆ—å¤„ç† =====
  tie_epsilon: 0.001  # è§†ä¸ºå¹¶åˆ—çš„åˆ†æ•°å·®å¼‚é˜ˆå€¼(ç»Ÿä¸€3ä½å°æ•°ç²¾åº¦)

  # ===== ç‰¹æ®Šå¤„ç† =====
  enable_jury_weight_in_average: false  # è¯„å®¡å›¢è¯„åˆ†åœ¨å¹³å‡åˆ†æ—¶ä¸åŠ æƒ
  enable_rts: false  # ç¬¬ä¸€å±Šä¸ä½¿ç”¨è¯„åˆ†è€…ä¿¡èª‰ç³»ç»Ÿ

  # ===== ä¼˜é€‰æ¸¸æˆåˆ¤å®š =====
  preferred_game_min_dimensions: 3  # è‡³å°‘3ä¸ªç»´åº¦å‰10
  preferred_game_only_ranked: true  # ä»…è®¡ç®—å‚ä¸æ’åçš„ç»´åº¦
```

**ç¬¬ä¸€å±Šè¡¥å……è¯´æ˜**:
- å¦‚æœå‚èµ›æ¸¸æˆ<50ä¸ª,å‚èµ›è€…ç»„é—¨æ§›ä¿æŒ20äººæ¬¡ä¸å˜
- å‚èµ›è€…å¿…é¡»è¯„åˆ†â‰¥10ä¸ªæ¸¸æˆ,è‡ªå·±çš„æ¸¸æˆæ‰èƒ½æ’å(è½¯æ€§å¼ºåˆ¶)
- ä¼˜é€‰æ¸¸æˆåˆ¤å®šåªçœ‹å‚ä¸æ’åçš„ç»´åº¦(AIä½¿ç”¨çš„ç»´åº¦ä¸å‚ä¸)

### 4.2 å‚æ•°è°ƒä¼˜é€»è¾‘

#### èµ›å‰é¢„è®¾
ä½¿ç”¨ä¸Šè¿°æ¨èå€¼

#### èµ›ä¸­ç›‘æ§
å®æ—¶æŸ¥çœ‹ä»¥ä¸‹æŒ‡æ ‡:
- **è¢«æˆªæ–­çš„è¯„åˆ†æ¯”ä¾‹**: å¦‚æœ>20%,è€ƒè™‘é™ä½trim_percent
- **è´å¶æ–¯å¹³æ»‘å½±å“åº¦**: å¦‚æœå¤§éƒ¨åˆ†æ¸¸æˆè¢«æ˜¾è‘—è°ƒæ•´,è€ƒè™‘è°ƒæ•´kå€¼
- **æœªè¾¾é—¨æ§›æ¸¸æˆæ¯”ä¾‹**: å¦‚æœ>30%,è€ƒè™‘é™ä½min_ratings

#### èµ›åå¤ç›˜
åŸºäºå®é™…æ•°æ®é‡æ–°æ ¡å‡†æ‰€æœ‰å‚æ•°

---

## äº”ã€ç”¨æˆ·è§£é‡Šä¸é€æ˜åº¦è®¾è®¡

### 5.1 å¾—åˆ†è§£é‡Šå¡ç‰‡(U Iå±•ç¤º)

```
ä½œå“ã€Šæ¸¸æˆåç§°ã€‹åœ¨ã€åˆ›æ–°æ€§ã€‘ç»´åº¦:

åŸºç¡€è®¡ç®—:
â€¢ å…±æ”¶åˆ°47ä¸ªæœ‰æ•ˆè¯„åˆ†(å…¶ä¸­è¯„å®¡å›¢è¯„åˆ†3ä¸ª)
â€¢ å»æ‰æœ€é«˜4ä¸ªå’Œæœ€ä½4ä¸ªè¯„åˆ†(æˆªå°¾10%)
â€¢ å‰©ä½™39ä¸ªè¯„åˆ†çš„å¹³å‡åˆ†:8.42åˆ†

è´å¶æ–¯å¹³æ»‘:
â€¢ è¯¥ç»´åº¦å…¨å±€å¹³å‡åˆ†:7.15åˆ†
â€¢ ç”±äºæ‚¨çš„è¯„åˆ†æ•°é‡(47)è¾ƒå¤š,å¹³æ»‘è°ƒæ•´å½±å“å¾ˆå°
â€¢ æœ€ç»ˆå¾—åˆ†:8.39åˆ†

å½“å‰æ’å:ç¬¬3å(ä¸ç¬¬2åå¾—åˆ†å·®0.05åˆ†)
```

### 5.2 å¸¸è§é—®é¢˜å®˜æ–¹è§£ç­”

**Q1: ä¸ºä»€ä¹ˆæˆ‘çš„åˆ†æ•°å’Œç›´æ¥å¹³å‡åˆ†ä¸ä¸€æ ·?**

> æˆ‘ä»¬ä½¿ç”¨äº†"æˆªå°¾å‡å€¼"ç®—æ³•,è‡ªåŠ¨å»é™¤äº†æœ€é«˜å’Œæœ€ä½å„10%çš„å¯èƒ½å¼‚å¸¸è¯„åˆ†,è¿™èƒ½é˜²æ­¢æ¶æ„åˆ·åˆ†å¯¹æ‚¨ä½œå“çš„å½±å“ã€‚å…·ä½“å»é™¤äº†å“ªäº›è¯„åˆ†ä¸å…¬å¼€,ä»¥é¿å…é’ˆå¯¹æ€§æ”»å‡»ã€‚

**Q2: è¯„åˆ†äººæ•°å°‘ä¼šåƒäºå—?**

> å¯¹äºè¯„åˆ†äººæ•°è¾ƒå°‘çš„ä½œå“,æˆ‘ä»¬ä¼šç”¨"è´å¶æ–¯å¹³æ»‘"ç®—æ³•,é€‚å½“å‚è€ƒå…¨å±€å¹³å‡æ°´å¹³è¿›è¡Œè°ƒæ•´ã€‚è¿™èƒ½é¿å…å¶ç„¶çš„é«˜åˆ†æˆ–ä½åˆ†å¯¹æ’åäº§ç”Ÿè¿‡å¤§å½±å“ã€‚éšç€è¯„åˆ†äººæ•°å¢åŠ ,è¿™ç§è°ƒæ•´ä¼šè¶Šæ¥è¶Šå°ã€‚

**Q3: è¯„å®¡å›¢çš„è¯„åˆ†æƒé‡æ›´é«˜å—?**

> åœ¨è®¡ç®—"è¯„åˆ†äººæ¬¡"æ—¶,æ¯ä¸ªè¯„å®¡å›¢è¯„åˆ†æŒ‰2äººæ¬¡è®¡ç®—,è¿™èƒ½å¸®åŠ©ä½œå“æ›´å¿«è¾¾åˆ°æ’åé—¨æ§›ã€‚ä½†åœ¨è®¡ç®—å¹³å‡åˆ†æ—¶,è¯„å®¡å›¢è¯„åˆ†å’Œå‚èµ›è€…è¯„åˆ†æƒé‡ç›¸åŒã€‚

**Q4: å¦‚æœä¸¤äººåˆ†æ•°ç›¸åŒ,è°æ’å‰é¢?**

> æˆ‘ä»¬ä¼šä¾æ¬¡æ¯”è¾ƒ: 1) è¯„åˆ†äººæ¬¡å¤šçš„ä¼˜å…ˆ; 2) è¯„åˆ†æ›´ç¨³å®šçš„ä¼˜å…ˆ(æ–¹å·®å°); 3) è¯„å®¡å›¢è¯„åˆ†å æ¯”é«˜çš„ä¼˜å…ˆã€‚å¦‚æœè¿™äº›éƒ½ç›¸åŒ,åˆ™å…è®¸å¹¶åˆ—æ’åã€‚

**Q5: ä¸ºä»€ä¹ˆæˆ‘çš„æ¸¸æˆæ²¡æœ‰è¿›å…¥æ’å?**

> éœ€è¦è·å¾—>20äººæ¬¡çš„è¯„åˆ†æ‰èƒ½è¿›å…¥æœ€ç»ˆæ’åã€‚å¦‚æœæœªè¾¾åˆ°é—¨æ§›,ä»ä¼šæ˜¾ç¤ºå¹³å‡åˆ†ä¾›å‚è€ƒ,ä½†ä¸è®¡å…¥æ­£å¼æ’åã€‚ç¬¬ä¸€å±Šæˆ‘ä»¬é€‰æ‹©ç®€å•é€æ˜çš„è§„åˆ™,å¯èƒ½ä¸æ˜¯æœ€å®Œç¾çš„,ä½†ä¸€å®šæ˜¯æœ€è¯šå®çš„ã€‚

---

## å…­ã€å·¥ç¨‹å®æ–½è§„èŒƒ

### 6.1 å¼€å‘ä»»åŠ¡åˆ†è§£

| ä»»åŠ¡ | å·¥ä½œé‡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© | éªŒæ”¶æ ‡å‡† |
|------|--------|--------|--------|---------|
| 1. è¯„åˆ†é¢„å¤„ç†æ¨¡å— | 1.5å¤© | åç«¯ | è¯„åˆ†è¿‡æ»¤API | é€šè¿‡å•å…ƒæµ‹è¯•,è¦†ç›–è‡ªè¯„ã€é«˜å±æ ‡è®°ç­‰åœºæ™¯ |
| 2. æˆªå°¾å‡å€¼ç®—æ³• | 1å¤© | åç«¯ | è®¡ç®—å‡½æ•°+æµ‹è¯• | æ­£ç¡®å¤„ç†è¾¹ç•Œæƒ…å†µ(å°æ ·æœ¬ã€æç«¯åˆ†å¸ƒ) |
| 3. è´å¶æ–¯å¹³æ»‘ç®—æ³• | 1å¤© | åç«¯ | è®¡ç®—å‡½æ•°+æµ‹è¯• | å‚æ•°å¯é…ç½®,æ€§èƒ½è¾¾æ ‡ |
| 4. å¹¶åˆ—å¤„ç†é€»è¾‘ | 0.5å¤© | åç«¯ | tie-breakerå‡½æ•° | å¤„ç†æ‰€æœ‰å¹¶åˆ—åœºæ™¯ |
| 5. æ’åæ‰¹å¤„ç†ä»»åŠ¡ | 1.5å¤© | åç«¯ | æ’åè®¡ç®—Job | æ”¯æŒå®šæ—¶è§¦å‘,æ€§èƒ½æ»¡è¶³è¦æ±‚ |
| 6. æ•°æ®ç›‘æ§çœ‹æ¿ | 1.5å¤© | æ•°æ®å·¥ç¨‹å¸ˆ | Grafanaçœ‹æ¿ | åŒ…å«è¯„åˆ†åˆ†å¸ƒã€ç®—æ³•å½±å“åº¦ç­‰å…³é”®æŒ‡æ ‡ |
| 7. é™çº§å¼€å…³å®ç° | 0.5å¤© | SRE | é…ç½®å¼€å…³ | å¯ä¸€é”®åˆ‡æ¢ä¸ºç®€å•å¹³å‡ç®—æ³• |
| 8. ç”¨æˆ·è§£é‡Šæ–‡æ¡£ | 0.5å¤© | äº§å“ | FAQé¡µé¢ | ç”¨æˆ·æµ‹è¯•é€šè¿‡,æ— æ­§ä¹‰ |

**æ€»è®¡**: 8äººæ—¥

### 6.2 ç›‘æ§æŒ‡æ ‡å®šä¹‰

```python
ç›‘æ§æŒ‡æ ‡ = {
    'algorithm_health': {
        'winsorize_impact': 'æˆªå°¾ç®—æ³•å½±å“çš„è¯„åˆ†æ¯”ä¾‹',
        'bayesian_adjustment': 'è´å¶æ–¯å¹³æ»‘çš„å¹³å‡è°ƒæ•´å¹…åº¦',
        'tie_occurrence': 'å‘ç”Ÿå¹¶åˆ—çš„é¢‘ç‡',
    },
    'system_fairness': {
        'rating_distribution': 'è¯„åˆ†åˆ†å¸ƒ(æ˜¯å¦æ­£æ€)',
        'cold_start_issue': 'é«˜è´¨é‡ä½è¯„åˆ†ä½œå“æ•°é‡',
        'complaint_rate': 'æ’åç›¸å…³æŠ•è¯‰ç‡',
    },
    'performance': {
        'ranking_compute_time': 'æ’åè®¡ç®—è€—æ—¶',
        'api_response_time': 'æ’åæŸ¥è¯¢æ¥å£è€—æ—¶',
        'memory_usage': 'è®¡ç®—è¿‡ç¨‹å†…å­˜ä½¿ç”¨',
    }
}
```

### 6.3 é™çº§ä¸å®¹ç¾æ–¹æ¡ˆ

#### é™çº§ç­–ç•¥(æŒ‰ä¼˜å…ˆçº§)

**Level 1**: å…³é—­è´å¶æ–¯å¹³æ»‘,ä»…ä½¿ç”¨æˆªå°¾å‡å€¼
- è§¦å‘æ¡ä»¶: ç”¨æˆ·æŠ•è¯‰ç‡>3%

**Level 2**: å…³é—­æˆªå°¾å‡å€¼,ä½¿ç”¨ç®€å•ç®—æœ¯å¹³å‡
- è§¦å‘æ¡ä»¶: è¿ç»­3æ¬¡æ’åè®¡ç®—å¤±è´¥

**Level 3**: ä½¿ç”¨é¢„è®¡ç®—çš„é™æ€æ’å(æ‰‹åŠ¨ä¸Šä¼ )
- è§¦å‘æ¡ä»¶: ç³»ç»Ÿè´Ÿè½½è¶…è¿‡é˜ˆå€¼æŒç»­10åˆ†é’Ÿ

#### è§¦å‘æ¡ä»¶
- è¿ç»­3æ¬¡æ’åè®¡ç®—å¤±è´¥
- ç”¨æˆ·æŠ•è¯‰ç‡è¶…è¿‡5%
- ç³»ç»Ÿè´Ÿè½½è¶…è¿‡é˜ˆå€¼æŒç»­10åˆ†é’Ÿ

---

## ä¸ƒã€ç¬¬ä¸€å±Šåè¯„ä¼°ä¸è¿­ä»£è·¯çº¿

### 7.1 å¿…åšæ•°æ®åˆ†æ

æ¯”èµ›ç»“æŸå2å‘¨å†…,å®Œæˆä»¥ä¸‹åˆ†æ:

```python
åˆ†ææŠ¥å‘Š = {
    'ç¬¬ä¸€éƒ¨åˆ†:ç®—æ³•æ•ˆæœéªŒè¯': [
        'æˆªå°¾å‡å€¼å»é™¤äº†å¤šå°‘æç«¯è¯„åˆ†?è¿™äº›è¯„åˆ†æ˜¯çœŸçš„å¼‚å¸¸å—?',
        'è´å¶æ–¯å¹³æ»‘å¯¹å¤šå°‘ä½œå“äº§ç”Ÿäº†æ˜¾è‘—å½±å“(>0.5åˆ†)?',
        'å¹¶åˆ—å¤„ç†è§„åˆ™å®é™…è§¦å‘äº†å¤šå°‘æ¬¡?æ˜¯å¦åˆç†?',
    ],
    'ç¬¬äºŒéƒ¨åˆ†:å…¬å¹³æ€§è¯„ä¼°': [
        'æœ‰å¤šå°‘é«˜è´¨é‡ä½œå“å› è¯„åˆ†ä¸è¶³æœªè¿›å…¥æ’å?',
        'è¯„å®¡å›¢è¯„åˆ†ä¸å¤§ä¼—è¯„åˆ†çš„ä¸€è‡´æ€§å¦‚ä½•?',
        'æ˜¯å¦æœ‰ä½œå“å—åˆ°æ˜æ˜¾çš„æ¶æ„è¯„åˆ†æ”»å‡»?',
    ],
    'ç¬¬ä¸‰éƒ¨åˆ†:ç”¨æˆ·ä½“éªŒ': [
        'ç”¨æˆ·å¯¹æ’åè§„åˆ™çš„æŠ•è¯‰ä¸»è¦é›†ä¸­åœ¨å“ªäº›æ–¹é¢?',
        'ç”¨æˆ·æ˜¯å¦ç†è§£æˆ‘ä»¬çš„ç®—æ³•è§£é‡Š?',
        'æœ‰å¤šå°‘ç”¨æˆ·è®¤ä¸ºæ’åç»“æœå…¬å¹³?',
    ]
}
```

### 7.2 ç¬¬äºŒå±Šä¼˜åŒ–å»ºè®®(åŸºäºæ•°æ®é©±åŠ¨)

#### å¦‚æœå‘ç°ä»¥ä¸‹é—®é¢˜:

1. **æç«¯è¯„åˆ†è¿‡å¤š** â†’ è€ƒè™‘å¼•å…¥Huber Meanæˆ–è°ƒæ•´æˆªæ–­æ¯”ä¾‹
2. **å†·å¯åŠ¨é—®é¢˜ä¸¥é‡** â†’ è€ƒè™‘å¼•å…¥ä½œå“å…ƒæ•°æ®(å¦‚ä½œè€…å†å²è¡¨ç°)ä½œä¸ºå…ˆéªŒ
3. **æ˜æ˜¾äº’è¯„å›¢è¯æ®** â†’ è€ƒè™‘å¼•å…¥ç®€åŒ–ç‰ˆå›¾æ£€æµ‹ç®—æ³•
4. **è¯„åˆ†è´¨é‡å·®å¼‚å¤§** â†’ è€ƒè™‘å¼•å…¥2ç»´åº¦çš„RTS(å¤šæ ·æ€§ä¸ä¸€è‡´æ€§)

#### å¦åˆ™:
å¦‚æœç¬¬ä¸€å±Šè¿è¡Œè‰¯å¥½,**ä¸è¦ä¸ºäº†åˆ›æ–°è€Œåˆ›æ–°**,ä¿æŒæ ¸å¿ƒç®—æ³•ç¨³å®š,åªåšå‚æ•°å¾®è°ƒã€‚

---

## å…«ã€ä»£ç å®ç°å‚è€ƒ

å®Œæ•´ä»£ç å®ç°è¯·å‚è€ƒ:
- [development/code/ranking_algorithm_corrected.py](../code/ranking_algorithm_corrected.py)

åŒ…å«:
- å®Œæ•´çš„Pythonå®ç°
- è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜
- ç±»å‹å®šä¹‰
- å·¥å…·å‡½æ•°
- ä½¿ç”¨ç¤ºä¾‹

---

## ä¹ã€ä¸ç°æœ‰è®¾è®¡æ–‡æ¡£çš„å¯¹åº”å…³ç³»

### 9.1 éœ€è¦æ›´æ–°çš„ç« èŠ‚

åœ¨ [è¯„åˆ†ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ_v1.0.md](../design/è¯„åˆ†ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ_v1.0.md) ä¸­æ–°å¢:

**5.2 æ’åè®¡ç®—æ–¹æ³•**(æ–°å¢)
```markdown
è¯¦è§ã€Šæ’åç³»ç»ŸæŠ€æœ¯å®ç°æ–‡æ¡£ v1.0ã€‹ç¬¬äºŒç« 
```

**5.3 å¹¶åˆ—å¤„ç†è§„åˆ™**(æ–°å¢)
```markdown
è¯¦è§ã€Šæ’åç³»ç»ŸæŠ€æœ¯å®ç°æ–‡æ¡£ v1.0ã€‹ç¬¬2.6èŠ‚
```

### 9.2 ä¿æŒä¸å˜çš„éƒ¨åˆ†

- é©å‘½æ€§æ’åç³»ç»Ÿ: 12ä¸ªç‹¬ç«‹æ¦œå•
- ä¼˜é€‰æ¸¸æˆæœºåˆ¶: 3ä¸ªç»´åº¦å‰10
- æ’åèµ„æ ¼: >20äººæ¬¡
- è¯„å®¡å›¢æƒé‡Ã—2: ä»…å½±å“è¯„åˆ†äººæ¬¡ç»Ÿè®¡
- åä½œå¼Šæœºåˆ¶: é«˜å±ç›‘æµ‹+é«˜é¢‘å·®è¯„æ£€æµ‹

---

## åã€é™„å½•

### 10.1 æœ¯è¯­å¯¹ç…§è¡¨

| æŠ€æœ¯æœ¯è¯­ | ç”¨æˆ·å¯ç†è§£ç‰ˆæœ¬ |
|---------|--------------|
| Winsorized Mean | æˆªå°¾å‡å€¼(å»æ‰æœ€é«˜å’Œæœ€ä½å„10%) |
| Bayesian Smoothing | è´å¶æ–¯å¹³æ»‘(å°æ ·æœ¬å‘å…¨å±€å¹³å‡å›å½’) |
| Effective Rating Count | è¯„åˆ†äººæ¬¡(è¯„å®¡å›¢Ã—2) |
| Trim Percent | æˆªæ–­æ¯”ä¾‹(10%) |
| Tie-breaker | åŒåˆ†è£å†³è§„åˆ™ |

### 10.2 å…³é”®æ•°å­—é€ŸæŸ¥

| å‚æ•° | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| **min_ratings** | 15äººæ¬¡ | æ’åèµ„æ ¼é—¨æ§›(ç¬¬ä¸€å±Š) |
| **trim_percent** | 10% | æˆªå°¾æ¯”ä¾‹ |
| **min_samples_for_trim** | 10ä¸ª | å°‘äºæ­¤æ•°é‡ä¸æˆªæ–­ |
| **bayesian_k** | 20 | å¹³æ»‘å¼ºåº¦å‚æ•° |
| **tie_epsilon** | 0.001åˆ† | å¹¶åˆ—åˆ¤å®šé˜ˆå€¼(ç»Ÿä¸€3ä½å°æ•°ç²¾åº¦) |
| **default_global_mean** | 7.0åˆ† | é»˜è®¤å…¨å±€å‡å€¼ |

### 10.3 å®æ–½æ‰¿è¯º

**å‘ç”¨æˆ·æ‰¿è¯º**:

> "ç¬¬ä¸€å±Š,æˆ‘ä»¬é€‰æ‹©ç®€å•é€æ˜çš„ç®—æ³•,å¯èƒ½ä¸æ˜¯æœ€å®Œç¾çš„,ä½†ä¸€å®šæ˜¯æœ€è¯šå®çš„ã€‚æˆ‘ä»¬ä¼šå®Œæ•´è®°å½•æ‰€æœ‰æ•°æ®,å¹¶åœ¨èµ›åå…¬å¼€åˆ†ææŠ¥å‘Šã€‚æ‚¨çš„æ¯ä¸€æ¬¡è¯„åˆ†,éƒ½åœ¨å¸®åŠ©æˆ‘ä»¬è®©ä¸‹ä¸€å±Šæ›´å…¬å¹³ã€‚"

---

**æ–‡æ¡£ç»“æŸ**

**ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-01-06
**ç»´æŠ¤äºº**: è€é»‘(Claude)
