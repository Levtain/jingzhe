# 惊蛰计划 - 成就系统设计文档

**文档版本**: v1.0
**创建日期**: 2025-01-08
**最后更新**: 2025-01-08
**设计状态**: 🔄 初稿完成，待补充详细设计

---

## 文档说明

本文档定义惊蛰计划的成就系统，包括成就类型、解锁条件、奖励机制、展示方式等核心功能。

**系统边界**:
- ✅ 成就定义和解锁
- ✅ 徽章和称号管理
- ✅ 成就奖励发放
- ✅ 成就展示和榜单

**不包含**:
- ❌ 金币发放 → 见《经济系统设计文档》
- ❌ 评分规则 → 见《评分系统设计方案》
- ❌ 排名算法 → 见《排名系统设计文档》

---

## 一、核心设计原则

### 1.1 设计目标
> **激励参与、增加乐趣、展示荣誉**

### 1.2 核心理念
- **渐进式解锁**: 从简单到困难，逐步引导用户
- **多样化成就**: 覆盖评分、开发、社区、特殊等多个维度
- **适度激励**: 成就奖励不过度，保持比赛的好玩性
- **展示荣誉**: 徽章和称号满足用户的成就感

---

## 二、成就体系

### 2.1 成就分类

#### 2.1.1 评分相关成就

**评分次数成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 初次评分 | 完成1次评分 | 简单 | 5金币 |
| 评分达人 | 完成10次评分 | 简单 | 10金币 + 徽章 |
| 评分专家 | 完成50次评分 | 中等 | 50金币 + 徽章 |
| 评分大师 | 完成100次评分 | 困难 | 100金币 + 称号 |
| 传奇评委 | 完成500次评分 | 传奇 | 500金币 + 稀有称号 |

**获得好评成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 初获好评 | 单个游戏收到10次打赏 | 简单 | 5金币 |
| 广受好评 | 单个游戏收到50次打赏 | 中等 | 20金币 + 徽章 |
| 人气爆棚 | 单个游戏收到100次打赏 | 困难 | 50金币 + 徽章 |
| 万人敬仰 | 单个游戏收到500次打赏 | 传奇 | 200金币 + 稀有称号 |

**评分质量成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 公正评分 | 评分分布合理（无极端值） | 简单 | 5金币 |
| 优质评审 | 评分被采纳率高 | 中等 | 20金币 |
| 明星评审 | 进入评分贡献榜前10 | 困难 | 100金币 + 徽章 |

---

#### 2.1.2 游戏开发成就

**提交作品成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 首次参赛 | 提交第1个游戏 | 简单 | 10金币 + 徽章 |
| 连续参赛 | 连续3届提交游戏 | 中等 | 50金币 + 徽章 |
| 坚持不懈 | 连续10届提交游戏 | 困难 | 200金币 + 称号 |
| 元老级用户 | 参与10届以上比赛 | 传奇 | 500金币 + 稀有称号 |

**优选游戏成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 单维度优选 | 单个维度进入前10 | 简单 | 10金币 |
| 双维度优选 | 2个维度进入前10 | 中等 | 30金币 + 徽章 |
| 三维度优选 | 3个维度进入前10（优选游戏） | 困难 | 100金币 + 徽章 |
| 全维度优选 | 6个维度全部进入前10 | 传奇 | 500金币 + 稀有称号 |
| 优选之王 | 3个游戏成为优选游戏 | 传奇 | 1000金币 + 传说称号 |

**人气游戏成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 小有人气 | 单个游戏收到50次打赏 | 简单 | 10金币 |
| 人气之星 | 单个游戏收到200次打赏 | 中等 | 50金币 + 徽章 |
| 人气之王 | 单个游戏收到1000次打赏 | 困难 | 200金币 + 徽章 |
| 万人追捧 | 单个游戏收到5000次打赏 | 传奇 | 1000金币 + 稀有称号 |

---

#### 2.1.3 社区互动成就

**评论成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 首次评论 | 发表第1条评论 | 简单 | 2金币 |
| 活跃评论家 | 发表10条评论 | 简单 | 10金币 |
| 评论达人 | 发表50条评论 | 中等 | 30金币 + 徽章 |
| 热心评论 | 评论被点赞50次 | 中等 | 20金币 |
| 精彩评论 | 评论被点赞200次 | 困难 | 100金币 + 徽章 |

**打赏成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 首次打赏 | 完成1次打赏 | 简单 | 徽章 |
| 慷慨解囊 | 打赏10次 | 简单 | 5金币 |
| 挥金如土 | 打赏总额100金币 | 中等 | 20金币 + 徽章 |
| 豪掷千金 | 打赏总额500金币 | 困难 | 100金币 + 徽章 |
| 散财天王 | 打赏总额2000金币 | 传奇 | 500金币 + 稀有称号 |

**社交成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 初入江湖 | 添加5个好友 | 简单 | 5金币 |
| 广交朋友 | 添加20个好友 | 简单 | 10金币 |
| 组队新手 | 创建/加入第1个团队 | 简单 | 5金币 |
| 组队达人 | 创建/加入5个团队 | 中等 | 20金币 |
| 团队领袖 | 创建团队并获得优选 | 困难 | 100金币 + 徽章 |

---

#### 2.1.4 特殊成就

**早期成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 创始人 | 第一届参赛 | 简单 | 徽章 |
| 元老 | 连续参与前3届 | 中等 | 50金币 + 徽章 |
| 活化石 | 连续参与前10届 | 传奇 | 500金币 + 稀有称号 |

**贡献成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| bug猎人 | 发现并报告3个bug | 简单 | 10金币 |
| 建言献策 | 提出建议被采纳 | 中等 | 20金币 + 徽章 |
| 卓越贡献 | 提出建议被采纳5次 | 困难 | 100金币 + 徽章 |
| 社区之星 | 为社区做出重大贡献 | 传奇 | 500金币 + 稀有称号 |

**传奇成就**

| 成就名称 | 解锁条件 | 难度 | 奖励 |
|---------|---------|------|------|
| 完美评委 | 所有评分均被采纳 | 传奇 | 1000金币 + 传说称号 |
| 无敌开发者 | 3个游戏全部优选 | 传奇 | 1000金币 + 传说称号 |
| 全能王 | 同时获得评分、开发、社区成就 | 传奇 | 2000金币 + 神话称号 |
| 传奇人物 | 获得所有成就 | 传说 | 10000金币 + 至尊称号 |

---

### 2.2 成就难度分级

#### 2.2.1 简单成就

**定义**: 大部分用户可以获得的成就

**特点**:
- 解锁条件简单
- 奖励较少（2-10金币或仅徽章）
- 目的: 引导用户参与

**示例**:
- 初次评分
- 首次参赛
- 发表第1条评论
- 添加5个好友

#### 2.2.2 中等成就

**定义**: 需要一定努力才能获得的成就

**特点**:
- 解锁条件中等
- 奖励适中（20-50金币 + 徽章）
- 目的: 激励用户持续参与

**示例**:
- 评分达人（10次）
- 连续参赛（3届）
- 评论达人（50条）
- 组队达人（5个团队）

#### 2.2.3 困难成就

**定义**: 少数用户可以获得的成就

**特点**:
- 解锁条件困难
- 奖励丰富（100-200金币 + 徽章）
- 目的: 激励用户追求卓越

**示例**:
- 评分专家（50次）
- 三维度优选
- 人气之王（1000次打赏）
- 团队领袖

#### 2.2.4 传奇成就

**定义**: 极少数用户可以获得的成就

**特点**:
- 解锁条件极高
- 奖励丰厚（500-1000金币 + 稀有称号）
- 目的: 创造传奇和话题

**示例**:
- 传奇评委（500次）
- 全维度优选
- 万人敬仰（5000次打赏）
- 传奇人物（所有成就）

---

## 三、成就奖励

### 3.1 奖励类型

#### 3.1.1 金币奖励

**奖励范围**: 2-10000金币

**分级**:
- 简单: 2-10金币
- 中等: 20-50金币
- 困难: 100-200金币
- 传奇: 500-1000金币
- 传说: 2000-10000金币

**目的**:
- 经济激励
- 与经济系统联动

#### 3.1.2 徽章奖励

**徽章展示位置**:
- 个人资料页
- 游戏详情页
- 评论区
- 成就页面

**徽章稀有度**:
- 普通: 简单成就
- 稀有: 中等成就
- 史诗: 困难成就
- 传说: 传奇成就

**目的**:
- 荣誉展示
- 社交货币

#### 3.1.3 称号奖励

**称号类型**:
- 评分大师
- 优选之王
- 元老级用户
- 社区之星
- 至尊称号
- 神话称号

**称号展示位置**:
- 用户名旁边
- 个人资料页
- 评论区

**称号有效期**:
- 永久有效
- 可在多个称号中切换显示

#### 3.1.4 特殊权限（待设计）

**可能的特权**:
- 特殊徽章
- 优先推荐位
- 特殊活动参与权
- 实体奖励（第一届?）

**待确认**:
- [ ] 是否需要特殊权限奖励？
- [ ] 权限类型和内容？
- [ ] 权限有效期？

---

### 3.2 奖励发放

#### 3.2.1 发放时机

**即时发放**:
- 成就解锁后立即发放金币
- 徽章和称号立即解锁

**延迟发放**:
- 实体奖励需要在比赛结束后发放
- 特殊权限需要人工审核

#### 3.2.2 发放方式

**自动发放**:
- 金币奖励自动到账
- 徽章和称号自动解锁
- 无需人工干预

**人工发放**:
- 实体奖励需要人工确认地址
- 特殊权限需要人工审核

---

## 四、成就展示

### 4.1 个人资料页展示

#### 4.1.1 成就总览

**显示内容**:
- 已解锁成就数量 / 总成就数量
- 成就完成度百分比
- 最近解锁的成就（3个）
- 稀有成就展示

**示例**:
```
成就: 45/150 (30%)
最近解锁:
- [徽章] 评分达人
- [徽章] 首次参赛
- [徽章] 初入江湖
```

#### 4.1.2 成就列表

**展示方式**:
- 按分类展示（评分、开发、社区、特殊）
- 已解锁/未解锁状态
- 成就进度（如: 评分 8/10 次）

**示例**:
```
评分成就 (已解锁 10/30)
✅ 初次评分
✅ 评分达人
⏳ 评分专家 (45/50)
❌ 评分大师 (0/100)
```

---

### 4.2 游戏详情页展示

#### 4.2.1 开发者成就

**显示内容**:
- 开发者的稀有成就
- 相关的优选游戏成就

**目的**:
- 展示开发者实力
- 增加游戏可信度

#### 4.2.2 游戏成就

**显示内容**:
- 游戏获得的成就
- 人气、优选等徽章

**目的**:
- 展示游戏质量
- 吸引更多评分

---

### 4.3 成就榜单

#### 4.3.1 成就数量榜

**排序规则**:
- 按已解锁成就数量排序
- 同数量按解锁时间排序

**展示方式**:
- Top 100
- 实时更新

#### 4.3.2 成就难度榜

**排序规则**:
- 优先展示传奇成就
- 按成就难度分组展示

**展示方式**:
- 传奇成就榜
- 困难成就榜
- 稀有成就展示

---

## 五、成就解锁机制

### 5.1 解锁触发

#### 5.1.1 事件驱动

**触发事件**:
- 评分提交成功
- 游戏提交成功
- 评论发表成功
- 打赏完成
- 组队成功

**触发流程**:
```
1. 用户完成某个动作
   ↓
2. 相关系统通知成就系统
   ↓
3. 成就系统检查解锁条件
   ↓
4. 符合条件则解锁成就
   ↓
5. 发放奖励
   ↓
6. 通知用户
```

#### 5.1.2 定时检查

**适用场景**:
- 需要统计的数据（总打赏次数、总评分次数等）
- 定时任务扫描

**检查频率**:
- 每小时
- 每天
- 每周

---

### 5.2 解锁通知

#### 5.2.1 通知方式

**站内通知**:
- 弹窗通知
- 成就解锁动画
- 音效提示

**通知内容**:
- 成就名称
- 成就描述
- 获得的奖励
- 查看详情按钮

#### 5.2.2 通知时机

**即时通知**:
- 成就解锁后立即通知
- 仅在用户在线时通知

**延迟通知**:
- 用户离线时的成就解锁
- 登录后批量通知

---

## 六、数据模型

### 6.1 成就定义表 (achievements)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| achievement_id | INT | 成就ID |
| name | VARCHAR | 成就名称 |
| description | VARCHAR | 成就描述 |
| category | VARCHAR | 成就分类（评分、开发、社区、特殊） |
| difficulty | VARCHAR | 难度（简单、中等、困难、传奇） |
| unlock_condition | TEXT | 解锁条件（JSON格式） |
| reward_type | VARCHAR | 奖励类型（金币、徽章、称号、权限） |
| reward_amount | INT | 奖励数额（金币数量） |
| badge_id | INT | 徽章ID |
| title_id | INT | 称号ID |
| is_active | BOOLEAN | 是否启用 |
| created_at | DATETIME | 创建时间 |

### 6.2 用户成就表 (user_achievements)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| user_achievement_id | INT | 用户成就ID |
| user_id | INT | 用户ID |
| achievement_id | INT | 成就ID |
| unlocked_at | DATETIME | 解锁时间 |
| progress | INT | 进度（如: 45/50） |
| is_notified | BOOLEAN | 是否已通知 |
| created_at | DATETIME | 创建时间 |

### 6.3 徽章表 (badges)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| badge_id | INT | 徽章ID |
| name | VARCHAR | 徽章名称 |
| description | VARCHAR | 徽章描述 |
| icon_url | VARCHAR | 徽章图标URL |
| rarity | VARCHAR | 稀有度（普通、稀有、史诗、传说） |
| created_at | DATETIME | 创建时间 |

### 6.4 称号表 (titles)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| title_id | INT | 称号ID |
| name | VARCHAR | 称号名称 |
| description | VARCHAR | 称号描述 |
| display_text | VARCHAR | 显示文本 |
| is_permanent | BOOLEAN | 是否永久有效 |
| created_at | DATETIME | 创建时间 |

---

## 七、接口设计

### 7.1 成就相关接口

#### 7.1.1 查询成就列表

```
GET /api/achievements?category=scoring&difficulty=simple
Response:
{
  "total": 30,
  "achievements": [
    {
      "achievement_id": 1,
      "name": "初次评分",
      "description": "完成1次评分",
      "category": "评分",
      "difficulty": "简单",
      "reward": {
        "type": "gold",
        "amount": 5
      },
      "is_unlocked": true,
      "unlocked_at": "2025-01-08 12:00:00"
    }
  ]
}
```

#### 7.1.2 查询用户成就

```
GET /api/achievements/my
Response:
{
  "total_unlocked": 45,
  "total_achievements": 150,
  "completion_rate": 0.3,
  "achievements": [
    {
      "achievement_id": 1,
      "name": "初次评分",
      "unlocked_at": "2025-01-08 12:00:00"
    }
  ]
}
```

#### 7.1.3 查询成就进度

```
GET /api/achievements/:id/progress
Response:
{
  "achievement_id": 2,
  "name": "评分达人",
  "description": "完成10次评分",
  "progress": {
    "current": 8,
    "target": 10,
    "percentage": 0.8
  },
  "is_unlocked": false
}
```

---

### 7.2 徽章和称号接口

#### 7.2.1 查询用户徽章

```
GET /api/badges/my
Response:
{
  "total": 10,
  "badges": [
    {
      "badge_id": 1,
      "name": "评分达人",
      "icon_url": "/badges/scoring_expert.png",
      "rarity": "普通",
      "unlocked_at": "2025-01-08 12:00:00"
    }
  ]
}
```

#### 7.2.2 查询用户称号

```
GET /api/titles/my
Response:
{
  "total": 5,
  "current_title": "评分大师",
  "titles": [
    {
      "title_id": 1,
      "name": "评分大师",
      "display_text": "[评分大师] 用户名",
      "is_active": true
    }
  ]
}
```

#### 7.2.3 切换称号

```
POST /api/titles/switch
Request:
{
  "title_id": 2
}

Response:
{
  "success": true,
  "new_title": "优选之王"
}
```

---

## 八、与相关系统的接口

### 8.1 与评分系统的接口

**评分系统 → 成就系统**:
- 评分提交成功后，通知成就系统检查解锁
- 通知评分次数、评分质量等数据

**成就系统 → 评分系统**:
- 无直接依赖

### 8.2 与经济系统的接口

**成就系统 → 经济系统**:
- 成就解锁时，请求发放金币奖励

**经济系统 → 成就系统**:
- 打赏记录触发成就解锁（打赏10次、打赏总额等）

### 8.3 与排名系统的接口

**排名系统 → 成就系统**:
- 排名公布后，通知成就系统检查优选游戏成就
- 通知排名相关数据

**成就系统 → 排名系统**:
- 无直接依赖

---

## 九、技术实现要点

### 9.1 成就检查

#### 9.1.1 实时检查

**适用场景**:
- 单次事件（首次评分、首次参赛等）
- 进度更新（8/10 → 9/10）

**检查流程**:
```
1. 监听事件
   ↓
2. 查询相关成就列表
   ↓
3. 遍历每个成就，检查解锁条件
   ↓
4. 符合条件则解锁
   ↓
5. 发放奖励
   ↓
6. 发送通知
```

#### 9.1.2 批量检查

**适用场景**:
- 定时任务
- 统计类成就（总打赏次数、总评分次数等）

**检查流程**:
```
1. 定时任务触发
   ↓
2. 扫描所有用户
   ↓
3. 统计相关数据
   ↓
4. 检查成就解锁条件
   ↓
5. 批量解锁
   ↓
6. 批量发放奖励
   ↓
7. 批量发送通知
```

---

### 9.2 性能优化

#### 9.2.1 缓存策略

**缓存内容**:
- 成就定义列表
- 用户成就列表
- 成就进度数据

**缓存失效**:
- 成就定义更新时
- 用户解锁新成就时

#### 9.2.2 异步处理

**异步任务**:
- 成就解锁通知
- 奖励发放
- 统计数据更新

**消息队列**:
- 使用消息队列解耦
- 提高系统响应速度

---

## 十、待确认问题清单

### 10.1 成就数量

- [ ] 总共设计多少个成就？
- [ ] 每个分类多少个成就？
- [ ] 第一届实现多少个成就？

### 10.2 成就奖励

- [ ] 金币奖励数额是否合理？
- [ ] 是否需要实体奖励？
- [ ] 是否需要特殊权限奖励？

### 10.3 成就展示

- [ ] 成就榜单是否需要？
- [ ] 成就展示方式是否合适？
- [ ] 是否需要成就比较功能？

### 10.4 成就难度

- [ ] 成就难度分级是否合理？
- [ ] 解锁条件是否合适？
- [ ] 是否需要动态调整？

---

## 版本历史

- **v1.0** (2025-01-08): 初稿完成
  - 定义成就分类（评分、开发、社区、特殊）
  - 定义成就难度分级（简单、中等、困难、传奇）
  - 定义成就奖励（金币、徽章、称号、特殊权限）
  - 定义成就展示方式（个人资料、游戏详情、榜单）
  - 定义成就解锁机制
  - 定义数据模型和接口设计
  - 列出待确认问题清单

---

## 相关文档

- [系统架构总览_v1.0.md](./惊蛰计划-系统架构总览_v1.0.md#八-成就系统) - 系统边界和职责
- [评分系统设计方案_v1.0.md](./评分系统设计方案_v1.0.md) - 评分规则（移除了成就）
- [经济系统设计文档_v1.0.md](./惊蛰计划-经济系统设计文档_v1.0.md) - 金币奖励
- [关键名词解释索引_v1.1.md](./关键名词解释索引_v1.1.md) - 核心概念定义

---

**创建者**: Claude (老黑)
**审核者**: 蜡烛先生
**下一步**: 补充待确认问题的具体设计
