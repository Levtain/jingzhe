# 惊蛰计划 - 评分系统设计方案

**文档版本**: v2.5 (精简版 - 移除经济和成就系统)
**创建日期**: 2025-01-04
**最后更新**: 2025-01-10
**设计状态**: ✅ 已完成核心设计 + ✅ 已完成排名计算方法 + ✅ 已补充所有设计不足 + ✅ 已补充数值精度规则 + ✅ 已修复门槛矛盾 + ✅ 已统一数值精度为3位小数 + ✅ 已修正全局均值计算范围 + ✅ 已补充工程实现与边界处理(第十四章)
**设计会议**: 评分系统设计讨论(2025-01-04) + 排名系统技术评审(2025-01-06) + 设计不足回顾(2025-01-06)

---

## 文档说明

本文档记录惊蛰计划评分系统的完整设计方案,包括评分机制、排名规则、用户权限、AI处理规则等核心内容。

**与原始设计文档的关系**:
- 原始文档: `惊蛰计划-内部系统设计文档_v0.3_extended.md`
- 本文档: 基于原始文档进行深度设计讨论后的**最终确认方案**
- 关系: 本文档**覆盖并取代**原始文档中第6、7章的内容

**系统架构重构说明 (v2.0)**:
- ✅ **经济系统已拆分**: 金币、打赏、奖励相关功能已迁移到《经济系统设计文档》
- ✅ **成就系统已拆分**: 成就、徽章、称号相关功能已迁移到《成就系统设计文档》
- ✅ **评分系统精简**: 本文档仅保留评分维度、评分规则、排名算法、反作弊机制
- 📖 **相关文档**:
  - 经济系统: [惊蛰计划-经济系统设计文档_v1.0.md](./惊蛰计划-经济系统设计文档_v1.0.md)
  - 成就系统: [惊蛰计划-成就系统设计文档_v1.0.md](./惊蛰计划-成就系统设计文档_v1.0.md)
  - 系统架构: [惊蛰计划-系统架构总览_v1.0.md](./惊蛰计划-系统架构总览_v1.0.md)

---

## 一、核心设计原则

### 1.1 价值观
> **公平、公开、好玩**

### 1.2 革命性设计突破

**传统评分模式**: 各维度打分 → 计算总分 → 按总分排名
**惊蛰计划模式**: 各维度独立排名 → 无总分概念 → 优选游戏机制

**核心创新**:
- ❌ 不计算总分
- ✅ 每个维度独立排名
- ✅ 多维度优选游戏机制

---

## 二、评分维度定义

### 2.1 六大评分维度(概要)

| 维度名称 | 英文标识 | 核心问题 | 说明 |
|---------|---------|---------|------|
| 创新性 | Innovation | 是否新颖? | 游戏玩法、机制的原创性和突破性 |
| 主题诠释 | Theme Interpretation | 是否切题? | 对比赛主题的理解和表达程度 |
| 视觉效果 | Visual Art | 美术好不好看? | 美术风格、画面表现力(含AI使用情况) |
| 音乐音频 | Music & Audio | 音频好不好听? | 音效、BGM、音频设计(含AI使用情况) |
| 整体性 | Completeness | 是否完整? | 游戏完成度、各元素协调性 |
| 整活儿 | Fun Factor | 是否好玩? ⭐ | 娱乐性、可玩性、惊喜感(综合性向) |

> 📖 **详细定义与评分参考**: 参见 [《评分维度详细指南v1.0》](./评分维度详细指南_v1.0.md)
>
> 该指南包含:
> - ✅ 每个维度的详细定义和核心关注点
> - ✅ 5级评分参考(10分/8-9分/6-7分/4-5分/0-3分)
> - ✅ 维度边界说明和关系解析
> - ✅ 评分最佳实践和常见问题

### 2.2 评分范围与显示

**分数档位**: 0-10分,支持0.5分档位
**最低分**: 0分(可以全部维度评0分)
**最高分**: 10分

**显示方式**:
- 星级: ★★★★★ (10分)、★★★★☆ (9分)、★★★☆☆ (8分)...
- 原始分: 8.5/10
- 组合显示: `★★★★☆ 8.5/10`

**星级映射规则**:
- 0-1.9分: ☆
- 2-3.9分: ★☆
- 4-5.9分: ★★☆
- 6-7.9分: ★★★☆
- 8-9.9分: ★★★★☆
- 10分: ★★★★★

### 2.3 评分指南展示方式

**悬浮窗提示机制**:
- 用户调整分数滑块时,鼠标悬浮显示该分数的评分标准
- 界面简洁,用户需要时才查看
- 动态反馈,评分时实时看到对应标准

**交互示例**:
```
[创新性] [滑动条: ━━━━━━●━━━ 8.5分]
         ↓ 鼠标悬浮
┌─────────────────────────────┐
│ 8-9分: 高度创新              │
│ 有显著的新颖性              │
└─────────────────────────────┘
```

**不需要额外培训**: 详细定义 + 悬浮窗提示已足够,保持比赛的好玩性,不过度严肃化。

### 2.4 维度可选填规则

**允许部分评分**: ✅ 用户可以选择只评某些维度
- **提交时提示**: 二次确认页面中提示用户有未评分的维度
- **建议但不强制**: 建议给予更全面评价,但不强制要求
- **未评分维度**: 在统计时不参与该维度排名
- **原因**: 配合允许修改评分的机制,提供灵活性;避免用户因不理解某个维度而被迫随意打分

### 2.5 维度权重说明

**不设置维度权重**:
- **原因**: 采用单维度独立排名系统,不计算总分
- **结论**: 每个维度独立排名,不存在"加权"概念
- **用户评分**: 每个维度独立打0-10分,无需考虑权重
- **排名统计**: 12个独立榜单(6维度×2评分群体),各自计算排名

---

## 三、评分资格与权限

### 3.1 评分权限矩阵

| 用户角色 | 评分权限 | 说明 |
|---------|---------|------|
| 路人(未登录) | ❌ 不可评分 | 仅可浏览、下载游戏 |
| 玩家(已登录未参赛) | ❌ 不可评分 | 可评论、点赞 |
| 参赛者 | ✅ 可评分 | 可评价其他参赛者的游戏 |
| 评审团 | ✅ 可评分 | 可评价所有参赛游戏 |
| 管理员 | ❌ 不可评分 | 管理权限,不参与评分 |

**核心规则**:
1. **参赛者定义**: 只要在规定时间内提交了参赛游戏,即可评价他人的游戏
2. **不可自评**: 参赛者及其团队成员都不能评价自己提交的游戏
3. **身份互斥**: 评审团成员不能同时以参赛者身份参赛

### 3.2 评分资格限制

**团队参赛**:
- 团队所有成员共享评分权限
- 团队成员不能评价团队自己提交的游戏

**个人参赛**:
- 独立完成开发与互动
- 不能评价自己的游戏

**评审团**:
- 通过邀请码注册
- 不能提交参赛游戏
- 可以评价所有参赛游戏

---

## 四、评分时机与修改规则

### 4.1 评分开放时间

**游戏提交后**: 立即开放评分,无需审核等待

**原因**:
- 目前阶段无需审核流程
- 简化流程,用户提交后即可获得反馈

### 4.2 评分修改规则

**允许修改**: ✅ 是,直到评分阶段结束前都可以修改

**修改限制**:
- **无次数限制**: 用户可以根据游戏更新或重新思考后调整评分
- **时间限制**: 评分阶段结束后锁定所有评分
- **交互流程**:
  1. 允许全部维度评0分
  2. 必须点击"提交评分"按钮才生效
  3. 提交前需二次确认(弹窗显示评分详情,确认是否提交)
  4. 修改评分需点击"修改评分"按钮
  5. 修改后也需二次确认才能生效

### 4.3 游戏版本更新

**开发期结束后**: 不允许进行任何版本修改

**评分影响**: 不存在"游戏更新后如何处理评分"的问题

---

## 五、反作弊与风控机制

### 5.1 战术性评分防护

**时间缓冲**: 互评期结束后延后2天再公布结果,给申诉和复核留出时间

**监控机制**: 后台实时监控评分频率和评分分布

**高危监测触发条件**:
- 10分钟内评分超过6个游戏

**警告触发条件**:
- 高危监测用户 + 6个维度每个维度评分均<2分

**分级处理**:
- **高频评分(无恶意倾向)**: 站内信警告
- **高频差评(恶意战术性评分)**: 直接冻结账号,按作弊处理

### 5.2 作弊惩罚机制

**渐进式惩罚策略**:

**首次作弊**:
- 取消本次评选资格
- "作弊者"标签永久公示
- 支持申诉机制(每人仅限1次申诉,7个工作日内复核)

**二次作弊**:
- 注销账号
- 删除所有游戏
- 禁止邮箱/手机号/设备指纹再次注册

**作弊者的评分处理**:
- 该团队作品的评分将被取消资格
- 他们对其他人的评分保留(难以追溯,不予处理)
- 标注为"已失效账号"

### 5.3 评审团违规处理

**更严格标准**:

**违规行为**:
- 后台监测发现异常评分
- 用户举报并经审核确认

**处罚措施**:
- 直接取消评审团资格
- 永久禁止再次成为评审团成员
- 禁止参赛
- 全频道通报违规行为

**评审团违规示例**:
- 高频评分(10分钟内>6个游戏)
- 高频差评(6个维度均<2分)
- 利益冲突评分
- 收受贿赂

---

## 六、AI使用处理规则

### 6.1 AI使用申报机制

**强制申报**: 提交游戏时必须勾选AI使用情况

**申报选项**:

| 资源类型 | 选项 | 说明 |
|---------|------|------|
| 美术 | 全原创 | 完全手绘/原创美术 |
| 美术 | 部分使用AI | AI生成 + 手绘修饰 |
| 美术 | 全部使用AI | 纯AI生成美术 |
| 音频 | 全原创 | 完全原创音乐/音效 |
| 音频 | 部分使用AI | AI生成 + 原创修饰 |
| 音频 | 全部使用AI | 纯AI生成音频 |

**必须说明**: 如果选择"使用AI",必须说明使用了哪些AI工具(如Midjourney、Suno等)

### 6.2 AI使用争议处理

**情况A**: 作者申报使用AI,但用户认为没有使用
- **处理**: 不做讨论,不符合逻辑(作者已诚实申报)

**情况B**: 作者承诺未使用AI,但被用户举报
- **举报次数<5次**: 站内信通知作者自证清白
- **举报次数≥5次**: 全频道广播该事件,由评审团和管理员进行鉴别仲裁

**仲裁结果**:
- 确认使用AI: 取消参赛资格 + "作弊者"标签
- 确认原创: 恢复名誉,举报记录清除

### 6.3 AI使用对评分的影响

**核心原则**: 使用AI的维度不参与该维度的评分和排名

**具体规则**:

| AI使用情况 | 受影响维度 | 参与排名的维度 |
|-----------|----------|--------------|
| 美术使用AI | 视觉效果不参与排名 | 其他5个维度正常参与 |
| 音频使用AI | 音乐音频不参与排名 | 其他5个维度正常参与 |
| 美术+音频均用AI | 视觉效果、音乐音频不参与 | 其他4个维度正常参与 |
| 完全AI生成 | 视觉效果、音乐音频不参与 | 创新性、主题诠释、整体性、整活儿正常参与 |

**重要说明**:
- 允许完全AI生成的游戏参赛
- 使用AI的维度直接不参与该维度排名
- 其他维度正常竞争,不影响优选游戏判定
- 避免了传统总分计算的所有争议问题

---

## 七、革命性排名系统

### 7.1 核心设计原则

**❌ 不计算总分**

**✅ 每个维度独立排名**

**✅ 优选游戏机制**

### 7.2 榜单结构

**6个维度 × 2个评分群体 = 12个独立榜单**

**参赛者评分榜单**:
1. 创新性(参赛者榜)
2. 主题诠释(参赛者榜)
3. 视觉效果(参赛者榜)
4. 音乐音频(参赛者榜)
5. 整体性(参赛者榜)
6. 整活儿(参赛者榜)

**评审团评分榜单**:
1. 创新性(评审团榜)
2. 主题诠释(评审团榜)
3. 视觉效果(评审团榜)
4. 音乐音频(评审团榜)
5. 整体性(评审团榜)
6. 整活儿(评审团榜)

### 7.3 优选游戏机制

**判定标准**:

| 类型 | 标准 |
|------|------|
| 参赛者优选游戏 | 3个及以上维度进入参赛者榜前10 |
| 评审团优选游戏 | 3个及以上维度进入评审团榜前10 |

**计算基数**: 仅计算**参与排名的维度**

**规则明确**: ✅ 使用AI的维度不参与排名,也不计入"3个维度前10"的基数

**展示方式**:
1. 各游戏在所属维度榜单中正常显示
2. 优选游戏额外获得"优选游戏"标签
3. 设置独立的"优选游戏"榜单(参赛者版 / 评审团版)

**优选游戏缺失处理**: 宁缺毋滥,若某届无游戏达标则不设置

### 7.3.1 AI维度与优选游戏的判定 ✅ 已补充(第一届)

**核心原则**: 优选游戏判定**只看参与排名的维度**

**判定规则**:
```
在参与排名的维度中,有3+个维度进入前10 → 优选游戏
```

**示例说明**:

**示例A: 使用AI美术的游戏**
```
游戏《赛博迷宫》使用AI生成美术:

维度情况:
├─ 创新性: 排名第3 ✅ (参与排名)
├─ 主题诠释: 排名第5 ✅ (参与排名)
├─ 视觉效果: 不参与排名 (使用AI美术)
├─ 音乐音频: 排名第2 ✅ (参与排名)
├─ 整体性: 排名第8 ✅ (参与排名)
└─ 整活儿: 排名第12

参与排名的维度: 5个
进入前10的维度: 4个(创新性、主题诠释、音乐音频、整体性)

结果: ✅ 优选游戏 (4个维度前10)
```

**示例B: 使用AI美术+音频的游戏**
```
游戏《AI幻想》使用AI生成美术和音频:

维度情况:
├─ 创新性: 排名第3 ✅ (参与排名)
├─ 主题诠释: 排名第5 ✅ (参与排名)
├─ 视觉效果: 不参与排名 (使用AI美术)
├─ 音乐音频: 不参与排名 (使用AI音频)
├─ 整体性: 排名第6 ✅ (参与排名)
└─ 整活儿: 排名第9 ✅ (参与排名)

参与排名的维度: 4个
进入前10的维度: 4个(创新性、主题诠释、整体性、整活儿)

结果: ✅ 优选游戏 (4个维度前10)
```

**示例C: 仅2个维度前10**
```
游戏《微光》使用AI生成美术:

维度情况:
├─ 创新性: 排名第3 ✅ (参与排名)
├─ 主题诠释: 排名第15 ✅ (参与排名)
├─ 视觉效果: 不参与排名 (使用AI美术)
├─ 音乐音频: 排名第5 ✅ (参与排名)
├─ 整体性: 排名第12 ✅ (参与排名)
└─ 整活儿: 排名第18 ✅ (参与排名)

参与排名的维度: 5个
进入前10的维度: 2个(创新性、音乐音频)

结果: ❌ 不是优选游戏 (仅2个维度前10)
```

**设计理由**:
1. **公平性**: 已明确"使用AI的维度不参与",所以优选游戏判定也应该只看参与排名的维度
2. **鼓励全面发展**: 即使使用AI,只要在其他维度表现优秀,仍然可以成为优选游戏
3. **逻辑一致**: 与"使用AI的维度不参与排名"的规则保持一致

**用户可理解版本**:
> "如果您使用了AI生成美术或音频,这些维度不会参与排名。但只要您在其他参与排名的维度中有3个及以上进入前10,您的游戏仍然是'优选游戏'。"

### 7.4 排名示例

**场景**: 某届比赛有30个游戏参赛

**游戏A的表现**:
- 创新性: 排名第3
- 主题诠释: 排名第8
- 视觉效果: 排名第15(使用AI,不参与排名)
- 音乐音频: 排名第5
- 整体性: 排名第6
- 整活儿: 排名第12

**结果**:
- 游戏A在5个维度进入前10
- ✅ 获得"参赛者优选游戏"标签
- 在"创新性榜"显示为第3名
- 在"主题诠释榜"显示为第8名
- 在"视觉效果榜"不显示(使用AI)
- 在"优选游戏榜(参赛者版)"显示

### 7.5 设计优势

**1. 完美解决AI维度缺失问题**
- 传统模式:争论"未评分维度是记0分还是降低满分"
- 惊蛰模式:使用AI的维度直接不参与,其他维度正常竞争

**2. 突出游戏特色**
- 传统模式:平庸但全面的游戏可能总分高
- 惊蛰模式:特色突出的游戏更容易脱颖而出

**3. 更公平的竞争**
- 避免了"总分平均化"的问题
- 鼓励作者在某个维度做到极致,而不是面面俱到

**4. "优选游戏"概念清晰**
- 3个维度前10 = 真正的综合优秀
- 比"总分前10"更有说服力

**5. 双重视角**
- 参赛者优选游戏:反映玩家社区的认可
- 评审团优选游戏:反映专业评审的认可
- 可以比较明显看出两者之间的差异性

---

## 八、评审团权重

### 8.1 评审团评分权重

**当前设计**: ×2

**含义**: 评审团的每个评分在计算"评分人次"时按2人次计算

**示例**:
- 15个参赛者评分 + 3个评审团评分
- 总评分人次 = 15 + 2×3 = 21人次

**排名资格要求**: 总评分人次 > 20

### 8.2 为什么是×2?

**设计理由**:
- 评审团成员是经过挑选的,评价更具权威性
- 评审团的权重应该大于普通参赛者
- ×2是简单明确的权重关系

**未来考虑**: 可配置参数(如×1.5、×2、×3),但第一阶段固定×2

---

## 九、排名资格要求

### 9.1 动态门槛机制 ✅ 已补充(第一届)

**采用方案**: 动态门槛 + 绝对底线

**计算公式**:
```python
参赛者组门槛 = max(20, int(总参赛游戏数 × 30%))
```

**设计理由**:
- **绝对底线20**: 确保最基本的可信度
- **30%规则**: 确保游戏被一定比例的参赛者评价过
- **动态调整**: 适应不同规模的比赛

**示例计算**:

| 参赛游戏总数 | 参赛者组门槛计算 | 实际门槛 |
|------------|----------------|---------|
| 20个游戏 | max(20, 20×30%=6) | 20人次 ✅ |
| 50个游戏 | max(20, 50×30%=15) | 20人次 ✅ |
| 100个游戏 | max(20, 100×30%=30) | 30人次 |
| 200个游戏 | max(20, 200×30%=60) | 60人次 |
| 500个游戏 | max(20, 500×30%=150) | 150人次 |

**场景说明**:

**场景A: 极小规模(20-30个游戏)**
- 如果只有20个游戏参赛,理论上每个游戏最多只能获得19个参赛者评分
- 即使有3个评审团,最多19 + 2×3 = 25人次
- 使用动态门槛后,仍保持20人次的底线,大部分游戏可以达门槛

**场景B: 极大规模(500+个游戏)**
- 如果不动态调整,可能有大量"刚好21人次"的低质量游戏进入排名
- 使用30%规则后,需要150人次才能排名,避免低质量游戏

**第一届简化**: 如果参赛<50个游戏,保持20人次不变(不会触发30%规则)

### 9.2 评审团组门槛 ✅ 已补充(第一届)

**采用方案**: 动态门槛 + 绝对底线

**计算公式**:
```python
评审团组门槛 = max(5, int(评审团总人数 × 50%))
```

**设计理由**:
- **绝对底线5**: 确保至少获得一定数量的评审团评分
- **50%规则**: 确保获得大部分评审团的评价
- **动态调整**: 适应不同规模的评审团

**示例计算**:

| 评审团总人数 | 门槛计算 | 实际门槛 |
|------------|---------|---------|
| 3人 | max(5, 3×50%=1.5) | 5人次 |
| 5人 | max(5, 5×50%=2.5) | 5人次 |
| 10人 | max(5, 10×50%=5) | 5人次 |
| 20人 | max(5, 20×50%=10) | 10人次 |

**场景说明**:

**场景: 小评审团(3人)**
- 如果评审团只有3人,某游戏获得3个评审团评分
- 总人次 = 0 + 2×3 = 6人次
- 如果评审团门槛是固定的">5人次",则勉强达标
- 使用动态门槛后,要求5人次(2×3=6 > 5),评审团评分仍然有效

### 9.3 排名资格总结

**唯一门槛条件** (第一届):

```
总评分人次 > 15
```

**计算公式**:
```
总评分人次 = 参赛者评分人次 + 2 × 评审团评分人次
```

**示例**:

| 游戏ID | 参赛者评分 | 评审团评分 | 总人次 | 能否排名 |
|--------|----------|----------|--------|---------|
| 游戏A | 10人次 | 3人次(×2=6) | 16人次 | ✅ (>15) |
| 游戏B | 5人次 | 6人次(×2=12) | 17人次 | ✅ (>15) |
| 游戏C | 15人次 | 0人次(×2=0) | 15人次 | ❌ (=15) |
| 游戏D | 8人次 | 3人次(×2=6) | 14人次 | ❌ (<15) |

**说明**:
- 评审团权重×2仅体现在门槛计算中
- 不要求最低参赛者评分数量
- 第二届可能调整为>20人次

---

## 十、排名计算方法(第一届)

> **详细技术规范**: 请参阅《[排名系统技术实现文档 v1.0](./排名系统技术实现文档_v1.0.md)》

### 10.1 核心算法概述

某游戏在某维度的最终得分计算采用**"截尾均值 + 贝叶斯平滑"**的组合算法:

1. **截尾均值**: 去掉最高和最低各10%的极端评分
2. **贝叶斯平滑**: 小样本向全局均值回归

### 10.2 计算步骤

#### 步骤1: 过滤异常评分
- 排除自评(已有机制)
- 标记高危监测+高频差评的评分,人工复核

#### 步骤2: 检查排名资格

**唯一门槛条件**:

```
总评分人次 > 15 (第一届)
```

**计算公式**:
```
总评分人次 = 参赛者评分人次 + 2 × 评审团评分人次
```

**示例**:
- 10个参赛者 + 3个评审团 = 10 + 2×3 = 16 ✅ 达标
- 5个参赛者 + 6个评审团 = 5 + 2×6 = 17 ✅ 达标
- 15个参赛者 + 0个评审团 = 15 + 2×0 = 15 ❌ 不达标

**最终判定**:
- 总评分人次 > 15 → ✅ 进入排名
- 总评分人次 ≤ 15 → ❌ 不排名,显示"未达排名门槛(15人次)"

#### 步骤3: 计算截尾均值(抗极端值)
- 采用Winsorized Mean(截尾均值)
- 去掉上下各10%的极端评分
- 对剩余评分求算术平均
- 小样本(<10个评分)不截断,直接算术平均

**示例**:
```
原始评分: [9, 9, 8, 8, 8, 7, 7, 6, 1, 1] (10个)
去掉最低1个(1)和最高1个(9)
剩余: [1, 6, 7, 7, 8, 8, 8, 9]
截尾均值: 6.75分
```

#### 步骤4: 贝叶斯平滑(解决冷启动)
- 固定参数k=20
- 公式: S' = (n × S + 20 × μ) / (n + 20)
- 效果: 小样本向全局均值回归,大样本几乎不受影响

**示例**:
```
全局平均 μ = 7.2分

游戏A: 3人评分,平均9.0分
→ 平滑后: (3×9.0 + 20×7.2) / 23 = 7.8分 (向全局回归)

游戏B: 50人评分,平均8.3分
→ 平滑后: (50×8.3 + 20×7.2) / 70 = 8.2分 (几乎不变)
```

**重要说明**:
- 贝叶斯平滑使用"评分人次"(评审团×2)而非"评分人数"
- 与排名资格的"人次"概念保持一致

#### 步骤5: 输出最终得分
- 进入排名的游戏: 显示最终得分
- 未达门槛的游戏: 显示原始平均分(供参考)

### 10.3 全局均值的计算

**计算规则**: 全局均值只包含**通过排名门槛的游戏**

**计算公式**:
```
全局均值 = Σ(所有通过门槛游戏的该维度得分) / 通过门槛的游戏数量
```

**理由**:
- **逻辑一致性**: 只有过了门槛的游戏才参与排名,全局均值作为排名计算基准也应基于排名游戏
- **公平性**: 未达门槛的游戏质量参差不齐,包含它们会扭曲全局均值
- **用户期望**: 用户理解的全局均值是"所有可排名游戏的平均水平"

**示例**:
假设156个游戏通过门槛(>15人次),在创新性维度:
- 游戏A: 8.425分
- 游戏B: 8.312分
- ...
- 游戏Z: 6.521分

全局均值 = (8.425 + 8.312 + ... + 6.521) / 156 = 7.523分

### 10.4 算法设计原则

1. **简单透明**: 规则用一句话就能解释清楚
2. **抗扰动性**: 能抵御常见刷分行为,但不追求完美防御
3. **可解释性**: 每个计算步骤都能向用户解释

**用户可理解版本**:
> "我们使用两步计算: 1) 去掉最高10%和最低10%的极端评分,防止恶意刷分; 2) 如果你的游戏评分人数较少,会参考全局平均水平进行调整,避免偶然性。"

---

## 十点五、数值精度规则

### 10.5.1 权重计算精度

**个人的权重计算保留至小数点后3位**。

**具体规则**:
- 评审团成员的每个评分在计算"评分人次"时按 **2.000** 计算
- 普通参赛者的每个评分在计算"评分人次"时按 **1.000** 计算
- 所有中间计算保留3位小数,避免累积误差

**示例**:
```
游戏A的评分人次计算:
- 15个参赛者评分: 15 × 1.000 = 15.000
- 3个评审团评分: 3 × 2.000 = 6.000
- 总评分人次: 15.000 + 6.000 = 21.000人次
```

### 10.5.2 最终得分精度

**最终的加权截尾平均分也保留至小数点后3位**。

**具体规则**:
- 截尾均值计算结果保留3位小数
- 贝叶斯平滑后的最终得分保留3位小数
- 显示时可根据需要简化为1位或2位小数,但内部计算始终使用3位小数

**示例**:
```
游戏B - 创新性维度:
1. 原始评分: [9.0, 8.5, 8.0, 7.5, 7.0, 6.5]
2. 截尾均值: 7.750分 (去掉最高9.0和最低6.5)
3. 贝叶斯平滑: (6 × 7.750 + 20 × 7.200) / 26 = 7.327分
4. 最终得分: 7.327分 ✅ (保留3位小数)
```

**显示格式**:
- 内部计算: 7.327分
- 用户界面: 7.327分 (保留3位小数)
- 排名对比: 精确到3位小数,避免并列误判

### 10.5.3 单一维度排名规则

**个人的单一维度排名根据其该维度的均分结果和其他过了门槛的游戏进行比较得出**。

**具体规则**:
- 计算该游戏在某维度的最终得分(截尾均值 + 贝叶斯平滑)
- 将该得分与所有通过排名门槛的游戏在该维度的得分进行比较
- 按得分从高到低排序,得出该游戏在该维度的排名
- 得分相同的情况按"十一、并列处理规则"处理

**示例**:
```
创新性维度排名(假设156个游戏通过门槛):

排名  游戏名称          创新性得分   评分人次
1.    《星际探索者》    8.425分     50人次
2.    《像素冒险》      8.312分     48人次
3.    《时空之刃》      8.298分     52人次
...
15.   《量子跳跃》      7.856分     45人次
```

**重要说明**:
- 每个维度独立排名,互不影响
- 未通过排名门槛的游戏不参与排名
- 排名仅在结果公布时计算,评分阶段不显示实时排名

### 10.5.4 数值精度设计理由

**为什么统一选择3位小数?**

1. **精度足够**: 0.001分的精度足以区分绝大多数游戏的得分差异
2. **避免过度精确**: 过多小数位(如6位)会让用户产生"虚假精确感"
3. **计算效率**: 3位小数在浮点数计算中不会造成性能问题
4. **统一精度**: 所有计算、显示、排名对比统一使用3位小数,逻辑一致

**对比示例**:
```
过度精确(不推荐): 7.326857分 → 用户会觉得"虚假精确"
统一精度(推荐):   7.327分    → 内部计算、外部显示、排名对比全部使用3位小数
精度不足(不推荐): 7.3分      → 无法区分7.326和7.274
```

---

## 十一、并列处理规则

### 11.1 并列判定阈值

**分数差异 < 0.001分** → 视为并列

**说明**: 统一使用3位小数精度,与数值精度规则保持一致

### 11.2 三级Tie-breaker

当两个游戏得分相同时(差距<0.001分),按以下优先级排序:

**优先级1: 评分人次多的优先**
- 理由: 样本越大,结果越可信
- 说明: 使用"人次"(评审团×2)而非"人数"

**优先级2: 方差小的优先**(如果人次也相同)
- 理由: 更稳定的评分更可靠
- 说明: 方差反映评分的离散程度

**优先级3: 评审团评分占比高的优先**(如果方差也相同)
- 理由: 评审团的评价更具权威性
- 说明: 评审团评分数 / 总评分数

**最终: 完全相同** → 允许并列
- 例如: 第1名2个游戏,第3名从下一个开始
- Top 10可能超过10个游戏

### 11.3 并列示例

```
创新性维度排名:
1. 游戏《星际探索者》- 8.420分 (50人次)
2. 游戏《像素冒险》- 8.420分 (48人次) ← 人次少,排第2
3. 游戏《时空之刃》- 8.419分 (50人次)
...
T-5. 游戏《量子跳跃》- 8.350分 (45人次,方差0.3)
T-5. 游戏《赛博朋克》- 8.350分 (45人次,方差0.3) ← 完全相同,并列
```

---

## 十二、结果公布规则

### 12.1 公布时间

**评分阶段结束后2天公布结果**

**原因**:
- 给申诉和复核留出时间
- 处理可能的争议

### 12.2 公布内容

**三组结果独立公布**:

1. **参赛者评分榜单**
   - 6个维度独立榜单
   - 参赛者优选游戏榜单

2. **评审团评分榜单**
   - 6个维度独立榜单
   - 评审团优选游戏榜单

3. **赏金收益展示**
   - 不排名,仅展示收益情况

### 12.3 并列处理说明

> **详细规则**: 请参阅本文档"十一、并列处理规则"

---

## 十三、设计总结

### 13.1 核心创新点

1. **革命性排名系统**: 放弃总分,采用单维度排名
2. **优选游戏机制**: 3个维度前10 = 优选游戏
3. **AI处理机制**: 申报制 + 争议仲裁 + 维度不参与
4. **双重优选榜单**: 参赛者版 + 评审团版
5. **排名计算方法**: 截尾均值 + 贝叶斯平滑(第一届)

### 13.2 设计优势

**公平性**:
- ✅ AI使用透明化
- ✅ 反作弊机制完善
- ✅ 评审团严格监督
- ✅ 截尾均值抗刷分
- ✅ 贝叶斯平滑防冷启动

**公开性**:
- ✅ 规则清晰明确
- ✅ 结果独立公布
- ✅ 争议仲裁透明
- ✅ 算法可解释(用户能理解)

**好玩**:
- ✅ 单维度排名更有趣
- ✅ 优选游戏机制有惊喜感
- ✅ 双重视角有对比性

### 13.3 技术实现要点

**评分提交**:
- 必须点击"提交评分"按钮
- 二次确认弹窗
- 允许全部维度评0分

**评分修改**:
- 无次数限制
- 修改需二次确认
- 评分阶段结束后锁定

**反作弊监控**:
- 实时监控评分频率
- 高危监测: 10分钟内>6个游戏
- 高频差评: 6个维度均<2分

**排名计算**:
- 截尾均值: 去掉最高和最低各10%
- 贝叶斯平滑: k=20,小样本向全局均值回归
- 并列处理: 三级tie-breaker规则

---

## 十四、工程实现与边界处理

### 14.1 排名计算频率与缓存策略

**计算时机**:

**评分阶段(排名前)**:
- **实时计算**: 每次新评分提交后触发异步重算任务
- **缓存策略**: Redis缓存计算结果,TTL 5分钟
- **一致性**: 最终一致性,允许5分钟延迟

**排名公布后**:
- **定时任务**: 每天凌晨2点批量重算一次
- **触发条件**:
  - 定时任务(每日)
  - 手动触发(管理员API)
  - 数据修正后(作弊账号处理)

**理由**:
- 评分阶段需要实时反馈,但频繁全量重算性能开销大
- 排名后数据稳定,每日定时任务即可

---

### 14.2 小样本与贝叶斯平滑影响

**贝叶斯平滑影响量化** (k=20):

| 评分人次n | 全局均值影响比例 | 示例(μ=7.2, S=8.5) |
|----------|----------------|-------------------|
| 3人 | 87% | 8.5 → 7.8 (大幅调整) |
| 10人 | 67% | 8.5 → 8.0 (明显调整) |
| 20人 | 50% | 8.5 → 8.3 (中等调整) |
| 21人 | 49% | 8.5 → 8.3 (刚好达标) |
| 50人 | 29% | 8.5 → 8.4 (轻微调整) |
| 100人 | 17% | 8.5 → 8.5 (几乎不变) |

**公式**: 影响比例 = k / (n + k) = 20 / (n + 20)

**结论**: 21人次的游戏仍会受到49%的全局均值影响,但这是合理的,因为样本量仍较小。

---

### 14.3 未达门槛游戏的推荐位分配

**未达门槛游戏** (≤15人次):
- 显示原始平均分(供参考)
- 不参与正式排名
- **不参与系统保留推荐位的分配**

**推荐位分配优先级**:
1. 通过门槛的游戏,按随机分配
2. 剩余推荐位(如有),分配给接近门槛的游戏

**理由**: 系统保留推荐位的目的是帮助有潜力但曝光不足的游戏,未达门槛说明连基本认可度都没有,不应占用推荐位。

---

### 14.4 反作弊监测联动机制

**可疑评分处理流程**:

```
1. 自动标记(实时)
   → 标记字段: is_suspicious=true
   → 立即从排名计算中剔除
   → 记录审计日志

2. 人工复核(批处理)
   → 每日定时处理过去24小时标记
   → 管理员后台复核

3. 复核结果处理
   → 确认作弊: is_valid=false, 触发重算, 历史榜单更新
   → 误报恢复: is_suspicious=false, 触发重算, 通知用户
```

**用户通知机制**:
- 确认作弊: 作弊者封禁通知, 受影响创作者通知("您的排名因作弊处理已调整")
- 误报恢复: 评分者通知("您的评分已恢复有效")

**技术实现**: 异步消息队列(RabbitMQ/Kafka)处理重算任务

---

### 14.5 评分阶段结束锁定的技术实现

**三层防护设计**:

**1. 前端层**:
- 禁用"开始评分"按钮
- 显示"评分阶段已结束"提示

**2. 后端API层**:
- 中间件检查`scoring_phase_active`配置
- 返回`403 Forbidden` + 错误码`SCORING_PHASE_ENDED`

**3. 数据库层**:
- 触发器: INSERT前检查`scoring_phase_active`
- 拒绝写入: 返回错误`phase_not_active`

**配置管理**:
```yaml
scoring_phase:
  id: "season1"
  active: false
  start_time: "2025-01-01T00:00:00Z"
  end_time: "2025-01-31T23:59:59Z"
```

**理由**: 三层防护确保即使前端被绕过,后端和数据库仍能拦截。

---

## 十五、待补充内容

以下内容需要在后续设计阶段补充:

### 15.1 维度定义指南

需要为6个维度编写详细的评分指南:
- "创新性"的评价标准是什么?
- "整活儿"vs"整体性"的边界是什么?
- 是否提供示例说明?

### 15.2 系统架构文档 ⚠️ **高优先级**

需要补充:
- 数据流水线与ETL流程
- 监控指标定义
- 回滚流程与应急预案

### 15.3 反作弊系统设计 ⚠️ **高优先级**

需要补充:
- 可疑评分检测算法
- 作弊账号处理流程
- AI使用验证机制

### 15.4 API设计文档 ⚠️ **高优先级**

需要补充:
- 排名重算API规范
- 评分相关API接口定义
- 错误码规范

### 15.5 运维手册 ⚠️ **高优先级**

需要补充:
- 部署流程
- 监控与告警
- 数据修复SOP

### 15.6 强制评分数量 ✅ 已补充(第一届)

**采用方案**: 软性强制机制

**核心规则**:
- 不强制最小评分数量
- 但只有评分≥10个游戏,自己的游戏才能进入排名
- 未评分≥10个游戏: 自己的游戏显示"未达排名门槛"

**示例**:

| 场景 | 您评分的游戏数 | 您的游戏能否排名 |
|------|--------------|---------------|
| 场景A | 5个 | ❌ 不能排名(显示"未达门槛") |
| 场景B | 10个 | ✅ 可以排名 |
| 场景C | 15个 | ✅ 可以排名 |
| 场景D | 0个 | ❌ 不能排名(显示"未达门槛") |

**设计理由**:
1. **不会因未评分而被取消参赛资格**: 游戏仍可参赛、可下载、可评论
2. **利益驱动,无需强制执行**: 想要排名,就必须参与评分
3. **N=10合理**: 约占参赛作品的20-30%,不会造成太大负担

**用户提示**:
> "想要您的游戏进入正式排名吗? 请至少评价10个其他参赛者的游戏。您目前已评价X个游戏。"

**技术实现**:
```python
def check_ranking_eligibility_for_creator(creator_id: str, rated_games_count: int) -> Dict:
    MIN_RATED_GAMES = 10  # 第一届阈值

    if rated_games_count < MIN_RATED_GAMES:
        return {
            'eligible': False,
            'reason': f'需要评分至少{MIN_RATED_GAMES}个游戏才能进入排名(已评分{rated_games_count}个)',
            'rated_count': rated_games_count
        }
    return {'eligible': True}
```

**第一届建议**: N=10(约20-30%参赛作品)
**第二届调整**: 可根据第一届数据调整(如改为N=15或N=8)

### 14.3 页面级权限控制

需要为每个页面定义不同角色的可用操作:
- 首页
- 游戏详情页
- 游戏评分页面
- 推荐位购买页面
- 个人中心
- 团队管理页面
- 后台管理页面

### 14.4 作弊者标签规则 ✅ 已补充(第一届)

**标签展示规则**:
- 标签样式: 红色"作弊者"徽章
- 展示位置: 用户名旁边、个人资料页
- 标签有效期: 永久展示

**标签影响**:
- 所有历史评分保留但标注"来自已失效账号"
- 不影响其对他人的评分（难以追溯，不予处理）
- 账号状态标注为"已因作弊被封禁"

**注**: 成就系统详细设计已迁移到《成就系统设计文档》

---

## 附录: 相关文档

**系统架构**: [系统架构总览_v1.0.md](./惊蛰计划-系统架构总览_v1.0.md) ⭐ 新增
**经济系统**: [经济系统设计文档_v1.0.md](./惊蛰计划-经济系统设计文档_v1.0.md) ⭐ 新增
**成就系统**: [成就系统设计文档_v1.0.md](./惊蛰计划-成就系统设计文档_v1.0.md) ⭐ 新增
**用户角色与权限**: [user-roles-and-permissions.md](user-roles-and-permissions.md)
**评分系统问题清单**: [scoring-system-questions.md](../../development/active/issues/scoring-system-questions.md)
**原始设计文档**: [惊蛰计划-内部系统设计文档_v0.3_extended.md](惊蛰计划-内部系统设计文档_v0.3_extended.md)
**排名系统技术实现**: [排名系统技术实现文档_v1.0.md](./排名系统技术实现文档_v1.0.md)
**排名系统可行性研判**: [ranking_system_feasibility_report.md](../../development/analysis/ranking_system_feasibility_report.md)

---

## 变更历史

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|---------|------|
| 2025-01-04 | v1.0 | 初始版本,完成评分系统核心设计 | 蜡烛先生 + Claude |
| 2025-01-06 | v1.1 | 新增"排名计算方法"(第十、十一章) | 蜡烛先生 + Claude |
| | | - 新增截尾均值+贝叶斯平滑算法说明 | |
| | | - 新增三级tie-breaker并列处理规则 | |
| | | - 更新设计总结,新增算法技术要点 | |
| 2025-01-06 | v1.2 | 补充第一届必须的4个设计不足 | 蜡烛先生 + Claude |
| | | - 新增软性强制评分数量机制(§14.2) | |
| | | - 新增动态参赛者组门槛(§9.1) | |
| | | - 新增动态评审团组门槛(§9.2) | |
| | | - 明确AI维度对优选游戏的影响(§7.3.1) | |
| 2025-01-08 | v2.0 | 系统架构重构,移除经济和成就系统 | Claude |
| | | - 拆分经济系统到独立文档 | |
| | | - 拆分成就系统到独立文档 | |
| | | - 精简评分系统,移除打赏和金币相关内容 | |
| | | - 添加系统架构重构说明 | |
| 2025-01-10 | v2.1 | 新增"数值精度规则"(第十点五章) | Claude |
| | | - 明确权重计算精度: 保留至小数点后3位 | |
| | | - 明确最终得分精度: 加权截尾平均分保留3位小数 | |
| | | - 明确单一维度排名规则: 基于均分与过门槛游戏比较 | |
| | | - 补充数值精度设计理由 | |
| | | - 更新相关文档引用 | |
| 2025-01-10 | v2.2 | 修复排名门槛矛盾 | Claude |
| | | - 更正门槛规则: 第一届>15人次,第二届可能>20人次 | |
| | | - 明确唯一门槛: 总评分人次 > 15 | |
| | | - 删除错误的"两条件同时满足"规则 | |
| | | - 更新9.3节和10.2步骤2的门槛描述 | |
| | | - 同步关键名词解释索引的定义 | |
| 2025-01-10 | v2.3 | 统一数值精度为3位小数 | Claude |
| | | - 并列判定阈值从0.01调整为0.001 | |
| | | - 显示格式统一为3位小数(之前内部3位,显示2位) | |
| | | - 更新数值精度设计理由,强调统一精度 | |
| | | - 更新并列示例中的精度 | |
| 2025-01-10 | v2.4 | 修正全局均值计算范围 | Claude |
| | | - 全局均值改为仅包含通过排名门槛的游戏 | |
| | | - 删除之前错误的"包含所有有评分游戏"规则 | |
| | | - 补充全局均值计算公式和示例 | |
| | | - 理由: 逻辑一致性、公平性、用户期望 | |
| 2025-01-10 | v2.5 | 补充工程实现与边界处理 | Claude |
| | | - 新增第十四章:工程实现与边界处理 | |
| | | - 明确排名计算频率与缓存策略(实时+定时) | |
| | | - 量化贝叶斯平滑影响(21人次=49%影响) | |
| | | - 明确未达门槛游戏不参与推荐位分配 | |
| | | - 补充反作弊监测联动机制(实时剔除+批处理) | |
| | | - 补充评分阶段结束锁定的三层防护设计 | |
| | | - 更新待补充内容,标注高优先级任务 | |
