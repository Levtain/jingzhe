# 自动化工具开发检查清单

> **用途**: 确保每次开发Agent/Hook/Command时都正确使用skill并遵循规范
> **创建时间**: 2025-01-06
> **适用对象**: Claude (惊蛰计划AI助手)

---

## 📋 开发前准备

### 1. 需求确认

- [ ] **明确开发目标**: 要开发什么工具?
  - Agent (自主处理复杂任务)
  - Hook (事件驱动自动化)
  - Command (用户手动触发)

- [ ] **理解应用场景**: 这个工具解决什么问题?
  - 什么时候被触发?
  - 谁会使用这个工具?
  - 预期达到什么效果?

---

## 🔧 开发Agent检查清单

### 第一步: 调用agent-identifier skill

- [ ] **主动调用skill**: 在开始实现前先调用agent-identifier skill
  ```
  提示词格式: "使用agent-identifier skill开发一个Agent,功能是[描述功能]"
  ```

- [ ] **按照skill生成的模板实现**: 不要跳过这个步骤!

### 第二步: 验证frontmatter格式

**必需字段**:
- [ ] `name` (3-50字符,小写+连字符)
- [ ] `description` (包含2-4个<example>块)
- [ ] `model` (inherit/sonnet/opus/haiku)
- [ ] `color` (blue/cyan/green/yellow/magenta/red)

**可选字段**:
- [ ] `tools` (限制agent使用的工具列表)

### 第三步: 验证description字段

- [ ] **包含触发条件**: "Use this agent when..."
- [ ] **包含2-4个<example>块**
- [ ] **每个example包含**:
  - [ ] Context (场景描述)
  - [ ] user (用户说的话)
  - [ ] assistant (Claude如何响应)
  - [ ] commentary (为什么触发这个agent)

### 第四步: 验证system prompt

- [ ] **使用第二人称**: "You are..." 而不是 "I am..."
- [ ] **定义核心职责**: 清晰列出3-6个主要职责
- [ ] **提供分析流程**: 逐步说明如何处理任务
- [ ] **定义输出格式**: 明确说明输出什么,如何格式化
- [ ] **处理边界情况**: 列出可能的异常情况及处理方法

### 第五步: 保存和测试

- [ ] **保存位置**: `.claude/agents/{agent-name}.md`
- [ ] **测试调用**: 使用Task tool测试agent是否正常工作

---

## 🔗 开发Hook检查清单

### 第一步: 调用hook-development skill

- [ ] **主动调用skill**: 在开始实现前先调用hook-development skill
  ```
  提示词格式: "使用hook-development skill开发一个Hook,功能是[描述功能]"
  ```

### 第二步: 选择Hook类型

- [ ] **确定触发时机**:
  - [ ] PreToolUse (工具执行前)
  - [ ] PostToolUse (工具执行后)
  - [ ] SessionStart (会话开始)
  - [ ] SessionEnd (会话结束)
  - [ ] Stop (即将停止)
  - [ ] SubagentStop (子agent即将停止)
  - [ ] UserPromptSubmit (用户提交提示)

### 第三步: 验证JSON格式

- [ ] **使用plugin hooks.json格式**:
  ```json
  {
    "description": "可选的描述",
    "hooks": {
      "HookType": [...]
    }
  }
  ```

- [ ] **或使用settings格式** (如果直接放在settings.json):
  ```json
  {
    "HookType": [...]
  }
  ```

### 第四步: 配置Hook内容

- [ ] **设置matcher**: 匹配规则("*" 或 "ToolName|OtherTool")
- [ ] **选择type**: "prompt" 或 "command"
- [ ] **编写prompt/command**: 清晰的执行逻辑
- [ ] **设置timeout**: 合理的超时时间(秒)

### 第五步: 保存和测试

- [ ] **保存位置**: `.claude/hooks/{hook-name}.json`
- [ ] **验证JSON格式**: 使用JSON验证工具确保格式正确
- [ ] **测试触发**: 重启Claude Code测试hook是否生效

---

## 💻 开发Command检查清单

### 第一步: 调用command-development skill

- [ ] **主动调用skill**: 在开始实现前先调用command-development skill
  ```
  提示词格式: "使用command-development skill开发一个命令,功能是[描述功能]"
  ```

### 第二步: 设计命令结构

- [ ] **命令名称**: 简洁易记 (如 `/sync-docs`)
- [ ] **参数设计**: 是否需要参数?如何传递?
- [ ] **功能拆分**: 是否需要多个子命令?

### 第三步: 编写YAML配置

- [ ] **创建配置文件**: `.claude/commands/{command-name}.md`
- [ ] **编写YAML frontmatter**: 参数、描述等
- [ ] **编写使用说明**: 如何使用这个命令
- [ ] **提供示例**: 实际使用场景

### 第四步: 实现功能

- [ ] **参数解析**: 从用户输入中提取参数
- [ ] **执行逻辑**: 使用Bash工具执行具体操作
- [ ] **错误处理**: 处理可能的异常情况
- [ ] **输出格式**: 清晰的结果展示

### 第五步: 测试

- [ ] **手动测试**: 直接执行命令看是否正常
- [ ] **边界测试**: 测试参数缺失、错误输入等场景

---

## ✅ 开发后验证

### 格式验证

- [ ] **Agent**: 检查frontmatter是否完整,格式是否正确
- [ ] **Hook**: 验证JSON格式,检查语法错误
- [ ] **Command**: 确认YAML格式正确

### 功能验证

- [ ] **Agent**: 使用Task tool调用测试
- [ ] **Hook**: 重启Claude Code测试触发
- [ ] **Command**: 输入命令测试执行

### 文档同步

- [ ] **更新CHANGELOG.md**: 记录新增的工具
- [ ] **更新claude.md**: 更新工具数量和说明
- [ ] **创建开发日志**: 记录开发过程和决策

---

## 🚫 常见错误

### Agent开发常见错误

1. ❌ **没有frontmatter**: 直接写markdown内容
   - ✅ 正确: 使用YAML frontmatter格式

2. ❌ **description缺少examples**: 只有简单的描述
   - ✅ 正确: 包含2-4个详细的<example>块

3. ❌ **使用第一人称**: "I am an agent that..."
   - ✅ 正确: "You are an agent that..."

4. ❌ **没有工具限制**: Agent可以访问所有工具
   - ✅ 正确: 使用`tools`字段限制必要的工具

### Hook开发常见错误

1. ❌ **JSON格式错误**: 缺少逗号、括号不匹配等
   - ✅ 正确: 使用JSON验证工具检查

2. **prompt过于复杂**: LLM难以理解和执行
   - ✅ 正确: 简洁清晰的指令

3. **没有timeout设置**: 可能导致无限等待
   - ✅ 正确: 设置合理的timeout(10-60秒)

### Command开发常见错误

1. ❌ **参数处理不完善**: 没有处理参数缺失的情况
   - ✅ 正确: 检查参数有效性,提供默认值

2. **错误处理缺失**: 异常情况导致崩溃
   - ✅ 正确: 捕获异常,提供友好的错误信息

3. **输出不清晰**: 用户不知道结果是什么
   - ✅ 正确: 结构化的输出格式

---

## 📊 自查评分

完成开发后,给自己打分:

- [ ] **规范遵循**: 是否完全按照skill规范实现? (A/B/C/D/F)
- [ ] **格式正确**: frontmatter/JSON/YAML是否正确? (A/B/C/D/F)
- [ ] **功能完整**: 是否实现了所有预期功能? (A/B/C/D/F)
- [ ] **测试通过**: 是否经过测试并正常工作? (A/B/C/D/F)

**总分**: ______ / 4.0

如果任何一项低于B,需要重新检查和改进。

---

## 💡 最佳实践建议

1. **永远先用skill**: 不要跳过skill,这是规范和最佳实践的集合
2. **参考现有工具**: 查看.claude/agents/和.claude/hooks/下的现有实现
3. **保持简单**: 不要过度设计,先实现核心功能
4. **充分测试**: 在正式使用前必须经过测试
5. **文档同步**: 开发完成后立即更新相关文档

---

**记住**: 这些检查清单的目的是确保质量和一致性,而不是限制创造力。如果某个检查项不适用或有更好的实现方式,记录原因并继续。

*最后更新: 2025-01-06*
