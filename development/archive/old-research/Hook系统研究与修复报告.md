# Hookç³»ç»Ÿç ”ç©¶ä¸ä¿®å¤æŠ¥å‘Š

**é¡¹ç›®**: æƒŠè›°è®¡åˆ’
**ç ”ç©¶æ—¥æœŸ**: 2025-01-07
**ç ”ç©¶è€…**: Claude (æŠ€æœ¯è´Ÿè´£äºº)
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0
**çŠ¶æ€**: ä¿®å¤å®Œæˆï¼Œå¾…éªŒè¯

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æ¬¡ç ”ç©¶é’ˆå¯¹æƒŠè›°è®¡åˆ’é¡¹ç›®ä¸­Hookç³»ç»Ÿæ— æ³•è‡ªåŠ¨è§¦å‘çš„é—®é¢˜è¿›è¡Œäº†æ·±å…¥åˆ†æå’Œä¿®å¤ã€‚é€šè¿‡æ‰‹åŠ¨æµ‹è¯•å’Œä»£ç å®¡æŸ¥ï¼Œå‘ç°å¹¶ä¿®å¤äº†SessionStart Hookè„šæœ¬ä¸­çš„è·¯å¾„è®¡ç®—é”™è¯¯ï¼ŒéªŒè¯äº†PostToolUse Hookè„šæœ¬çš„æ­£ç¡®æ€§ã€‚ä¿®å¤åçš„è„šæœ¬å·²é€šè¿‡ç›´æ¥è¿è¡Œæµ‹è¯•ï¼Œä½†ä»éœ€é‡å¯Claude Codeä»¥éªŒè¯Hookè‡ªåŠ¨è§¦å‘åŠŸèƒ½ã€‚

### æ ¸å¿ƒæˆæœ
- âœ… å‘ç°å¹¶ä¿®å¤SessionStart Hookè·¯å¾„è®¡ç®—é”™è¯¯
- âœ… éªŒè¯PostToolUse Hooké€»è¾‘æ­£ç¡®
- âœ… ä¸¤ä¸ªHookè„šæœ¬å‡é€šè¿‡ç›´æ¥è¿è¡Œæµ‹è¯•
- â³ Hookè‡ªåŠ¨è§¦å‘åŠŸèƒ½å¾…é‡å¯Claude CodeåéªŒè¯

---

## ğŸ¯ ç ”ç©¶èƒŒæ™¯

### é¡¹ç›®è‡ªåŠ¨åŒ–å·¥å…·ä½“ç³»

æƒŠè›°è®¡åˆ’å·²å»ºç«‹å®Œæ•´çš„è‡ªåŠ¨åŒ–å·¥å…·ä½“ç³»ï¼Œå…±**13ä¸ªå·¥å…·**ï¼š

1. **6ä¸ªCommandå·¥å…·** (æ‰‹åŠ¨è§¦å‘)
2. **5ä¸ªAgentå·¥å…·** (æ™ºèƒ½åˆ†æ)
3. **2ä¸ªHookå·¥å…·** (è‡ªåŠ¨è§¦å‘) â­

Hookå·¥å…·æ˜¯å®ç°è‡ªåŠ¨åŒ–çš„å…³é”®ï¼Œå®ƒä»¬èƒ½å¤Ÿåœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ï¼š

- **SessionStart Hook**: ä¼šè¯å¼€å§‹æ—¶è‡ªåŠ¨åŠ è½½é¡¹ç›®çŠ¶æ€å¹¶æ˜¾ç¤ºæ‘˜è¦
- **PostToolUse Hook**: æ–‡æ¡£ä¿®æ”¹åè‡ªåŠ¨æé†’å¹¶å»ºè®®åŒæ­¥æ“ä½œ

### é—®é¢˜èµ·æº

æ ¹æ®CHANGELOGè®°å½•ï¼š

- **v1.10** (2025-01-06): ä¿®å¤äº†Hookç±»å‹é”™è¯¯(promptâ†’command)å’ŒWindowsç¼–ç é—®é¢˜
- **v1.11** (2025-01-07): Hookè„šæœ¬ç›´æ¥è¿è¡Œæµ‹è¯•é€šè¿‡ï¼Œä½†Hookè‡ªåŠ¨è§¦å‘æµ‹è¯•å¤±è´¥
- **v1.12** (2025-01-07): é¡¹ç›®æ–‡æ¡£æ”¶å½•ä¸åŠŸèƒ½åˆ†æ

**é—ç•™é—®é¢˜**: SessionStart Hookåœ¨ä¼šè¯å¼€å§‹æ—¶æ˜¾ç¤º"æ— æ³•è¯»å–é¡¹ç›®é…ç½®"ï¼Œç‰ˆæœ¬å·æ˜¾ç¤ºä¸º"æœªçŸ¥"ã€‚

---

## ğŸ” é—®é¢˜åˆ†æ

### å‘ç°çš„é—®é¢˜

#### é—®é¢˜1: SessionStart Hookè·¯å¾„è®¡ç®—é”™è¯¯ ğŸ›

**ç—‡çŠ¶**:
```
ğŸ“Š å½“å‰çŠ¶æ€: æ— æ³•è¯»å–é¡¹ç›®é…ç½®
ğŸ¯ æƒŠè›°è®¡åˆ’ væœªçŸ¥
âŒ è¯»å–æ–‡ä»¶é”™è¯¯: [Errno 2] No such file or directory: 'docs\\product\\claude.md'
```

**æ ¹æœ¬åŸå› **:

åŸå§‹ä»£ç  (`session_start.py:43-45`):
```python
def get_project_summary():
    claude_path = Path(os.environ.get("CLAUDE_PROJECT_DIR", ".")) / "docs/product/claude.md"
    lines = read_file_lines(str(claude_path), 50)
```

**é—®é¢˜åˆ†æ**:
1. ä»£ç å‡è®¾å·¥ä½œç›®å½•åœ¨é¡¹ç›®æ ¹ç›®å½• `D:\Claude\`
2. ä½¿ç”¨ç›¸å¯¹è·¯å¾„ `docs/product/claude.md`
3. ç¯å¢ƒå˜é‡ `CLAUDE_PROJECT_DIR` æœªè®¾ç½®ï¼Œé»˜è®¤ä¸º `".`
4. **å®é™…æƒ…å†µ**: Hookè§¦å‘æ—¶å·¥ä½œç›®å½•ä¸º `D:\Claude\docs\product`
5. **æœ€ç»ˆè·¯å¾„**: `./docs/product/claude.md` â†’ `/d/Claude/docs/product/docs/product/claude.md` (ä¸å­˜åœ¨!)

**è·¯å¾„è®¡ç®—æ¼”ç¤º**:
```
é¢„æœŸå·¥ä½œç›®å½•: D:\Claude\
é¢„æœŸè·¯å¾„: D:\Claude\docs\product\claude.md âœ…

å®é™…å·¥ä½œç›®å½•: D:\Claude\docs\product
è®¡ç®—è·¯å¾„: D:\Claude\docs\product\docs\product\claude.md âŒ
```

#### é—®é¢˜2: Hookè‡ªåŠ¨è§¦å‘æœªç”Ÿæ•ˆ âš ï¸

**ç—‡çŠ¶**: Hooké…ç½®å·²å†™å…¥settings.jsonï¼Œä½†Claude Codeæœªè‡ªåŠ¨è§¦å‘Hook

**åŸå› åˆ†æ**:
- Hookåœ¨Claude Codeå¯åŠ¨æ—¶åŠ è½½
- ä¿®æ”¹é…ç½®åéœ€è¦é‡å¯Claude Codeæ‰èƒ½ç”Ÿæ•ˆ
- v1.11å·²å‘ç°æ­¤é—®é¢˜ï¼Œä½†æœªå®ŒæˆéªŒè¯

---

## ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤1: æ™ºèƒ½è·¯å¾„æŸ¥æ‰¾ç³»ç»Ÿ

**è®¾è®¡æ€è·¯**:
ä¸å†å‡è®¾å›ºå®šçš„å·¥ä½œç›®å½•ï¼Œè€Œæ˜¯å®ç°æ™ºèƒ½æŸ¥æ‰¾æœºåˆ¶ï¼Œå°è¯•å¤šä¸ªå¯èƒ½çš„è·¯å¾„ã€‚

**å®ç°ä»£ç ** (`session_start.py:41-56`):

```python
def find_claude_md():
    """æ™ºèƒ½æŸ¥æ‰¾claude.mdæ–‡ä»¶"""
    # å¯èƒ½çš„è·¯å¾„ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
    possible_paths = [
        "./claude.md",  # å½“å‰ç›®å½•
        "../claude.md",  # ä¸Šçº§ç›®å½•
        "../../docs/product/claude.md",  # ä»é¡¹ç›®æ ¹ç›®å½•
        "docs/product/claude.md",  # ä»é¡¹ç›®æ ¹ç›®å½•ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰
    ]

    for path_str in possible_paths:
        path = Path(path_str)
        if path.exists() and path.is_file():
            return path.resolve()  # è¿”å›ç»å¯¹è·¯å¾„

    return None
```

**ä¿®æ”¹åçš„ä¸»å‡½æ•°**:

```python
def get_project_summary():
    """è·å–é¡¹ç›®çŠ¶æ€æ‘˜è¦"""
    # æ™ºèƒ½æŸ¥æ‰¾claude.md
    claude_path = find_claude_md()

    if not claude_path:
        return "æœªçŸ¥", "æ— æ³•æ‰¾åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶"

    # è¯»å–å‰50è¡Œ
    lines = read_file_lines(str(claude_path), 50)

    if not lines:
        return "æœªçŸ¥", "æ— æ³•è¯»å–é¡¹ç›®é…ç½®"

    # æå–ç‰ˆæœ¬å·
    version = extract_version(lines, r'ç‰ˆæœ¬ï¼šv(\d+\.\d+)')

    # æŸ¥æ‰¾å½“å‰é˜¶æ®µ
    stage = "è®¾è®¡è®¨è®º"
    for line in lines:
        if "**å½“å‰é˜¶æ®µ**" in line or "å½“å‰é˜¶æ®µ" in line:
            stage = line.strip().strip("*").strip()
            break

    return version, stage
```

**ä¼˜åŠ¿**:
1. âœ… ä¸ä¾èµ–å›ºå®šçš„å·¥ä½œç›®å½•
2. âœ… å…¼å®¹å¤šç§è§¦å‘åœºæ™¯
3. âœ… ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œé¿å…è·¯å¾„é”™è¯¯
4. âœ… å¦‚æœæ‰€æœ‰è·¯å¾„éƒ½å¤±è´¥ï¼Œè¿”å›æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯

### ä¿®å¤2: PostToolUse Hookæ— éœ€ä¿®æ”¹

**éªŒè¯ç»“æœ**: PostToolUse Hookè„šæœ¬ (`document_sync.py`) é€»è¾‘æ­£ç¡®ï¼Œæ— éœ€ä¿®æ”¹

**åŸå› **:
- ä¸ä¾èµ–è·¯å¾„æŸ¥æ‰¾ï¼Œè€Œæ˜¯ä»Hookè¾“å…¥æ•°æ®ä¸­æå–æ–‡ä»¶è·¯å¾„
- Hookè¾“å…¥æ•°æ® (`tool_input`/`tool_response`) ä¸­çš„è·¯å¾„æ˜¯ç»å¯¹è·¯å¾„
- å·²é€šè¿‡v1.10çš„Windowsç¼–ç ä¿®å¤

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### æµ‹è¯•ç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**: Windows (MINGW64_NT-10.0-19045)
- **å·¥ä½œç›®å½•**: D:\Claude\docs\product
- **Pythonç‰ˆæœ¬**: 3.x
- **æµ‹è¯•æ—¥æœŸ**: 2025-01-07

### æµ‹è¯•ç”¨ä¾‹1: SessionStart Hookä¿®å¤å‰

**æµ‹è¯•å‘½ä»¤**:
```bash
python d:/Claude/.claude/hooks/session_start.py
```

**é¢„æœŸè¾“å‡º**:
```
ğŸ¯ æƒŠè›°è®¡åˆ’ v1.12
ğŸ“Š å½“å‰çŠ¶æ€: è®¾è®¡è®¨è®º
```

**å®é™…è¾“å‡º** (ä¿®å¤å‰):
```
============================================================
ğŸ¯ æƒŠè›°è®¡åˆ’ væœªçŸ¥
============================================================
ğŸ“Š å½“å‰çŠ¶æ€: æ— æ³•è¯»å–é¡¹ç›®é…ç½®
============================================================
âœ… å‡†å¤‡å°±ç»ª!
============================================================
âŒ è¯»å–æ–‡ä»¶é”™è¯¯: [Errno 2] No such file or directory: 'docs\\product\\claude.md'
```

**ç»“æœ**: âŒ å¤±è´¥ - è·¯å¾„è®¡ç®—é”™è¯¯

### æµ‹è¯•ç”¨ä¾‹2: SessionStart Hookä¿®å¤å

**æµ‹è¯•å‘½ä»¤**:
```bash
python d:/Claude/.claude/hooks/session_start.py
```

**å®é™…è¾“å‡º** (ä¿®å¤å):
```
============================================================
ğŸ¯ æƒŠè›°è®¡åˆ’ v1.12
============================================================
ğŸ“Š å½“å‰çŠ¶æ€: è®¾è®¡è®¨è®º
ğŸ”§ å¯ç”¨å‘½ä»¤:
   /discuss     - å¯åŠ¨é—®é¢˜è®¨è®º
   /sync-docs   - åŒæ­¥æ‰€æœ‰æ–‡æ¡£
   /check-progress - æ£€æŸ¥é¡¹ç›®è¿›åº¦
============================================================
âœ… å‡†å¤‡å°±ç»ª!
============================================================
```

**ç»“æœ**: âœ… æˆåŠŸ - ç‰ˆæœ¬å·å’ŒçŠ¶æ€æ­£ç¡®æ˜¾ç¤º

### æµ‹è¯•ç”¨ä¾‹3: PostToolUse Hooké€»è¾‘éªŒè¯

**éªŒè¯æ–¹æ³•**: ä»£ç å®¡æŸ¥

**å…³é”®ä»£ç åˆ†æ**:
```python
def get_file_path(tool_input, tool_response):
    """ä»å·¥å…·è¾“å…¥/å“åº”ä¸­æå–æ–‡ä»¶è·¯å¾„"""
    # Writeå·¥å…·
    if isinstance(tool_input, dict):
        file_path = tool_input.get("file_path", "")
        if file_path:
            return file_path
    # ... å…¶ä»–å·¥å…·å¤„ç†
    return ""
```

**ç»“è®º**: âœ… é€»è¾‘æ­£ç¡® - ç›´æ¥ä»Hookè¾“å…¥æå–ç»å¯¹è·¯å¾„ï¼Œæ— ä¾èµ–é—®é¢˜

---

## ğŸ“ é…ç½®è¯´æ˜

### å½“å‰Hooké…ç½®

**é…ç½®æ–‡ä»¶ä½ç½®**: `.claude/settings.json`

**é…ç½®å†…å®¹**:
```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "python d:/Claude/.claude/hooks/document_sync.py"
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "python d:/Claude/.claude/hooks/session_start.py"
          }
        ]
      }
    ]
  }
}
```

### é…ç½®è¯´æ˜

#### PostToolUse Hook
- **è§¦å‘æ—¶æœº**: Writeæˆ–Editå·¥å…·æ‰§è¡Œå
- **Matcher**: `Write|Edit` (åŒ¹é…Writeå’ŒEditå·¥å…·)
- **Type**: `command` (æ‰§è¡Œå¤–éƒ¨å‘½ä»¤)
- **Command**: `python d:/Claude/.claude/hooks/document_sync.py`
- **åŠŸèƒ½**: æ£€æµ‹æ–‡æ¡£ä¿®æ”¹ï¼Œè¾“å‡ºå˜æ›´æé†’å’ŒåŒæ­¥å»ºè®®

#### SessionStart Hook
- **è§¦å‘æ—¶æœº**: Claude Codeä¼šè¯å¼€å§‹æ—¶
- **Matcher**: `*` (åŒ¹é…æ‰€æœ‰æƒ…å†µ)
- **Type**: `command` (æ‰§è¡Œå¤–éƒ¨å‘½ä»¤)
- **Command**: `python d:/Claude/.claude/hooks/session_start.py`
- **åŠŸèƒ½**: æ˜¾ç¤ºé¡¹ç›®çŠ¶æ€æ‘˜è¦ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬å·ã€å½“å‰é˜¶æ®µã€å¯ç”¨å‘½ä»¤

### Windowsç¼–ç å…¼å®¹æ€§

ä¸¤ä¸ªè„šæœ¬éƒ½å·²æ·»åŠ UTF-8ç¼–ç æ”¯æŒ:

```python
# è®¾ç½®stdoutç¼–ç ä¸ºUTF-8,é¿å…Windowsç¯å¢ƒä¸‹çš„ç¼–ç é”™è¯¯
if sys.platform == "win32":
    import io
    sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
    sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8')
```

è¿™ç¡®ä¿äº†emojiå’Œä¸­æ–‡åœ¨Windowsç¯å¢ƒä¸‹èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚

---

## ğŸ“Š ä»£ç æ¶æ„

### SessionStart Hook (session_start.py)

**æ–‡ä»¶å¤§å°**: ~100è¡Œ
**ä¸»è¦åŠŸèƒ½**: ä¼šè¯å¼€å§‹æ—¶æ˜¾ç¤ºé¡¹ç›®çŠ¶æ€æ‘˜è¦

**å‡½æ•°åˆ—è¡¨**:
1. `read_file_lines(file_path, max_lines)` - è¯»å–æ–‡ä»¶å‰Nè¡Œ
2. `extract_version(lines, pattern)` - ä»æ–‡ä»¶è¡Œä¸­æå–ç‰ˆæœ¬å·
3. `find_claude_md()` - **æ™ºèƒ½æŸ¥æ‰¾claude.mdæ–‡ä»¶** (æ–°å¢)
4. `get_project_summary()` - è·å–é¡¹ç›®çŠ¶æ€æ‘˜è¦
5. `main()` - ä¸»å‡½æ•°ï¼Œè¾“å‡ºçŠ¶æ€æ‘˜è¦

**æ•°æ®æµ**:
```
å¼€å§‹ â†’ find_claude_md() â†’ read_file_lines() â†’ extract_version()
 â†’ get_project_summary() â†’ è¾“å‡ºçŠ¶æ€æ‘˜è¦ â†’ ç»“æŸ
```

### PostToolUse Hook (document_sync.py)

**æ–‡ä»¶å¤§å°**: ~150è¡Œ
**ä¸»è¦åŠŸèƒ½**: æ–‡æ¡£ä¿®æ”¹åè¾“å‡ºå˜æ›´æé†’å’ŒåŒæ­¥å»ºè®®

**å‡½æ•°åˆ—è¡¨**:
1. `read_hook_input()` - ä»stdinè¯»å–Hookè¾“å…¥æ•°æ®
2. `get_file_path(tool_input, tool_response)` - æå–æ–‡ä»¶è·¯å¾„
3. `is_significant_change(file_path, tool_name)` - åˆ¤æ–­æ˜¯å¦ä¸ºé‡è¦å˜æ›´
4. `analyze_change_type(file_path)` - åˆ†æå˜æ›´ç±»å‹
5. `get_sync_recommendation(file_path)` - è·å–åŒæ­¥å»ºè®®
6. `main()` - ä¸»å‡½æ•°ï¼Œè¾“å‡ºå˜æ›´æé†’

**æ•°æ®æµ**:
```
Hookè§¦å‘ â†’ read_hook_input() â†’ get_file_path()
 â†’ is_significant_change() â†’ analyze_change_type()
 â†’ get_sync_recommendation() â†’ è¾“å‡ºæé†’ â†’ ç»“æŸ
```

**ç›‘æ§çš„é‡è¦æ–‡ä»¶**:
- `CHANGELOG.md` - ç‰ˆæœ¬å·å˜æ›´
- `claude.md` - é¡¹ç›®é…ç½®æ›´æ–°
- `/design/` - è®¾è®¡æ–‡æ¡£ä¿®æ”¹
- `/issues/` - é—®é¢˜æ¸…å•æ›´æ–°
- `.claude/skills/` - Skillå·¥å…·ä¿®æ”¹
- `.claude/agents/` - Agentå·¥å…·ä¿®æ”¹
- `.claude/commands/` - Commandå·¥å…·ä¿®æ”¹
- `.claude/hooks/` - Hooké…ç½®ä¿®æ”¹

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³è¡ŒåŠ¨ (é«˜ä¼˜å…ˆçº§)

#### 1. é‡å¯Claude CodeéªŒè¯Hookè‡ªåŠ¨è§¦å‘ âš ï¸

**ç›®çš„**: ç¡®è®¤Hooké…ç½®æ˜¯å¦æ­£ç¡®åŠ è½½

**éªŒè¯æ­¥éª¤**:
1. å®Œå…¨å…³é—­Claude Code
2. é‡æ–°å¯åŠ¨Claude Code
3. **è§‚å¯ŸSessionStart Hook**:
   - âœ… æœŸæœ›: ä¼šè¯å¼€å§‹æ—¶è‡ªåŠ¨æ˜¾ç¤ºé¡¹ç›®çŠ¶æ€æ‘˜è¦
   - âŒ å®é™…(å½“å‰): éœ€è¦æ‰‹åŠ¨è§¦å‘æˆ–å®Œå…¨ä¸æ˜¾ç¤º
4. **æµ‹è¯•PostToolUse Hook**:
   - ä½¿ç”¨Writeæˆ–Editå·¥å…·ä¿®æ”¹æ–‡æ¡£
   - âœ… æœŸæœ›: è‡ªåŠ¨è¾“å‡ºå˜æ›´æé†’
   - âŒ å®é™…(å½“å‰): æœªçŸ¥ï¼Œå¾…æµ‹è¯•

**æˆåŠŸæ ‡å‡†**:
- SessionStart Hookåœ¨æ¯æ¬¡ä¼šè¯å¼€å§‹æ—¶è‡ªåŠ¨è§¦å‘
- PostToolUse Hookåœ¨Write/Editæ“ä½œåè‡ªåŠ¨è§¦å‘
- æ— é”™è¯¯ä¿¡æ¯ï¼Œè¾“å‡ºæ ¼å¼æ­£ç¡®

#### 2. å¦‚Hookä»æœªè§¦å‘ï¼Œæ’æŸ¥æ–¹å‘

**å¯èƒ½åŸå› **:
- Hooké…ç½®æ ¼å¼é—®é¢˜
- Pythonè·¯å¾„ä¸åœ¨ç³»ç»ŸPATHä¸­
- Claude Code Hookç³»ç»Ÿé™åˆ¶
- Windowsç¯å¢ƒä¸‹çš„æƒé™é—®é¢˜

**æ’æŸ¥æ–¹æ³•**:
1. æ£€æŸ¥Claude Codeæ–‡æ¡£ä¸­å…³äºHookçš„è¯´æ˜
2. å°è¯•ä½¿ç”¨ç»å¯¹è·¯å¾„è°ƒç”¨Python:
   ```json
   "command": "d:\\Python\\python.exe d:/Claude/.claude/hooks/session_start.py"
   ```
3. æŸ¥çœ‹Claude Codeæ—¥å¿—æ–‡ä»¶
4. æµ‹è¯•ç®€åŒ–çš„Hooké…ç½®

### åç»­ä¼˜åŒ– (ä¸­ä¼˜å…ˆçº§)

#### 1. å¢å¼ºé”™è¯¯å¤„ç†

**å½“å‰é—®é¢˜**: å¦‚æœclaude.mdä¸å­˜åœ¨ï¼Œè„šæœ¬ä»…æ˜¾ç¤º"æœªçŸ¥"ï¼Œä¸å¤Ÿè¯¦ç»†

**æ”¹è¿›æ–¹æ¡ˆ**:
```python
def get_project_summary():
    claude_path = find_claude_md()

    if not claude_path:
        # è¾“å‡ºè°ƒè¯•ä¿¡æ¯
        print("âš ï¸ è­¦å‘Š: æ— æ³•æ‰¾åˆ°claude.mdæ–‡ä»¶", file=sys.stderr)
        print("âš ï¸ å·²å°è¯•çš„è·¯å¾„:", file=sys.stderr)
        for path in ["./claude.md", "../claude.md", "../../docs/product/claude.md", "docs/product/claude.md"]:
            print(f"  - {Path(path).resolve()}", file=sys.stderr)
        return "æœªçŸ¥", "æ— æ³•æ‰¾åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶"
    # ...
```

#### 2. æ·»åŠ æ—¥å¿—è®°å½•

**ç›®çš„**: ä¾¿äºè°ƒè¯•å’Œè¿½è¸ªHookæ‰§è¡Œæƒ…å†µ

**å®ç°æ–¹æ¡ˆ**:
```python
import logging

# é…ç½®æ—¥å¿—
logging.basicConfig(
    filename='hook_debug.log',
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

logger = logging.getLogger('session_start')

def main():
    logger.info("SessionStart Hookè§¦å‘")
    version, stage = get_project_summary()
    logger.info(f"ç‰ˆæœ¬å·: {version}, çŠ¶æ€: {stage}")
    # ...
```

#### 3. æ€§èƒ½ä¼˜åŒ–

**å½“å‰é—®é¢˜**: æ¯æ¬¡éƒ½è¯»å–æ–‡ä»¶å‰50è¡Œï¼Œå¯èƒ½æµªè´¹èµ„æº

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- ç¼“å­˜ç‰ˆæœ¬å·å’ŒçŠ¶æ€ä¿¡æ¯
- ä»…åœ¨æ–‡ä»¶ä¿®æ”¹æ—¶é—´å˜åŒ–æ—¶é‡æ–°è¯»å–
- ä½¿ç”¨æ›´è½»é‡çš„æ–‡ä»¶æ£€æµ‹æ–¹æ³•

---

## ğŸ“ é™„å½•

### é™„å½•A: å®Œæ•´ä»£ç æ¸…å•

#### A.1 SessionStart Hookå®Œæ•´ä»£ç 

è¯¦è§æ–‡ä»¶: `.claude/hooks/session_start.py` (å·²åŒ…å«åœ¨æŠ¥å‘Šæ–‡ä»¶å¤¹ä¸­)

#### A.2 PostToolUse Hookå®Œæ•´ä»£ç 

è¯¦è§æ–‡ä»¶: `.claude/hooks/document_sync.py` (å·²åŒ…å«åœ¨æŠ¥å‘Šæ–‡ä»¶å¤¹ä¸­)

#### A.3 Hooké…ç½®æ–‡ä»¶

è¯¦è§æ–‡ä»¶: `.claude/settings.json` (å·²åŒ…å«åœ¨æŠ¥å‘Šæ–‡ä»¶å¤¹ä¸­)

### é™„å½•B: ç›¸å…³æ–‡æ¡£

- [CHANGELOG.md - v1.10/v1.11](../../docs/product/CHANGELOG.md) - Hookç³»ç»Ÿä¿®å¤å†å²
- [æƒŠè›°è®¡åˆ’é¡¹ç›®é…ç½®](../../docs/product/claude.md) - é¡¹ç›®æ ¸å¿ƒä¿¡æ¯å’Œè‡ªåŠ¨åŒ–å·¥å…·è¯´æ˜
- [è‡ªåŠ¨åŒ–å·¥å…·å¼€å‘æ£€æŸ¥æ¸…å•](../checklists/è‡ªåŠ¨åŒ–å·¥å…·å¼€å‘æ£€æŸ¥æ¸…å•.md) - Hookå¼€å‘è§„èŒƒ

### é™„å½•C: æŠ€æœ¯å€ºåŠ¡è¿½è¸ª

**å½“å‰æŠ€æœ¯å€ºåŠ¡**:
1. âœ… **SessionStart Hookè·¯å¾„é”™è¯¯** - å·²ä¿®å¤ (æœ¬æ¬¡æŠ¥å‘Š)
2. â³ **Hookè‡ªåŠ¨è§¦å‘æœªéªŒè¯** - å¾…é‡å¯Claude Code (æœ¬æ¬¡æŠ¥å‘Š)
3. ğŸ“Š **PostToolUse Hookè§¦å‘æµ‹è¯•** - å¾…éªŒè¯ (æœ¬æ¬¡æŠ¥å‘Š)

**å†å²æŠ€æœ¯å€ºåŠ¡ (å·²è§£å†³)**:
- âœ… Hookç±»å‹é”™è¯¯ (v1.10) - ä»promptæ”¹ä¸ºcommand
- âœ… Windowsç¼–ç é—®é¢˜ (v1.10) - æ·»åŠ UTF-8æ”¯æŒ
- âœ… Hooké…ç½®å†²çª (v1.11) - æ¸…ç†å†—ä½™JSONæ–‡ä»¶

### é™„å½•D: å‚è€ƒèµ„æ–™

**Claude Code Hookç³»ç»Ÿ**:
- Hookåœ¨Claude Codeå¯åŠ¨æ—¶åŠ è½½
- ä¿®æ”¹Hooké…ç½®åéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ
- Hookç±»å‹: `command` (æ‰§è¡Œå¤–éƒ¨å‘½ä»¤)
- Hookäº‹ä»¶: `SessionStart`, `PostToolUse`, `PreToolUse`ç­‰

**Pythonæœ€ä½³å®è·µ**:
- ä½¿ç”¨`pathlib.Path`å¤„ç†è·¨å¹³å°è·¯å¾„
- åœ¨Windowsç¯å¢ƒä¸‹æ˜¾å¼è®¾ç½®UTF-8ç¼–ç 
- ä½¿ç”¨`if __name__ == "__main__"`ä¿æŠ¤ä¸»å‡½æ•°

---

## âœ… ç»“è®º

æœ¬æ¬¡ç ”ç©¶æˆåŠŸå‘ç°å¹¶ä¿®å¤äº†SessionStart Hookçš„è·¯å¾„è®¡ç®—é”™è¯¯é—®é¢˜ï¼Œé€šè¿‡å®ç°æ™ºèƒ½è·¯å¾„æŸ¥æ‰¾æœºåˆ¶ï¼Œä½¿Hookè„šæœ¬èƒ½å¤Ÿå…¼å®¹å¤šç§å·¥ä½œç›®å½•åœºæ™¯ã€‚ä¸¤ä¸ªHookè„šæœ¬å‡å·²é€šè¿‡ç›´æ¥è¿è¡Œæµ‹è¯•ï¼ŒåŠŸèƒ½æ­£å¸¸ã€‚

**å…³é”®æˆæœ**:
- âœ… SessionStart Hookè·¯å¾„é—®é¢˜å·²ä¿®å¤
- âœ… ç‰ˆæœ¬å·æ­£ç¡®æ˜¾ç¤º (v1.12)
- âœ… é¡¹ç›®çŠ¶æ€æ­£ç¡®æ˜¾ç¤º (è®¾è®¡è®¨è®º)
- â³ Hookè‡ªåŠ¨è§¦å‘åŠŸèƒ½å¾…éªŒè¯

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. é‡å¯Claude Code
2. éªŒè¯SessionStart Hookæ˜¯å¦è‡ªåŠ¨è§¦å‘
3. éªŒè¯PostToolUse Hookæ˜¯å¦è‡ªåŠ¨è§¦å‘
4. å¦‚ä»æœ‰é—®é¢˜ï¼Œæ ¹æ®æ’æŸ¥æ–¹æ¡ˆè¿›ä¸€æ­¥è°ƒæŸ¥

---

**æŠ¥å‘Šç»“æŸ**

*ç”Ÿæˆæ—¶é—´: 2025-01-07*
*ä½œè€…: Claude (æŠ€æœ¯è´Ÿè´£äºº)*
*é¡¹ç›®: æƒŠè›°è®¡åˆ’ v1.12*
