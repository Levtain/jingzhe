# 惊蛰计划 - 内部系统设计文档

> 本文档为内部使用，用于明确各系统的运行逻辑和算法规则
> 版本：v0.1（初稿）
> 更新日期：2025-12-31

---

## 📋 目录

1. [用户系统](#1-用户系统)
2. [主题投票系统](#2-主题投票系统)
3. [活动流程系统](#3-活动流程系统)
4. [评分系统](#4-评分系统)
5. [经济系统](#6-经济系统)
6. [排名系统](#6-排名系统)
7. [待确认事项](#7-待确认事项)

---

## 1. 用户系统

### 1.1 用户身份分类

| 身份类型 | 获得条件 | 基础金币 | 权限概要 |
|---------|---------|---------|---------|
| **参赛者** | 在开发周期结束前提交了游戏 | ? | 可评分、可评价、可打赏游戏和评论、可推荐游戏 |
| **评审团** | 主办方邀请 | ? | 可评分、可评价、可打赏、可推荐；评分权重2倍 |
| **路人玩家** | 注册但未提交游戏 | ? | 可试玩、可评价、可打赏、可推荐；**不可评分** |

### 1.2 身份判定逻辑

```
IF 用户在开发周期结束前提交了游戏 THEN
    身份 = 参赛者
ELSE IF 用户被主办方标记为评审团 THEN
    身份 = 评审团
ELSE
    身份 = 路人玩家
END IF
```

### 1.3 权限矩阵

| 操作 | 参赛者 | 评审团 | 路人玩家 |
|-----|-------|-------|---------|
| 提交主题 | ✅ | ✅ | ✅ |
| 筛选主题 | ✅ | ✅ | ✅ |
| 投票选主题 | ✅ | ✅ | ✅ |
| 提交游戏 | ✅ | ❌ | ❌ |
| 试玩游戏 | ✅ | ✅ | ✅ |
| 评分游戏 | ✅ | ✅ | ❌ |
| 评价游戏 | ✅ | ✅ | ✅ |
| 打赏游戏 | ✅ | ✅ | ✅ |
| 推荐游戏 | ✅ | ✅ | ✅ |
| 打赏评论 | ✅ | ✅ | ✅ |

---

## 2. 主题投票系统

### 2.1 时间轴

```
活动前4周 → 第1周（主题征集） → 第2周（主题筛选） → 第3-5周（3轮投票） → 惊蛰后第一个周五17:00（公布主题）
```

### 2.2 主题征集阶段（7天）

- **参与条件**：所有已注册用户
- **规则**：每人均可提交1个主题
- **输出**：主题池

### 2.3 主题筛选阶段（7天）

- **参与条件**：所有已注册用户
- **规则**：
  - 列出所有收集到的主题
  - 用户可以对每个主题选择"保留"或"淘汰"
  - 筛选结束后，保留呼声最高的N个主题（N待定）
- **输出**：候选主题列表

### 2.4 三轮投票（每轮3天，共9天）

#### 第1轮
- **输入**：候选主题列表
- **投票方式**：用户从候选主题中选择自己喜欢的（可多选？待定）
- **输出**：得票最高的前N1个主题进入下一轮（N1待定）

#### 第2轮
- **输入**：第1轮选出的主题
- **投票方式**：同上
- **输出**：得票最高的前N2个主题进入下一轮（N2待定）

#### 第3轮
- **输入**：第2轮选出的主题
- **投票方式**：单选投票（最终主题）
- **输出**：得票最高的主题确定为本次比赛主题

### 2.5 待确认事项

- [ ] 筛选阶段后保留多少个主题？
- [ ] 第1轮投票后保留多少个主题？
- [ ] 第2轮投票后保留多少个主题？
- [ ] 第1、2轮投票是单选还是多选？

---

## 3. 活动流程系统

### 3.1 时间轴

```
T-4周  →  主题征集开始（7天）
T-3周  →  主题筛选（7天）
T-2周  →  第1轮投票（3天）
T-1.5周→  第2轮投票（3天）
T-1周  →  第3轮投票（3天）
T日    →  惊蛰后第一个周五 17:00 公布主题
T+2天  →  17:00 开发周期结束（48小时）
T+3天  →  互玩互评开始（12天）
T+15天 →  17:00 互玩互评结束
T+16天 →  17:00 公布结果
```

### 3.2 活动状态枚举

| 状态代码 | 状态名称 | 说明 |
|---------|---------|------|
| `PREPARING` | 准备中 | 活动未开始，网站开启注册 |
| `THEME_SUBMISSION` | 主题征集中 | 主题征集阶段 |
| `THEME_FILTERING` | 主题筛选中 | 主题筛选阶段 |
| `VOTING_ROUND_1` | 第1轮投票中 | 主题投票第1轮 |
| `VOTING_ROUND_2` | 第2轮投票中 | 主题投票第2轮 |
| `VOTING_ROUND_3` | 第3轮投票中 | 主题投票第3轮 |
| `DEVELOPING` | 开发中 | 48小时开发周期 |
| `JUDGING` | 互评中 | 12天互玩互评 |
| `FINISHED` | 已结束 | 结果已公布 |

### 3.3 状态转换规则

```
PREPARING → THEME_SUBMISSION (到达预定开始时间)
THEME_SUBMISSION → THEME_FILTERING (7天后)
THEME_FILTERING → VOTING_ROUND_1 (7天后)
VOTING_ROUND_1 → VOTING_ROUND_2 (3天后)
VOTING_ROUND_2 → VOTING_ROUND_3 (3天后)
VOTING_ROUND_3 → DEVELOPING (3天后，惊蛰后第一个周五17:00)
DEVELOPING → JUDGING (48小时后)
JUDGING → FINISHED (12天后)
```

---

## 4. 评分系统

### 4.1 评分维度

| 维度编号 | 维度名称 | 说明 |
|---------|---------|------|
| D1 | 视觉效果 | 游戏的美术表现 |
| D2 | 创新程度 | 游戏的创新性和创意 |
| D3 | 整体性 | 游戏各元素的协调性 |
| D4 | 音频音效 | 游戏的声音设计 |
| D5 | 有趣程度 | 游戏的娱乐性 |
| D6 | 对主题诠释 | 对比赛主题的理解和表达 |

### 4.2 评分规则

- **评分范围**：0-10分（可以是小数吗？待定）
- **评分者**：参赛者、评审团
- **路人玩家**：不可评分
- **评审团权重**：评审团的每次评分在总评分人次中记为**2次**

### 4.3 评分算法

#### 4.3.1 单个游戏的单项维度得分计算

```
设某游戏在某个维度上的评分为：
S1, S2, ..., Sn 为所有评分者给出的分数

其中：
- 如果评分者是参赛者，权重为 1
- 如果评分者是评审团，权重为 2

加权平均分 = (Σ(权重 × 分数)) / (Σ权重)
```

**示例**：
```
游戏A在"视觉效果"维度收到：
- 参赛者B：8分（权重1）
- 参赛者C：7分（权重1）
- 评审团D：9分（权重2）

加权平均分 = (1×8 + 1×7 + 2×9) / (1 + 1 + 2) = 33 / 4 = 8.25分
```

#### 4.3.2 单个游戏的总分计算

```
游戏总分 = 各维度加权平均分之和
        = D1得分 + D2得分 + D3得分 + D4得分 + D5得分 + D6得分
满分 = 60分
```

#### 4.3.3 评审团评分独立统计

- 评审团评分单独计算一套排名
- 计算方式：仅使用评审团的评分计算各维度平均分和总分

### 4.4 评分限制

- **自评限制**：是否允许给自己提交的游戏评分？（待定）
- **最低评分次数要求**：是否要求参赛者至少评价多少个游戏？（待定）
- **AI使用限制**：
  - 如果游戏使用了生成式AI（且已标注），则不参与"视觉效果"和"音频音效"维度的评分
  - 这两个维度如何处理？（记0分？不计入总分？还是从总分计算中排除？待定）

### 4.5 待确认事项

- [ ] 评分是否支持小数？（如 8.5 分）
- [ ] 是否允许给自己评分？
- [ ] 是否要求最低评分次数？
- [ ] 使用AI的游戏，未评分的维度如何处理？

---

## 5. 经济系统

### 5.1 金币来源

| 来源 | 说明 | 金额（待定） |
|-----|------|------------|
| 注册奖励 | 用户完成注册获得 | ? |
| 参赛者基础金币 | 参赛者身份获得 | ? |
| 评审团基础金币 | 评审团身份获得 | ? |
| 路人基础金币 | 路人玩家身份获得 | ? |
| 被打赏 | 游戏或评论被打赏 | ? |

### 5.2 金币消耗

| 用途 | 规则 |
|-----|------|
| 游戏打赏 | 评分后**必须**打赏，档位1-10金币，每人每游戏仅限1次 |
| 评论打赏 | 不强制，档位0-5金币，每人每评论仅限1次 |

### 5.3 打赏规则

#### 游戏打赏
- **触发条件**：评分后必须打赏
- **打赏档位**：1、2、3、4、5、6、7、8、9、10 金币
- **限制**：每个用户对每个游戏只能打赏1次
- **强制要求**：评分后必须打赏，最低1金币

#### 评论打赏
- **触发条件**：可选，不强制
- **打赏档位**：0、1、2、3、4、5 金币（0表示不打赏）
- **限制**：每个用户对每条评论只能打赏1次

### 5.4 金币是否可转换？

- 金币是否可以提现？（待定）
- 金币是否可以转让？（待定）
- 金币是否有其他用途？（待定）

### 5.5 待确认事项

- [ ] 各身份的基础金币数额
- [ ] 金币是否有其他用途
- [ ] 金币是否可以提现或转让
- [ ] 是否需要金币回收机制（避免通胀）

---

## 6. 排名系统

### 6.1 排名类型

本系统产生**两套独立的排名**：

#### 6.1.1 参赛者评分排名
- **计算基础**：所有评分者（参赛者+评审团，评审团权重2倍）
- **排名依据**：游戏总分（各维度加权平均分之和）
- **用途**：主要排名，决定最终名次

#### 6.1.2 评审团评分排名
- **计算基础**：仅评审团的评分
- **排名依据**：游戏总分（各维度平均分之和）
- **用途**：独立展示，作为参考

### 6.2 排名展示

- 两套排名同时公布
- 相互独立，不混合计算

### 6.3 特殊情况处理

#### 情况1：评分人次不足
- 规则书中提到评审团权重可以帮助"总评分人次少于20的"游戏
- 这意味着什么？（待明确）
- 可能的理解：评分人次少会导致排名靠后？还是其他惩罚机制？

#### 情况2：使用AI的游戏
- 未参与"视觉效果"和"音频音效"评分
- 总分如何计算？（是按40分满分？还是这两个维度记0分？）

### 6.4 待确认事项

- [ ] "总评分人次少于20"的具体含义和影响
- [ ] 使用AI的游戏总分如何计算

---

## 7. 待确认事项汇总

### 7.1 用户系统
- [ ] 组队规则：是否允许组队？组队后如何评分和打赏？
- [ ] 各身份的基础金币数额

### 7.2 主题投票系统
- [ ] 筛选阶段后保留多少个主题
- [ ] 第1、2轮投票后各保留多少个主题
- [ ] 第1、2轮投票是单选还是多选

### 7.3 评分系统
- [ ] 评分是否支持小数
- [ ] 是否允许给自己评分
- [ ] 是否要求最低评分次数
- [ ] 使用AI的游戏，未评分的维度如何处理（总分计算）

### 7.4 经济系统
- [ ] 各身份的基础金币数额
- [ ] 金币是否有其他用途
- [ ] 金币是否可以提现或转让
- [ ] 是否需要金币回收机制

### 7.5 排名系统
- [ ] "总评分人次少于20"的具体含义和影响
- [ ] 使用AI的游戏总分如何计算

### 7.6 游戏提交规则
- [ ] "可以修复错误但不能添加新功能"的界限如何界定
- [ ] 补丁提交后如何突出显示更改内容

---

## 8. 技术实现建议（非产品层面）

> 以下为技术实现的初步建议，供参考

### 8.1 核心数据实体

- User（用户）
- Game（游戏）
- Theme（主题）
- Rating（评分）
- Comment（评论）
- Tip（打赏）
- Activity（活动）

### 8.2 技术栈建议

- 前端：React / Vue
- 后端：Node.js / Python / Java
- 数据库：MySQL / PostgreSQL
- 文件存储：阿里云OSS / 腾讯云COS（游戏文件存储）

---

## 📝 文档版本记录

| 版本 | 日期 | 修改内容 | 作者 |
|-----|------|---------|------|
| v0.1 | 2025-12-31 | 初稿创建，梳理核心系统和待确认事项 | Claude |

